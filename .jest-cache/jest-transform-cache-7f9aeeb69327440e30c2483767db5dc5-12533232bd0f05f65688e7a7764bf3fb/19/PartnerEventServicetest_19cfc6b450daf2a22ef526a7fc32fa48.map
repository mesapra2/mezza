{"file":"C:\\DEVMix\\App.Mesapra2.com\\src\\services\\PartnerEventService.test.ts","mappings":"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","names":[],"sources":["C:\\DEVMix\\App.Mesapra2.com\\src\\services\\PartnerEventService.test.ts"],"sourcesContent":["// src/services/PartnerEventService.test.ts\r\n\r\nimport { describe, it, expect, jest, beforeEach, afterEach, beforeAll } from '@jest/globals';\r\nimport { supabase } from '../lib/supabaseClient';\r\nimport NotificationService from './NotificationService';\r\nimport PartnerEventService from './PartnerEventService';\r\n\r\n// --- 1. MOCKING DEPENDÊNCIAS ---\r\n\r\n// Mock do Supabase\r\nconst mockSupabaseInstance = {\r\n  from: jest.fn(),\r\n  rpc: jest.fn(),\r\n};\r\n\r\njest.mock('../lib/supabaseClient', () => ({\r\n  supabase: mockSupabaseInstance,\r\n}));\r\n\r\n// Mock do NotificationService (default export)\r\njest.mock('./NotificationService', () => ({\r\n  default: {\r\n    notifyParticipationApproved: jest.fn(() => Promise.resolve({ success: true })),\r\n    notifyParticipationRejected: jest.fn(() => Promise.resolve({ success: true })),\r\n  },\r\n}));\r\n\r\n// Typecast dos mocks para intellisense\r\nconst mockedSupabase = supabase as jest.Mocked<typeof supabase>;\r\nconst mockedNotificationService = NotificationService as jest.Mocked<typeof NotificationService>;\r\n\r\n// --- 2. CONFIGURAÇÃO DOS TESTES ---\r\n\r\ndescribe('PartnerEventService', () => {\r\n\r\n  // Usamos timers falsos para controlar o new Date()\r\n  beforeAll(() => {\r\n    jest.useFakeTimers();\r\n  });\r\n\r\n  // Limpa todos os mocks antes de cada teste\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    (mockedSupabase.from as jest.Mock).mockReset();\r\n    (mockedSupabase.rpc as jest.Mock).mockReset();\r\n  });\r\n\r\n  // Restaura os timers reais\r\n  afterAll(() => {\r\n    jest.useRealTimers();\r\n  });\r\n\r\n  // --- 3. TESTES DOS MÉTODOS ---\r\n\r\n  describe('calculateEventStatus (Lógica Pura)', () => {\r\n    const now = new Date('2025-10-10T10:00:00Z');\r\n    jest.setSystemTime(now);\r\n\r\n    const baseEvent = {\r\n      id: '1',\r\n      status: 'Aberto' as const,\r\n      start_time: '2025-10-10T12:00:00Z', // Em 2 horas\r\n      end_time: '2025-10-10T14:00:00Z',\r\n      vagas: 5,\r\n    };\r\n\r\n    it('deve manter Cancelado se já estiver Cancelado', () => {\r\n      const status = PartnerEventService.calculateEventStatus({ ...baseEvent, status: 'Cancelado' }, now);\r\n      expect(status).toBe('Cancelado');\r\n    });\r\n\r\n    it('deve manter Concluído se já estiver Concluído', () => {\r\n      const status = PartnerEventService.calculateEventStatus({ ...baseEvent, status: 'Concluído' }, now);\r\n      expect(status).toBe('Concluído');\r\n    });\r\n\r\n    it('deve ser Finalizado se o tempo de término já passou', () => {\r\n      const pastEvent = { ...baseEvent, end_time: '2025-10-10T09:00:00Z' }; // Terminou 1h atrás\r\n      const status = PartnerEventService.calculateEventStatus(pastEvent, now);\r\n      expect(status).toBe('Finalizado');\r\n    });\r\n\r\n    it('deve ser Em Andamento se estiver dentro do horário', () => {\r\n      const currentEvent = { ...baseEvent, start_time: '2025-10-10T09:00:00Z' }; // Começou 1h atrás\r\n      const status = PartnerEventService.calculateEventStatus(currentEvent, now);\r\n      expect(status).toBe('Em Andamento');\r\n    });\r\n\r\n    it('deve manter Confirmado se foi confirmado manually, mesmo com vagas', () => {\r\n      const status = PartnerEventService.calculateEventStatus({ ...baseEvent, status: 'Confirmado' }, now);\r\n      expect(status).toBe('Confirmado');\r\n    });\r\n\r\n    it('deve ser Confirmado se as vagas acabaram (vagas <= 0)', () => {\r\n      const status = PartnerEventService.calculateEventStatus({ ...baseEvent, vagas: 0 }, now);\r\n      expect(status).toBe('Confirmado');\r\n    });\r\n\r\n    it('deve ser Aberto se faltar mais de 5 minutos e tiver vagas', () => {\r\n      const status = PartnerEventService.calculateEventStatus(baseEvent, now);\r\n      expect(status).toBe('Aberto');\r\n    });\r\n\r\n    it('deve ser Confirmado se faltar menos de 5 minutos (e não estiver cheio)', () => {\r\n      const closeEvent = { ...baseEvent, start_time: '2025-10-10T10:04:00Z' }; // Começa em 4 min\r\n      const status = PartnerEventService.calculateEventStatus(closeEvent, now);\r\n      expect(status).toBe('Confirmado');\r\n    });\r\n  });\r\n\r\n  describe('confirmEvent', () => {\r\n    it('deve chamar update com status Confirmado', async () => {\r\n      const mockUpdateEq = jest.fn().mockImplementation(() => Promise.resolve({ error: null }));\r\n      (mockedSupabase.from as jest.Mock).mockReturnValue({\r\n        update: jest.fn(() => ({\r\n          eq: mockUpdateEq,\r\n        })),\r\n      });\r\n\r\n      await PartnerEventService.confirmEvent('evt-123');\r\n\r\n      expect(mockedSupabase.from).toHaveBeenCalledWith('events');\r\n      expect(mockedSupabase.from('events').update).toHaveBeenCalledWith(\r\n        expect.objectContaining({ status: 'Confirmado' })\r\n      );\r\n      expect(mockUpdateEq).toHaveBeenCalledWith('id', 'evt-123');\r\n    });\r\n  });\r\n\r\n  describe('cancelEvent', () => {\r\n    it('deve chamar update com status Cancelado e motivo', async () => {\r\n      const mockUpdateEq = jest.fn().mockImplementation(() => Promise.resolve({ error: null }));\r\n      (mockedSupabase.from as jest.Mock).mockReturnValue({\r\n        update: jest.fn(() => ({\r\n          eq: mockUpdateEq,\r\n        })),\r\n      });\r\n\r\n      await PartnerEventService.cancelEvent('evt-123', 'Motivo Teste');\r\n\r\n      expect(mockedSupabase.from('events').update).toHaveBeenCalledWith(\r\n        expect.objectContaining({\r\n          status: 'Cancelado',\r\n          cancelamento_motivo: 'Motivo Teste',\r\n        })\r\n      );\r\n      expect(mockUpdateEq).toHaveBeenCalledWith('id', 'evt-123');\r\n    });\r\n  });\r\n\r\n  describe('getEventStats', () => {\r\n    it('deve buscar e agregar estatísticas do evento', async () => {\r\n      const mockEvent = { id: 'evt-1', title: 'Evento' };\r\n      const mockParticipations = [\r\n        { status: 'aprovado', presenca_confirmada: true, avaliacao_feita: true },\r\n        { status: 'aprovado', presenca_confirmada: true, avaliacao_feita: false },\r\n        { status: 'aprovado', presenca_confirmada: false, avaliacao_feita: false },\r\n        { status: 'pendente', presenca_confirmada: false, avaliacao_feita: false },\r\n      ];\r\n\r\n      // 1. Mock do SELECT do evento\r\n      (mockedSupabase.from as jest.Mock).mockImplementationOnce(() => ({\r\n        select: jest.fn(() => ({\r\n          eq: jest.fn(() => ({\r\n            single: jest.fn().mockImplementation(() => Promise.resolve({ data: mockEvent, error: null })),\r\n          })),\r\n        })),\r\n      }));\r\n\r\n      // 2. Mock do SELECT de participações\r\n      (mockedSupabase.from as jest.Mock).mockImplementationOnce(() => ({\r\n        select: jest.fn(() => ({\r\n          eq: jest.fn().mockImplementation(() => Promise.resolve({ data: mockParticipations, error: null })),\r\n        })),\r\n      }));\r\n\r\n      const result = await PartnerEventService.getEventStats('evt-1');\r\n\r\n      expect(result.success).toBe(true);\r\n      expect(result.data?.event).toEqual(mockEvent);\r\n      expect(result.data?.totalCandidaturas).toBe(4);\r\n      expect(result.data?.aprovados).toBe(3);\r\n      expect(result.data?.presentes).toBe(2);\r\n      expect(result.data?.avaliacoes).toBe(1);\r\n    });\r\n  });\r\n\r\n  describe('approveParticipation', () => {\r\n    it('deve aprovar, decrementar vagas e notificar o usuário', async () => {\r\n      const mockEvent = { vagas: 5, title: 'Evento Teste' };\r\n      const mockParticipation = { user_id: 'user-abc' };\r\n\r\n      // 1. Mock SELECT evento\r\n      (mockedSupabase.from as jest.Mock).mockImplementationOnce(() => ({\r\n        select: jest.fn(() => ({\r\n          eq: jest.fn(() => ({\r\n            single: jest.fn().mockImplementation(() => Promise.resolve({ data: mockEvent, error: null })),\r\n          })),\r\n        })),\r\n      }));\r\n\r\n      // 2. Mock SELECT participação\r\n      (mockedSupabase.from as jest.Mock).mockImplementationOnce(() => ({\r\n        select: jest.fn(() => ({\r\n          eq: jest.fn(() => ({\r\n            single: jest.fn().mockImplementation(() => Promise.resolve({ data: mockParticipation, error: null })),\r\n          })),\r\n        })),\r\n      }));\r\n\r\n      // 3. Mock UPDATE participação\r\n      (mockedSupabase.from as jest.Mock).mockImplementationOnce(() => ({\r\n        update: jest.fn(() => ({\r\n          eq: jest.fn().mockImplementation(() => Promise.resolve({ error: null })),\r\n        })),\r\n      }));\r\n      \r\n      // 4. Mock RPC decremento\r\n      (mockedSupabase.rpc as jest.Mock).mockImplementation(() => Promise.resolve({ error: null }));\r\n\r\n      const result = await PartnerEventService.approveParticipation('part-123', '456');\r\n\r\n      expect(result.success).toBe(true);\r\n      // Verifica se a participação foi atualizada\r\n      expect(mockedSupabase.from('event_participants').update).toHaveBeenCalledWith(\r\n        expect.objectContaining({ status: 'aprovado' })\r\n      );\r\n      // Verifica se o RPC foi chamado\r\n      expect(mockedSupabase.rpc).toHaveBeenCalledWith('decrement_event_vacancy', { event_id: '456' });\r\n      \r\n      // Verifica se a notificação foi enviada\r\n      // Note que o código-fonte usa parseInt(eventId, 10), então esperamos 456 (number)\r\n      expect(mockedNotificationService.notifyParticipationApproved).toHaveBeenCalledWith(\r\n        'user-abc',\r\n        456, // O código original faz parseInt()\r\n        'Evento Teste'\r\n      );\r\n    });\r\n\r\n    it('deve falhar se não houver vagas', async () => {\r\n      const mockEvent = { vagas: 0, title: 'Evento Lotado' };\r\n\r\n      // 1. Mock SELECT evento (lotado)\r\n      (mockedSupabase.from as jest.Mock).mockImplementationOnce(() => ({\r\n        select: jest.fn(() => ({\r\n          eq: jest.fn(() => ({\r\n            single: jest.fn().mockImplementation(() => Promise.resolve({ data: mockEvent, error: null })),\r\n          })),\r\n        })),\r\n      }));\r\n\r\n      const result = await PartnerEventService.approveParticipation('part-123', '456');\r\n\r\n      expect(result.success).toBe(false);\r\n      expect(result.error).toBe('Sem vagas disponíveis');\r\n      // Garante que não tentou fazer nada depois\r\n      expect(mockedSupabase.rpc).not.toHaveBeenCalled();\r\n      expect(mockedNotificationService.notifyParticipationApproved).not.toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('rejectParticipation', () => {\r\n    it('deve rejeitar e notificar o usuário com motivo', async () => {\r\n      const mockParticipation = {\r\n        user_id: 'user-abc',\r\n        event_id: 789, // ✅ CORREÇÃO: Alterado para number\r\n        events: { title: 'Evento Rejeitado' },\r\n      };\r\n\r\n      // 1. Mock SELECT participação (com inner join)\r\n      (mockedSupabase.from as jest.Mock).mockImplementationOnce(() => ({\r\n        select: jest.fn(() => ({\r\n          eq: jest.fn(() => ({\r\n            single: jest.fn().mockImplementation(() => Promise.resolve({ data: mockParticipation, error: null })),\r\n          })),\r\n        })),\r\n      }));\r\n      \r\n      // 2. Mock UPDATE participação\r\n      (mockedSupabase.from as jest.Mock).mockImplementationOnce(() => ({\r\n        update: jest.fn(() => ({\r\n          eq: jest.fn().mockImplementation(() => Promise.resolve({ error: null })),\r\n        })),\r\n      }));\r\n\r\n      const reason = 'Não se encaixa no perfil';\r\n      const result = await PartnerEventService.rejectParticipation('part-123', reason);\r\n\r\n      expect(result.success).toBe(true);\r\n      // Verifica se o status foi atualizado com o motivo\r\n      expect(mockedSupabase.from('event_participants').update).toHaveBeenCalledWith(\r\n        expect.objectContaining({\r\n          status: 'rejeitado',\r\n          motivo_rejeicao: reason,\r\n        })\r\n      );\r\n      \r\n      // ✅ CORREÇÃO: Verificando se a notificação foi enviada com um number\r\n      expect(mockedNotificationService.notifyParticipationRejected).toHaveBeenCalledWith(\r\n        'user-abc',\r\n        789, // ✅ CORREÇÃO: Alterado para number\r\n        'Evento Rejeitado',\r\n        reason\r\n      );\r\n    });\r\n  });\r\n\r\n  describe('getEventParticipations', () => {\r\n    it('deve buscar participações com dados do usuário', async () => {\r\n      const mockParticipations = [{ id: 'part-1', user: { username: 'Test' } }];\r\n\r\n      const mockOrder = jest.fn().mockImplementation(() => Promise.resolve({ data: mockParticipations, error: null }));\r\n      (mockedSupabase.from as jest.Mock).mockReturnValue({\r\n        select: jest.fn(() => ({\r\n          eq: jest.fn(() => ({\r\n            order: mockOrder,\r\n          })),\r\n        })),\r\n      });\r\n\r\n      const result = await PartnerEventService.getEventParticipations('evt-1');\r\n\r\n      expect(mockedSupabase.from).toHaveBeenCalledWith('event_participants');\r\n      expect(mockedSupabase.from('event_participants').select).toHaveBeenCalledWith(\r\n        '*, user:profiles!event_participants_user_id_fkey(*)'\r\n      );\r\n      expect(result.success).toBe(true);\r\n      expect(result.data).toEqual(mockParticipations);\r\n    });\r\n  });\r\n\r\n});\r\n\r\n"],"version":3}