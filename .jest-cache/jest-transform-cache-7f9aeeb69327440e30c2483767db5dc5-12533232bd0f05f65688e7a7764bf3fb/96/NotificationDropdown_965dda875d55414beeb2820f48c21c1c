ce0e2b54904af07b50b8f868efa9ab8c
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = tslib_1.__importStar(require("react"));
const prop_types_1 = tslib_1.__importDefault(require("prop-types"));
const framer_motion_1 = require("framer-motion");
const lucide_react_1 = require("lucide-react");
const react_router_dom_1 = require("react-router-dom");
const supabaseClient_1 = require("@/lib/supabaseClient");
const NotificationService_1 = tslib_1.__importDefault(require("@/services/NotificationService"));
const date_fns_1 = require("date-fns");
const locale_1 = require("date-fns/locale");
const use_toast_1 = require("@/features/shared/components/ui/use-toast");
const NotificationDropdown = ({ userId }) => {
    const [isOpen, setIsOpen] = (0, react_1.useState)(false);
    const [notifications, setNotifications] = (0, react_1.useState)([]);
    const [pokes, setPokes] = (0, react_1.useState)([]);
    const [unreadCount, setUnreadCount] = (0, react_1.useState)(0);
    const [loading, setLoading] = (0, react_1.useState)(false);
    const navigate = (0, react_router_dom_1.useNavigate)();
    const { toast } = (0, use_toast_1.useToast)();
    const loadNotifications = (0, react_1.useCallback)(async () => {
        setLoading(true);
        let retries = 3;
        while (retries > 0) {
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 10000);
                const { data: notificationsData, error: notifError } = await supabaseClient_1.supabase
                    .from('notifications')
                    .select('*')
                    .eq('user_id', userId)
                    .order('created_at', { ascending: false })
                    .limit(10);
                clearTimeout(timeoutId);
                if (notifError)
                    throw notifError;
                const notificationsWithUsers = await Promise.all((notificationsData || []).map(async (notif) => {
                    if (notif.participation_id) {
                        try {
                            const { data: participationData } = await supabaseClient_1.supabase
                                .from('event_participants')
                                .select(`
                    id,
                    user_id,
                    profiles!event_participants_user_id_fkey(
                      id,
                      username,
                      avatar_url
                    )
                  `)
                                .eq('id', notif.participation_id)
                                .single();
                            return {
                                ...notif,
                                participation: participationData
                                    ? {
                                        id: participationData.id,
                                        user: participationData.profiles,
                                    }
                                    : null,
                            };
                        }
                        catch (err) {
                            console.warn('âš ï¸ Erro ao carregar participaÃ§Ã£o:', err);
                            return notif;
                        }
                    }
                    return notif;
                }));
                setNotifications(notificationsWithUsers);
                break;
            }
            catch (error) {
                retries--;
                if (retries === 0) {
                    console.error('âŒ Erro ao carregar notificaÃ§Ãµes apÃ³s 3 tentativas:', error);
                    setNotifications([]);
                }
                else {
                    console.warn(`âš ï¸ Erro ao carregar notificaÃ§Ãµes. Tentando novamente... (${retries} tentativas restantes)`);
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
            }
        }
        setLoading(false);
    }, [userId]);
    const loadPokes = (0, react_1.useCallback)(async () => {
        let retries = 3;
        while (retries > 0) {
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 10000);
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                const { data: pokesData, error: pokesError } = await supabaseClient_1.supabase
                    .from('pokes')
                    .select(`
            id,
            from_user_id,
            created_at,
            read,
            profiles!pokes_from_user_id_fkey(
              id,
              username,
              full_name,
              avatar_url
            )
          `)
                    .eq('to_user_id', userId)
                    .gte('created_at', yesterday.toISOString())
                    .order('created_at', { ascending: false })
                    .limit(10);
                clearTimeout(timeoutId);
                if (pokesError)
                    throw pokesError;
                setPokes(pokesData || []);
                break;
            }
            catch (error) {
                retries--;
                if (retries === 0) {
                    console.error('âŒ Erro ao carregar cutucadas apÃ³s 3 tentativas:', error);
                    setPokes([]);
                }
                else {
                    console.warn(`âš ï¸ Erro ao carregar cutucadas. Tentando novamente... (${retries} tentativas restantes)`);
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
            }
        }
    }, [userId]);
    const loadUnreadCount = (0, react_1.useCallback)(async () => {
        let retries = 3;
        while (retries > 0) {
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 10000);
                const notifCount = await NotificationService_1.default.getUnreadCount(userId);
                const { count: pokesCount } = await supabaseClient_1.supabase
                    .from('pokes')
                    .select('*', { count: 'exact', head: true })
                    .eq('to_user_id', userId)
                    .eq('read', false);
                clearTimeout(timeoutId);
                setUnreadCount(notifCount + (pokesCount || 0));
                break;
            }
            catch (error) {
                retries--;
                if (retries === 0) {
                    console.error('âŒ Erro ao contar nÃ£o lidas apÃ³s 3 tentativas:', error);
                    setUnreadCount(0);
                }
                else {
                    console.warn(`âš ï¸ Erro ao contar nÃ£o lidas. Tentando novamente... (${retries} tentativas restantes)`);
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
            }
        }
    }, [userId]);
    (0, react_1.useEffect)(() => {
        if (!userId)
            return;
        loadNotifications();
        loadPokes();
        loadUnreadCount();
        const interval = setInterval(() => {
            loadNotifications();
            loadPokes();
            loadUnreadCount();
        }, 30000);
        let notifChannel = null;
        let pokesChannel = null;
        const setupChannels = async () => {
            try {
                notifChannel = supabaseClient_1.supabase
                    .channel(`notifications:${userId}`)
                    .on('postgres_changes', {
                    event: 'INSERT',
                    schema: 'public',
                    table: 'notifications',
                    filter: `user_id=eq.${userId}`,
                }, (payload) => {
                    console.log('ðŸ”” Nova notificaÃ§Ã£o recebida:', payload);
                    loadNotifications();
                    loadUnreadCount();
                })
                    .subscribe((status) => {
                    if (status === 'SUBSCRIBED') {
                        console.log('âœ… Inscrito em notificaÃ§Ãµes');
                    }
                    else if (status === 'CHANNEL_ERROR') {
                        console.error('âŒ Erro ao conectar em notificaÃ§Ãµes');
                    }
                });
                pokesChannel = supabaseClient_1.supabase
                    .channel(`pokes:${userId}`)
                    .on('postgres_changes', {
                    event: 'INSERT',
                    schema: 'public',
                    table: 'pokes',
                    filter: `to_user_id=eq.${userId}`,
                }, (payload) => {
                    console.log('ðŸ‘‹ Novo Tok recebido:', payload);
                    loadPokes();
                    loadUnreadCount();
                })
                    .subscribe((status) => {
                    if (status === 'SUBSCRIBED') {
                        console.log('âœ… Inscrito em toks');
                    }
                    else if (status === 'CHANNEL_ERROR') {
                        console.error('âŒ Erro ao conectar em toks');
                    }
                });
            }
            catch (error) {
                console.error('âŒ Erro ao configurar canais:', error);
            }
        };
        setupChannels();
        return () => {
            clearInterval(interval);
            if (notifChannel) {
                notifChannel.unsubscribe();
            }
            if (pokesChannel) {
                pokesChannel.unsubscribe();
            }
        };
    }, [userId, loadNotifications, loadPokes, loadUnreadCount]);
    const handleMarkAsRead = async (notificationId) => {
        await NotificationService_1.default.markAsRead(notificationId);
        loadNotifications();
        loadUnreadCount();
    };
    const handleMarkPokeAsRead = async (pokeId) => {
        try {
            const { error } = await supabaseClient_1.supabase
                .from('pokes')
                .update({ read: true })
                .eq('id', pokeId);
            if (error)
                throw error;
            loadPokes();
            loadUnreadCount();
        }
        catch (error) {
            console.error('âŒ Erro ao marcar tok como lido:', error);
        }
    };
    const handleMarkAllAsRead = async () => {
        await NotificationService_1.default.markAllAsRead(userId);
        try {
            const { error } = await supabaseClient_1.supabase
                .from('pokes')
                .update({ read: true })
                .eq('to_user_id', userId);
            if (error)
                throw error;
            loadNotifications();
            loadPokes();
            loadUnreadCount();
        }
        catch (error) {
            console.error('âŒ Erro ao marcar todos como lidos:', error);
        }
    };
    const handleNotificationClick = (notification) => {
        if (notification.event_id) {
            navigate(`/event/${notification.event_id}`);
            handleMarkAsRead(notification.id);
            setIsOpen(false);
        }
        else {
            console.warn('âš ï¸ NotificaÃ§Ã£o sem event_id:', notification);
        }
    };
    const handlePokeClick = (poke) => {
        navigate(`/profile/${poke.from_user_id}`);
        handleMarkPokeAsRead(poke.id);
        setIsOpen(false);
    };
    // ðŸ†• FunÃ§Ã£o para copiar senha
    const handleCopyPassword = (password, eventTitle) => {
        navigator.clipboard.writeText(password);
        toast({
            title: 'ðŸ” Senha copiada!',
            description: `Senha do evento "${eventTitle}" copiada para Ã¡rea de transferÃªncia`,
        });
    };
    // ðŸ†• FunÃ§Ã£o para renderizar notificaÃ§Ã£o com senha
    const renderPasswordNotification = (notification) => {
        if (notification.notification_type !== 'event_password')
            return null;
        // Extrair senha do data ou message
        const password = notification.data?.password ||
            notification.message?.match(/\d{4}/)?.[0];
        if (!password)
            return null;
        return ((0, jsx_runtime_1.jsxs)("div", { className: "mt-2 p-3 rounded-lg bg-green-500/10 border border-green-500/30", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Key, { className: "w-4 h-4 text-green-400" }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("p", { className: "text-xs text-green-300 font-semibold", children: "Senha de Entrada" }), (0, jsx_runtime_1.jsx)("p", { className: "text-2xl font-bold text-green-400 font-mono tracking-wider", children: password })] })] }), (0, jsx_runtime_1.jsx)("button", { onClick: (e) => {
                                e.stopPropagation();
                                handleCopyPassword(password, notification.title);
                            }, className: "p-2 rounded-lg hover:bg-white/10 text-green-400 transition-colors", title: "Copiar senha", children: (0, jsx_runtime_1.jsx)(lucide_react_1.Copy, { className: "w-4 h-4" }) })] }), (0, jsx_runtime_1.jsx)("p", { className: "text-xs text-green-200/70 mt-2", children: "Compartilhe esta senha com os participantes para entrarem no evento" })] }));
    };
    const getNotificationIcon = (type) => {
        const icons = {
            'Candidatura Recebida': lucide_react_1.UserPlus,
            'Candidatura Aprovada': lucide_react_1.Check,
            'Candidatura Rejeitada': lucide_react_1.X,
            'Novo Evento': lucide_react_1.Calendar,
            'event_cancelled': lucide_react_1.AlertCircle,
            'event_confirmed': lucide_react_1.Check,
            'event_reminder': lucide_react_1.Calendar,
            'event_password': lucide_react_1.Key, // ðŸ†•
            'poke': lucide_react_1.Hand,
        };
        return icons[type] || lucide_react_1.Bell;
    };
    const getNotificationColor = (type) => {
        const colors = {
            'Candidatura Recebida': 'text-purple-400',
            'Candidatura Aprovada': 'text-green-400',
            'Candidatura Rejeitada': 'text-red-400',
            'Novo Evento': 'text-blue-400',
            'event_cancelled': 'text-yellow-400',
            'event_confirmed': 'text-blue-400',
            'event_reminder': 'text-orange-400',
            'event_password': 'text-green-400', // ðŸ†•
            'poke': 'text-pink-400',
        };
        return colors[type] || 'text-white';
    };
    const getUserAvatar = (notification) => {
        if (notification.participation?.user?.avatar_url) {
            return notification.participation.user.avatar_url;
        }
        const username = notification.participation?.user?.username || 'UsuÃ¡rio';
        return `https://ui-avatars.com/api/?name=${encodeURIComponent(username)}&background=8b5cf6&color=fff&size=48`;
    };
    const allItems = [
        ...notifications.map((n) => ({ ...n, type: 'notification' })),
        ...pokes.map((p) => ({
            ...p,
            type: 'poke',
            notification_type: 'poke',
            title: 'Novo Tok!',
            message: `${p.profiles?.full_name || p.profiles?.username || 'AlguÃ©m'} te enviou um Tok ðŸ‘‹`,
            sent: p.read,
        })),
    ].sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
    return ((0, jsx_runtime_1.jsxs)("div", { className: "relative", children: [(0, jsx_runtime_1.jsxs)("button", { onClick: () => setIsOpen(!isOpen), className: "relative p-2 rounded-full text-white/70 hover:text-white hover:bg-white/10 transition-colors", "aria-label": "Notifica\u00E7\u00F5es", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Bell, { className: "w-6 h-6" }), unreadCount > 0 && ((0, jsx_runtime_1.jsx)(framer_motion_1.motion.span, { initial: { scale: 0 }, animate: { scale: 1 }, className: "absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-semibold", children: unreadCount > 9 ? '9+' : unreadCount }))] }), (0, jsx_runtime_1.jsx)(framer_motion_1.AnimatePresence, { children: isOpen && ((0, jsx_runtime_1.jsxs)(framer_motion_1.motion.div, { initial: { opacity: 0, y: -10, scale: 0.95 }, animate: { opacity: 1, y: 0, scale: 1 }, exit: { opacity: 0, y: -10, scale: 0.95 }, className: "absolute top-full right-0 mt-2 w-96 max-h-[600px] bg-gray-900/95 backdrop-blur-xl rounded-2xl border border-white/10 shadow-2xl z-[70] overflow-hidden", children: [(0, jsx_runtime_1.jsx)("div", { className: "p-4 border-b border-white/10", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between mb-2", children: [(0, jsx_runtime_1.jsxs)("h3", { className: "text-white font-semibold text-lg flex items-center gap-2", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Bell, { className: "w-5 h-5" }), "Notifica\u00E7\u00F5es"] }), unreadCount > 0 && ((0, jsx_runtime_1.jsx)("button", { onClick: handleMarkAllAsRead, className: "text-purple-400 hover:text-purple-300 text-sm font-medium", children: "Marcar todas como lidas" }))] }) }), (0, jsx_runtime_1.jsx)("div", { className: "overflow-y-auto max-h-[500px]", children: loading ? ((0, jsx_runtime_1.jsx)("div", { className: "flex items-center justify-center p-8", children: (0, jsx_runtime_1.jsx)(lucide_react_1.Bell, { className: "w-8 h-8 text-white/40 animate-pulse" }) })) : allItems.length === 0 ? ((0, jsx_runtime_1.jsxs)("div", { className: "flex flex-col items-center justify-center p-8 text-center", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Bell, { className: "w-12 h-12 text-white/20 mb-3" }), (0, jsx_runtime_1.jsx)("p", { className: "text-white/60 text-sm", children: "Nenhuma notifica\u00E7\u00E3o" })] })) : ((0, jsx_runtime_1.jsx)("div", { className: "divide-y divide-white/10", children: allItems.map((item) => {
                                    const Icon = getNotificationIcon(item.notification_type);
                                    const iconColor = getNotificationColor(item.notification_type);
                                    const isUnread = !item.sent;
                                    const isPasswordNotif = item.notification_type === 'event_password'; // ðŸ†•
                                    return ((0, jsx_runtime_1.jsx)(framer_motion_1.motion.button, { onClick: () => {
                                            if (item.type === 'poke') {
                                                handlePokeClick(item);
                                            }
                                            else {
                                                handleNotificationClick(item);
                                            }
                                        }, className: `w-full text-left p-4 hover:bg-white/5 transition-colors ${isUnread ? 'bg-purple-500/10' : ''} ${isPasswordNotif ? 'bg-green-500/5' : ''}`, whileHover: { x: 4 }, children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-start gap-3", children: [item.type === 'poke' && item.profiles ? ((0, jsx_runtime_1.jsxs)("div", { className: "relative flex-shrink-0", children: [(0, jsx_runtime_1.jsx)("img", { src: item.profiles.avatar_url ||
                                                                `https://ui-avatars.com/api/?name=${encodeURIComponent(item.profiles.username || 'User')}&background=8b5cf6&color=fff&size=48`, alt: item.profiles.username, className: "w-10 h-10 rounded-full border-2 border-pink-500/50 object-cover", onError: (e) => {
                                                                e.target.src = `https://ui-avatars.com/api/?name=${encodeURIComponent(item.profiles?.username || 'User')}&background=8b5cf6&color=fff&size=48`;
                                                            } }), (0, jsx_runtime_1.jsx)("div", { className: "absolute -bottom-1 -right-1 w-5 h-5 rounded-full bg-pink-500 flex items-center justify-center", children: (0, jsx_runtime_1.jsx)(lucide_react_1.Hand, { className: "w-3 h-3 text-white" }) })] })) : item.notification_type === 'Candidatura Recebida' && item.participation?.user ? ((0, jsx_runtime_1.jsxs)("div", { className: "relative flex-shrink-0", children: [(0, jsx_runtime_1.jsx)("img", { src: getUserAvatar(item), alt: item.participation.user.username, className: "w-10 h-10 rounded-full border-2 border-purple-500/50 object-cover", onError: (e) => {
                                                                e.target.src = `https://ui-avatars.com/api/?name=${encodeURIComponent(item.participation?.user?.username || 'User')}&background=8b5cf6&color=fff&size=48`;
                                                            } }), (0, jsx_runtime_1.jsx)("div", { className: "absolute -bottom-1 -right-1 w-5 h-5 rounded-full bg-purple-500 flex items-center justify-center", children: (0, jsx_runtime_1.jsx)(Icon, { className: "w-3 h-3 text-white" }) })] })) : ((0, jsx_runtime_1.jsx)("div", { className: `w-10 h-10 rounded-full bg-white/10 flex items-center justify-center flex-shrink-0 ${iconColor}`, children: (0, jsx_runtime_1.jsx)(Icon, { className: "w-5 h-5" }) })), (0, jsx_runtime_1.jsxs)("div", { className: "flex-1 min-w-0", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-start justify-between gap-2 mb-1", children: [(0, jsx_runtime_1.jsx)("p", { className: "text-white font-medium text-sm", children: item.title }), isUnread && ((0, jsx_runtime_1.jsx)("div", { className: "w-2 h-2 rounded-full bg-purple-500 flex-shrink-0 mt-1" }))] }), (0, jsx_runtime_1.jsx)("p", { className: "text-white/60 text-sm mb-2", children: item.message }), renderPasswordNotification(item), (0, jsx_runtime_1.jsx)("p", { className: "text-white/40 text-xs mt-2", children: (0, date_fns_1.format)(new Date(item.created_at), "dd/MM 'Ã s' HH:mm", { locale: locale_1.ptBR }) })] })] }) }, `${item.type}-${item.id}`));
                                }) })) }), allItems.length > 0 && ((0, jsx_runtime_1.jsx)("div", { className: "p-3 text-center border-t border-white/10", children: (0, jsx_runtime_1.jsx)("button", { onClick: () => {
                                    navigate('/notifications');
                                    setIsOpen(false);
                                }, className: "text-purple-400 hover:text-purple-300 text-sm font-medium", children: "Ver todas as notifica\u00E7\u00F5es" }) }))] })) })] }));
};
NotificationDropdown.propTypes = {
    userId: prop_types_1.default.string.isRequired,
};
exports.default = NotificationDropdown;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxjb21wb25lbnRzXFxOb3RpZmljYXRpb25Ecm9wZG93bi5qc3giLCJtYXBwaW5ncyI6Ijs7OztBQUFBLHVEQUFnRTtBQUNoRSxvRUFBbUM7QUFDbkMsaURBQXdEO0FBQ3hELCtDQUFzSDtBQUN0SCx1REFBK0M7QUFDL0MseURBQWdEO0FBQ2hELGlHQUFpRTtBQUNqRSx1Q0FBa0M7QUFDbEMsNENBQXVDO0FBQ3ZDLHlFQUFxRTtBQUVyRSxNQUFNLG9CQUFvQixHQUFHLENBQUMsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFO0lBQzFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsU0FBUyxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzVDLE1BQU0sQ0FBQyxhQUFhLEVBQUUsZ0JBQWdCLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsRUFBRSxDQUFDLENBQUM7SUFDdkQsTUFBTSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsRUFBRSxDQUFDLENBQUM7SUFDdkMsTUFBTSxDQUFDLFdBQVcsRUFBRSxjQUFjLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsQ0FBQyxDQUFDLENBQUM7SUFDbEQsTUFBTSxDQUFDLE9BQU8sRUFBRSxVQUFVLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsS0FBSyxDQUFDLENBQUM7SUFDOUMsTUFBTSxRQUFRLEdBQUcsSUFBQSw4QkFBVyxHQUFFLENBQUM7SUFDL0IsTUFBTSxFQUFFLEtBQUssRUFBRSxHQUFHLElBQUEsb0JBQVEsR0FBRSxDQUFDO0lBRTdCLE1BQU0saUJBQWlCLEdBQUcsSUFBQSxtQkFBVyxFQUFDLEtBQUssSUFBSSxFQUFFO1FBQy9DLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNqQixJQUFJLE9BQU8sR0FBRyxDQUFDLENBQUM7UUFFaEIsT0FBTyxPQUFPLEdBQUcsQ0FBQyxFQUFFLENBQUM7WUFDbkIsSUFBSSxD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QUFJLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUUsa0JBQWtCLEVBQUUsRUFBRSxNQUFNLEVBQUUsYUFBSSxFQUFFLENBQUMsR0FDdEUsSUFDQSxJQUNGLElBM0VELEdBQUcsSUFBSSxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsRUFBRSxFQUFFLENBNEVoQixDQUNqQixDQUFDO2dDQUNKLENBQUMsQ0FBQyxHQUNFLENBQ1AsR0FDRyxFQUVMLFFBQVEsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxJQUFJLENBQ3RCLGdDQUFLLFNBQVMsRUFBQywwQ0FBMEMsWUFDdkQsbUNBQ0UsT0FBTyxFQUFFLEdBQUcsRUFBRTtvQ0FDWixRQUFRLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztvQ0FDM0IsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO2dDQUNuQixDQUFDLEVBQ0QsU0FBUyxFQUFDLDJEQUEyRCxvREFHOUQsR0FDTCxDQUNQLElBQ1UsQ0FDZCxHQUNlLElBQ2QsQ0FDUCxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBRUYsb0JBQW9CLENBQUMsU0FBUyxHQUFHO0lBQy9CLE1BQU0sRUFBRSxvQkFBUyxDQUFDLE1BQU0sQ0FBQyxVQUFVO0NBQ3BDLENBQUM7QUFFRixrQkFBZSxvQkFBb0IsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcREVWTWl4XFxBcHAuTWVzYXByYTIuY29tXFxzcmNcXGNvbXBvbmVudHNcXE5vdGlmaWNhdGlvbkRyb3Bkb3duLmpzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XHJcbmltcG9ydCB7IG1vdGlvbiwgQW5pbWF0ZVByZXNlbmNlIH0gZnJvbSAnZnJhbWVyLW1vdGlvbic7XHJcbmltcG9ydCB7IEJlbGwsIENoZWNrLCBYLCAgVXNlclBsdXMsICAgQ2FsZW5kYXIsICAgQWxlcnRDaXJjbGUsICAgSGFuZCwgIEtleSwgIENvcHksICBDaGVja0NpcmNsZX0gZnJvbSAnbHVjaWRlLXJlYWN0JztcclxuaW1wb3J0IHsgdXNlTmF2aWdhdGUgfSBmcm9tICdyZWFjdC1yb3V0ZXItZG9tJztcclxuaW1wb3J0IHsgc3VwYWJhc2UgfSBmcm9tICdAL2xpYi9zdXBhYmFzZUNsaWVudCc7XHJcbmltcG9ydCBOb3RpZmljYXRpb25TZXJ2aWNlIGZyb20gJ0Avc2VydmljZXMvTm90aWZpY2F0aW9uU2VydmljZSc7XHJcbmltcG9ydCB7IGZvcm1hdCB9IGZyb20gJ2RhdGUtZm5zJztcclxuaW1wb3J0IHsgcHRCUiB9IGZyb20gJ2RhdGUtZm5zL2xvY2FsZSc7XHJcbmltcG9ydCB7IHVzZVRvYXN0IH0gZnJvbSAnQC9mZWF0dXJlcy9zaGFyZWQvY29tcG9uZW50cy91aS91c2UtdG9hc3QnO1xyXG5cclxuY29uc3QgTm90aWZpY2F0aW9uRHJvcGRvd24gPSAoeyB1c2VySWQgfSkgPT4ge1xyXG4gIGNvbnN0IFtpc09wZW4sIHNldElzT3Blbl0gPSB1c2VTdGF0ZShmYWxzZSk7XHJcbiAgY29uc3QgW25vdGlmaWNhdGlvbnMsIHNldE5vdGlmaWNhdGlvbnNdID0gdXNlU3RhdGUoW10pO1xyXG4gIGNvbnN0IFtwb2tlcywgc2V0UG9rZXNdID0gdXNlU3RhdGUoW10pO1xyXG4gIGNvbnN0IFt1bnJlYWRDb3VudCwgc2V0VW5yZWFkQ291bnRdID0gdXNlU3RhdGUoMCk7XHJcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xyXG4gIGNvbnN0IG5hdmlnYXRlID0gdXNlTmF2aWdhdGUoKTtcclxuICBjb25zdCB7IHRvYXN0IH0gPSB1c2VUb2FzdCgpO1xyXG5cclxuICBjb25zdCBsb2FkTm90aWZpY2F0aW9ucyA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcclxuICAgIHNldExvYWRpbmcodHJ1ZSk7XHJcbiAgICBsZXQgcmV0cmllcyA9IDM7XHJcbiAgICBcclxuICAgIHdoaWxlIChyZXRyaWVzID4gMCkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XHJcbiAgICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIDEwMDAwKTtcclxuXHJcbiAgICAgICAgY29uc3QgeyBkYXRhOiBub3RpZmljYXRpb25zRGF0YSwgZXJyb3I6IG5vdGlmRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgICAuZnJvbSgnbm90aWZpY2F0aW9ucycpXHJcbiAgICAgICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZClcclxuICAgICAgICAgIC5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxyXG4gICAgICAgICAgLmxpbWl0KDEwKTtcclxuXHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XHJcblxyXG4gICAgICAgIGlmIChub3RpZkVycm9yKSB0aHJvdyBub3RpZkVycm9yO1xyXG5cclxuICAgICAgICBjb25zdCBub3RpZmljYXRpb25zV2l0aFVzZXJzID0gYXdhaXQgUHJvbWlzZS5hbGwoXHJcbiAgICAgICAgICAobm90aWZpY2F0aW9uc0RhdGEgfHwgW10pLm1hcChhc3luYyAobm90aWYpID0+IHtcclxuICAgICAgICAgICAgaWYgKG5vdGlmLnBhcnRpY2lwYXRpb25faWQpIHtcclxuICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeyBkYXRhOiBwYXJ0aWNpcGF0aW9uRGF0YSB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAgICAgICAgICAgLmZyb20oJ2V2ZW50X3BhcnRpY2lwYW50cycpXHJcbiAgICAgICAgICAgICAgICAgIC5zZWxlY3QoYFxyXG4gICAgICAgICAgICAgICAgICAgIGlkLFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXJfaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvZmlsZXMhZXZlbnRfcGFydGljaXBhbnRzX3VzZXJfaWRfZmtleShcclxuICAgICAgICAgICAgICAgICAgICAgIGlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICBhdmF0YXJfdXJsXHJcbiAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICBgKVxyXG4gICAgICAgICAgICAgICAgICAuZXEoJ2lkJywgbm90aWYucGFydGljaXBhdGlvbl9pZClcclxuICAgICAgICAgICAgICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgIC4uLm5vdGlmLFxyXG4gICAgICAgICAgICAgICAgICBwYXJ0aWNpcGF0aW9uOiBwYXJ0aWNpcGF0aW9uRGF0YVxyXG4gICAgICAgICAgICAgICAgICAgID8ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogcGFydGljaXBhdGlvbkRhdGEuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXI6IHBhcnRpY2lwYXRpb25EYXRhLnByb2ZpbGVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIDogbnVsbCxcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyBFcnJvIGFvIGNhcnJlZ2FyIHBhcnRpY2lwYcOnw6NvOicsIGVycik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbm90aWY7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBub3RpZjtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgc2V0Tm90aWZpY2F0aW9ucyhub3RpZmljYXRpb25zV2l0aFVzZXJzKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICByZXRyaWVzLS07XHJcbiAgICAgICAgaWYgKHJldHJpZXMgPT09IDApIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvIGFvIGNhcnJlZ2FyIG5vdGlmaWNhw6fDtWVzIGFww7NzIDMgdGVudGF0aXZhczonLCBlcnJvcik7XHJcbiAgICAgICAgICBzZXROb3RpZmljYXRpb25zKFtdKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY29uc29sZS53YXJuKGDimqDvuI8gRXJybyBhbyBjYXJyZWdhciBub3RpZmljYcOnw7Vlcy4gVGVudGFuZG8gbm92YW1lbnRlLi4uICgke3JldHJpZXN9IHRlbnRhdGl2YXMgcmVzdGFudGVzKWApO1xyXG4gICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMDApKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgfSwgW3VzZXJJZF0pO1xyXG5cclxuICBjb25zdCBsb2FkUG9rZXMgPSB1c2VDYWxsYmFjayhhc3luYyAoKSA9PiB7XHJcbiAgICBsZXQgcmV0cmllcyA9IDM7XHJcbiAgICBcclxuICAgIHdoaWxlIChyZXRyaWVzID4gMCkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XHJcbiAgICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIDEwMDAwKTtcclxuXHJcbiAgICAgICAgY29uc3QgeWVzdGVyZGF5ID0gbmV3IERhdGUoKTtcclxuICAgICAgICB5ZXN0ZXJkYXkuc2V0RGF0ZSh5ZXN0ZXJkYXkuZ2V0RGF0ZSgpIC0gMSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHsgZGF0YTogcG9rZXNEYXRhLCBlcnJvcjogcG9rZXNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAgIC5mcm9tKCdwb2tlcycpXHJcbiAgICAgICAgICAuc2VsZWN0KGBcclxuICAgICAgICAgICAgaWQsXHJcbiAgICAgICAgICAgIGZyb21fdXNlcl9pZCxcclxuICAgICAgICAgICAgY3JlYXRlZF9hdCxcclxuICAgICAgICAgICAgcmVhZCxcclxuICAgICAgICAgICAgcHJvZmlsZXMhcG9rZXNfZnJvbV91c2VyX2lkX2ZrZXkoXHJcbiAgICAgICAgICAgICAgaWQsXHJcbiAgICAgICAgICAgICAgdXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgZnVsbF9uYW1lLFxyXG4gICAgICAgICAgICAgIGF2YXRhcl91cmxcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICAgYClcclxuICAgICAgICAgIC5lcSgndG9fdXNlcl9pZCcsIHVzZXJJZClcclxuICAgICAgICAgIC5ndGUoJ2NyZWF0ZWRfYXQnLCB5ZXN0ZXJkYXkudG9JU09TdHJpbmcoKSlcclxuICAgICAgICAgIC5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxyXG4gICAgICAgICAgLmxpbWl0KDEwKTtcclxuXHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XHJcblxyXG4gICAgICAgIGlmIChwb2tlc0Vycm9yKSB0aHJvdyBwb2tlc0Vycm9yO1xyXG5cclxuICAgICAgICBzZXRQb2tlcyhwb2tlc0RhdGEgfHwgW10pO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIHJldHJpZXMtLTtcclxuICAgICAgICBpZiAocmV0cmllcyA9PT0gMCkge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm8gYW8gY2FycmVnYXIgY3V0dWNhZGFzIGFww7NzIDMgdGVudGF0aXZhczonLCBlcnJvcik7XHJcbiAgICAgICAgICBzZXRQb2tlcyhbXSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnNvbGUud2Fybihg4pqg77iPIEVycm8gYW8gY2FycmVnYXIgY3V0dWNhZGFzLiBUZW50YW5kbyBub3ZhbWVudGUuLi4gKCR7cmV0cmllc30gdGVudGF0aXZhcyByZXN0YW50ZXMpYCk7XHJcbiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwMCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0sIFt1c2VySWRdKTtcclxuXHJcbiAgY29uc3QgbG9hZFVucmVhZENvdW50ID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgbGV0IHJldHJpZXMgPSAzO1xyXG4gICAgXHJcbiAgICB3aGlsZSAocmV0cmllcyA+IDApIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xyXG4gICAgICAgIGNvbnN0IHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gY29udHJvbGxlci5hYm9ydCgpLCAxMDAwMCk7XHJcblxyXG4gICAgICAgIGNvbnN0IG5vdGlmQ291bnQgPSBhd2FpdCBOb3RpZmljYXRpb25TZXJ2aWNlLmdldFVucmVhZENvdW50KHVzZXJJZCk7XHJcbiAgICAgICAgY29uc3QgeyBjb3VudDogcG9rZXNDb3VudCB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAgIC5mcm9tKCdwb2tlcycpXHJcbiAgICAgICAgICAuc2VsZWN0KCcqJywgeyBjb3VudDogJ2V4YWN0JywgaGVhZDogdHJ1ZSB9KVxyXG4gICAgICAgICAgLmVxKCd0b191c2VyX2lkJywgdXNlcklkKVxyXG4gICAgICAgICAgLmVxKCdyZWFkJywgZmFsc2UpO1xyXG5cclxuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcclxuXHJcbiAgICAgICAgc2V0VW5yZWFkQ291bnQobm90aWZDb3VudCArIChwb2tlc0NvdW50IHx8IDApKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICByZXRyaWVzLS07XHJcbiAgICAgICAgaWYgKHJldHJpZXMgPT09IDApIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvIGFvIGNvbnRhciBuw6NvIGxpZGFzIGFww7NzIDMgdGVudGF0aXZhczonLCBlcnJvcik7XHJcbiAgICAgICAgICBzZXRVbnJlYWRDb3VudCgwKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY29uc29sZS53YXJuKGDimqDvuI8gRXJybyBhbyBjb250YXIgbsOjbyBsaWRhcy4gVGVudGFuZG8gbm92YW1lbnRlLi4uICgke3JldHJpZXN9IHRlbnRhdGl2YXMgcmVzdGFudGVzKWApO1xyXG4gICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMDApKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9LCBbdXNlcklkXSk7XHJcblxyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBpZiAoIXVzZXJJZCkgcmV0dXJuO1xyXG5cclxuICAgIGxvYWROb3RpZmljYXRpb25zKCk7XHJcbiAgICBsb2FkUG9rZXMoKTtcclxuICAgIGxvYWRVbnJlYWRDb3VudCgpO1xyXG5cclxuICAgIGNvbnN0IGludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICBsb2FkTm90aWZpY2F0aW9ucygpO1xyXG4gICAgICBsb2FkUG9rZXMoKTtcclxuICAgICAgbG9hZFVucmVhZENvdW50KCk7XHJcbiAgICB9LCAzMDAwMCk7XHJcblxyXG4gICAgbGV0IG5vdGlmQ2hhbm5lbCA9IG51bGw7XHJcbiAgICBsZXQgcG9rZXNDaGFubmVsID0gbnVsbDtcclxuXHJcbiAgICBjb25zdCBzZXR1cENoYW5uZWxzID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIG5vdGlmQ2hhbm5lbCA9IHN1cGFiYXNlXHJcbiAgICAgICAgICAuY2hhbm5lbChgbm90aWZpY2F0aW9uczoke3VzZXJJZH1gKVxyXG4gICAgICAgICAgLm9uKFxyXG4gICAgICAgICAgICAncG9zdGdyZXNfY2hhbmdlcycsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBldmVudDogJ0lOU0VSVCcsXHJcbiAgICAgICAgICAgICAgc2NoZW1hOiAncHVibGljJyxcclxuICAgICAgICAgICAgICB0YWJsZTogJ25vdGlmaWNhdGlvbnMnLFxyXG4gICAgICAgICAgICAgIGZpbHRlcjogYHVzZXJfaWQ9ZXEuJHt1c2VySWR9YCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgKHBheWxvYWQpID0+IHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZygn8J+UlCBOb3ZhIG5vdGlmaWNhw6fDo28gcmVjZWJpZGE6JywgcGF5bG9hZCk7XHJcbiAgICAgICAgICAgICAgbG9hZE5vdGlmaWNhdGlvbnMoKTtcclxuICAgICAgICAgICAgICBsb2FkVW5yZWFkQ291bnQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgKVxyXG4gICAgICAgICAgLnN1YnNjcmliZSgoc3RhdHVzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT09ICdTVUJTQ1JJQkVEJykge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgSW5zY3JpdG8gZW0gbm90aWZpY2HDp8O1ZXMnKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0dXMgPT09ICdDSEFOTkVMX0VSUk9SJykge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvIGFvIGNvbmVjdGFyIGVtIG5vdGlmaWNhw6fDtWVzJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICBwb2tlc0NoYW5uZWwgPSBzdXBhYmFzZVxyXG4gICAgICAgICAgLmNoYW5uZWwoYHBva2VzOiR7dXNlcklkfWApXHJcbiAgICAgICAgICAub24oXHJcbiAgICAgICAgICAgICdwb3N0Z3Jlc19jaGFuZ2VzJyxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgIGV2ZW50OiAnSU5TRVJUJyxcclxuICAgICAgICAgICAgICBzY2hlbWE6ICdwdWJsaWMnLFxyXG4gICAgICAgICAgICAgIHRhYmxlOiAncG9rZXMnLFxyXG4gICAgICAgICAgICAgIGZpbHRlcjogYHRvX3VzZXJfaWQ9ZXEuJHt1c2VySWR9YCxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgKHBheWxvYWQpID0+IHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZygn8J+RiyBOb3ZvIFRvayByZWNlYmlkbzonLCBwYXlsb2FkKTtcclxuICAgICAgICAgICAgICBsb2FkUG9rZXMoKTtcclxuICAgICAgICAgICAgICBsb2FkVW5yZWFkQ291bnQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgKVxyXG4gICAgICAgICAgLnN1YnNjcmliZSgoc3RhdHVzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT09ICdTVUJTQ1JJQkVEJykge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgSW5zY3JpdG8gZW0gdG9rcycpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0YXR1cyA9PT0gJ0NIQU5ORUxfRVJST1InKSB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm8gYW8gY29uZWN0YXIgZW0gdG9rcycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJybyBhbyBjb25maWd1cmFyIGNhbmFpczonLCBlcnJvcik7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgc2V0dXBDaGFubmVscygpO1xyXG5cclxuICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xyXG4gICAgICBpZiAobm90aWZDaGFubmVsKSB7XHJcbiAgICAgICAgbm90aWZDaGFubmVsLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHBva2VzQ2hhbm5lbCkge1xyXG4gICAgICAgIHBva2VzQ2hhbm5lbC51bnN1YnNjcmliZSgpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH0sIFt1c2VySWQsIGxvYWROb3RpZmljYXRpb25zLCBsb2FkUG9rZXMsIGxvYWRVbnJlYWRDb3VudF0pO1xyXG5cclxuICBjb25zdCBoYW5kbGVNYXJrQXNSZWFkID0gYXN5bmMgKG5vdGlmaWNhdGlvbklkKSA9PiB7XHJcbiAgICBhd2FpdCBOb3RpZmljYXRpb25TZXJ2aWNlLm1hcmtBc1JlYWQobm90aWZpY2F0aW9uSWQpO1xyXG4gICAgbG9hZE5vdGlmaWNhdGlvbnMoKTtcclxuICAgIGxvYWRVbnJlYWRDb3VudCgpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZU1hcmtQb2tlQXNSZWFkID0gYXN5bmMgKHBva2VJZCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgncG9rZXMnKVxyXG4gICAgICAgIC51cGRhdGUoeyByZWFkOiB0cnVlIH0pXHJcbiAgICAgICAgLmVxKCdpZCcsIHBva2VJZCk7XHJcblxyXG4gICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xyXG5cclxuICAgICAgbG9hZFBva2VzKCk7XHJcbiAgICAgIGxvYWRVbnJlYWRDb3VudCgpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm8gYW8gbWFyY2FyIHRvayBjb21vIGxpZG86JywgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZU1hcmtBbGxBc1JlYWQgPSBhc3luYyAoKSA9PiB7XHJcbiAgICBhd2FpdCBOb3RpZmljYXRpb25TZXJ2aWNlLm1hcmtBbGxBc1JlYWQodXNlcklkKTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oJ3Bva2VzJylcclxuICAgICAgICAudXBkYXRlKHsgcmVhZDogdHJ1ZSB9KVxyXG4gICAgICAgIC5lcSgndG9fdXNlcl9pZCcsIHVzZXJJZCk7XHJcblxyXG4gICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xyXG5cclxuICAgICAgbG9hZE5vdGlmaWNhdGlvbnMoKTtcclxuICAgICAgbG9hZFBva2VzKCk7XHJcbiAgICAgIGxvYWRVbnJlYWRDb3VudCgpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm8gYW8gbWFyY2FyIHRvZG9zIGNvbW8gbGlkb3M6JywgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZU5vdGlmaWNhdGlvbkNsaWNrID0gKG5vdGlmaWNhdGlvbikgPT4ge1xyXG4gICAgaWYgKG5vdGlmaWNhdGlvbi5ldmVudF9pZCkge1xyXG4gICAgICBuYXZpZ2F0ZShgL2V2ZW50LyR7bm90aWZpY2F0aW9uLmV2ZW50X2lkfWApO1xyXG4gICAgICBoYW5kbGVNYXJrQXNSZWFkKG5vdGlmaWNhdGlvbi5pZCk7XHJcbiAgICAgIHNldElzT3BlbihmYWxzZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyBOb3RpZmljYcOnw6NvIHNlbSBldmVudF9pZDonLCBub3RpZmljYXRpb24pO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZVBva2VDbGljayA9IChwb2tlKSA9PiB7XHJcbiAgICBuYXZpZ2F0ZShgL3Byb2ZpbGUvJHtwb2tlLmZyb21fdXNlcl9pZH1gKTtcclxuICAgIGhhbmRsZU1hcmtQb2tlQXNSZWFkKHBva2UuaWQpO1xyXG4gICAgc2V0SXNPcGVuKGZhbHNlKTtcclxuICB9O1xyXG5cclxuICAvLyDwn4aVIEZ1bsOnw6NvIHBhcmEgY29waWFyIHNlbmhhXHJcbiAgY29uc3QgaGFuZGxlQ29weVBhc3N3b3JkID0gKHBhc3N3b3JkLCBldmVudFRpdGxlKSA9PiB7XHJcbiAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChwYXNzd29yZCk7XHJcbiAgICB0b2FzdCh7XHJcbiAgICAgIHRpdGxlOiAn8J+UkCBTZW5oYSBjb3BpYWRhIScsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiBgU2VuaGEgZG8gZXZlbnRvIFwiJHtldmVudFRpdGxlfVwiIGNvcGlhZGEgcGFyYSDDoXJlYSBkZSB0cmFuc2ZlcsOqbmNpYWAsXHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICAvLyDwn4aVIEZ1bsOnw6NvIHBhcmEgcmVuZGVyaXphciBub3RpZmljYcOnw6NvIGNvbSBzZW5oYVxyXG4gIGNvbnN0IHJlbmRlclBhc3N3b3JkTm90aWZpY2F0aW9uID0gKG5vdGlmaWNhdGlvbikgPT4ge1xyXG4gICAgaWYgKG5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25fdHlwZSAhPT0gJ2V2ZW50X3Bhc3N3b3JkJykgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgLy8gRXh0cmFpciBzZW5oYSBkbyBkYXRhIG91IG1lc3NhZ2VcclxuICAgIGNvbnN0IHBhc3N3b3JkID0gbm90aWZpY2F0aW9uLmRhdGE/LnBhc3N3b3JkIHx8IFxyXG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5tZXNzYWdlPy5tYXRjaCgvXFxkezR9Lyk/LlswXTtcclxuXHJcbiAgICBpZiAoIXBhc3N3b3JkKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cIm10LTIgcC0zIHJvdW5kZWQtbGcgYmctZ3JlZW4tNTAwLzEwIGJvcmRlciBib3JkZXItZ3JlZW4tNTAwLzMwXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW5cIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTJcIj5cclxuICAgICAgICAgICAgPEtleSBjbGFzc05hbWU9XCJ3LTQgaC00IHRleHQtZ3JlZW4tNDAwXCIgLz5cclxuICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXhzIHRleHQtZ3JlZW4tMzAwIGZvbnQtc2VtaWJvbGRcIj5TZW5oYSBkZSBFbnRyYWRhPC9wPlxyXG4gICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtMnhsIGZvbnQtYm9sZCB0ZXh0LWdyZWVuLTQwMCBmb250LW1vbm8gdHJhY2tpbmctd2lkZXJcIj5cclxuICAgICAgICAgICAgICAgIHtwYXNzd29yZH1cclxuICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgIG9uQ2xpY2s9eyhlKSA9PiB7XHJcbiAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICBoYW5kbGVDb3B5UGFzc3dvcmQocGFzc3dvcmQsIG5vdGlmaWNhdGlvbi50aXRsZSk7XHJcbiAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cInAtMiByb3VuZGVkLWxnIGhvdmVyOmJnLXdoaXRlLzEwIHRleHQtZ3JlZW4tNDAwIHRyYW5zaXRpb24tY29sb3JzXCJcclxuICAgICAgICAgICAgdGl0bGU9XCJDb3BpYXIgc2VuaGFcIlxyXG4gICAgICAgICAgPlxyXG4gICAgICAgICAgICA8Q29weSBjbGFzc05hbWU9XCJ3LTQgaC00XCIgLz5cclxuICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC1ncmVlbi0yMDAvNzAgbXQtMlwiPlxyXG4gICAgICAgICAgQ29tcGFydGlsaGUgZXN0YSBzZW5oYSBjb20gb3MgcGFydGljaXBhbnRlcyBwYXJhIGVudHJhcmVtIG5vIGV2ZW50b1xyXG4gICAgICAgIDwvcD5cclxuICAgICAgPC9kaXY+XHJcbiAgICApO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGdldE5vdGlmaWNhdGlvbkljb24gPSAodHlwZSkgPT4ge1xyXG4gICAgY29uc3QgaWNvbnMgPSB7XHJcbiAgICAgICdDYW5kaWRhdHVyYSBSZWNlYmlkYSc6IFVzZXJQbHVzLFxyXG4gICAgICAnQ2FuZGlkYXR1cmEgQXByb3ZhZGEnOiBDaGVjayxcclxuICAgICAgJ0NhbmRpZGF0dXJhIFJlamVpdGFkYSc6IFgsXHJcbiAgICAgICdOb3ZvIEV2ZW50byc6IENhbGVuZGFyLFxyXG4gICAgICAnZXZlbnRfY2FuY2VsbGVkJzogQWxlcnRDaXJjbGUsXHJcbiAgICAgICdldmVudF9jb25maXJtZWQnOiBDaGVjayxcclxuICAgICAgJ2V2ZW50X3JlbWluZGVyJzogQ2FsZW5kYXIsXHJcbiAgICAgICdldmVudF9wYXNzd29yZCc6IEtleSwgLy8g8J+GlVxyXG4gICAgICAncG9rZSc6IEhhbmQsXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGljb25zW3R5cGVdIHx8IEJlbGw7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgZ2V0Tm90aWZpY2F0aW9uQ29sb3IgPSAodHlwZSkgPT4ge1xyXG4gICAgY29uc3QgY29sb3JzID0ge1xyXG4gICAgICAnQ2FuZGlkYXR1cmEgUmVjZWJpZGEnOiAndGV4dC1wdXJwbGUtNDAwJyxcclxuICAgICAgJ0NhbmRpZGF0dXJhIEFwcm92YWRhJzogJ3RleHQtZ3JlZW4tNDAwJyxcclxuICAgICAgJ0NhbmRpZGF0dXJhIFJlamVpdGFkYSc6ICd0ZXh0LXJlZC00MDAnLFxyXG4gICAgICAnTm92byBFdmVudG8nOiAndGV4dC1ibHVlLTQwMCcsXHJcbiAgICAgICdldmVudF9jYW5jZWxsZWQnOiAndGV4dC15ZWxsb3ctNDAwJyxcclxuICAgICAgJ2V2ZW50X2NvbmZpcm1lZCc6ICd0ZXh0LWJsdWUtNDAwJyxcclxuICAgICAgJ2V2ZW50X3JlbWluZGVyJzogJ3RleHQtb3JhbmdlLTQwMCcsXHJcbiAgICAgICdldmVudF9wYXNzd29yZCc6ICd0ZXh0LWdyZWVuLTQwMCcsIC8vIPCfhpVcclxuICAgICAgJ3Bva2UnOiAndGV4dC1waW5rLTQwMCcsXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGNvbG9yc1t0eXBlXSB8fCAndGV4dC13aGl0ZSc7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgZ2V0VXNlckF2YXRhciA9IChub3RpZmljYXRpb24pID0+IHtcclxuICAgIGlmIChub3RpZmljYXRpb24ucGFydGljaXBhdGlvbj8udXNlcj8uYXZhdGFyX3VybCkge1xyXG4gICAgICByZXR1cm4gbm90aWZpY2F0aW9uLnBhcnRpY2lwYXRpb24udXNlci5hdmF0YXJfdXJsO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdXNlcm5hbWUgPSBub3RpZmljYXRpb24ucGFydGljaXBhdGlvbj8udXNlcj8udXNlcm5hbWUgfHwgJ1VzdcOhcmlvJztcclxuICAgIHJldHVybiBgaHR0cHM6Ly91aS1hdmF0YXJzLmNvbS9hcGkvP25hbWU9JHtlbmNvZGVVUklDb21wb25lbnQodXNlcm5hbWUpfSZiYWNrZ3JvdW5kPThiNWNmNiZjb2xvcj1mZmYmc2l6ZT00OGA7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgYWxsSXRlbXMgPSBbXHJcbiAgICAuLi5ub3RpZmljYXRpb25zLm1hcCgobikgPT4gKHsgLi4ubiwgdHlwZTogJ25vdGlmaWNhdGlvbicgfSkpLFxyXG4gICAgLi4ucG9rZXMubWFwKChwKSA9PiAoe1xyXG4gICAgICAuLi5wLFxyXG4gICAgICB0eXBlOiAncG9rZScsXHJcbiAgICAgIG5vdGlmaWNhdGlvbl90eXBlOiAncG9rZScsXHJcbiAgICAgIHRpdGxlOiAnTm92byBUb2shJyxcclxuICAgICAgbWVzc2FnZTogYCR7cC5wcm9maWxlcz8uZnVsbF9uYW1lIHx8IHAucHJvZmlsZXM/LnVzZXJuYW1lIHx8ICdBbGd1w6ltJ30gdGUgZW52aW91IHVtIFRvayDwn5GLYCxcclxuICAgICAgc2VudDogcC5yZWFkLFxyXG4gICAgfSkpLFxyXG4gIF0uc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYi5jcmVhdGVkX2F0KSAtIG5ldyBEYXRlKGEuY3JlYXRlZF9hdCkpO1xyXG5cclxuICByZXR1cm4gKFxyXG4gICAgPGRpdiBjbGFzc05hbWU9XCJyZWxhdGl2ZVwiPlxyXG4gICAgICA8YnV0dG9uXHJcbiAgICAgICAgb25DbGljaz17KCkgPT4gc2V0SXNPcGVuKCFpc09wZW4pfVxyXG4gICAgICAgIGNsYXNzTmFtZT1cInJlbGF0aXZlIHAtMiByb3VuZGVkLWZ1bGwgdGV4dC13aGl0ZS83MCBob3Zlcjp0ZXh0LXdoaXRlIGhvdmVyOmJnLXdoaXRlLzEwIHRyYW5zaXRpb24tY29sb3JzXCJcclxuICAgICAgICBhcmlhLWxhYmVsPVwiTm90aWZpY2HDp8O1ZXNcIlxyXG4gICAgICA+XHJcbiAgICAgICAgPEJlbGwgY2xhc3NOYW1lPVwidy02IGgtNlwiIC8+XHJcbiAgICAgICAge3VucmVhZENvdW50ID4gMCAmJiAoXHJcbiAgICAgICAgICA8bW90aW9uLnNwYW5cclxuICAgICAgICAgICAgaW5pdGlhbD17eyBzY2FsZTogMCB9fVxyXG4gICAgICAgICAgICBhbmltYXRlPXt7IHNjYWxlOiAxIH19XHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImFic29sdXRlIC10b3AtMSAtcmlnaHQtMSBiZy1yZWQtNTAwIHRleHQtd2hpdGUgdGV4dC14cyByb3VuZGVkLWZ1bGwgaC01IHctNSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBmb250LXNlbWlib2xkXCJcclxuICAgICAgICAgID5cclxuICAgICAgICAgICAge3VucmVhZENvdW50ID4gOSA/ICc5KycgOiB1bnJlYWRDb3VudH1cclxuICAgICAgICAgIDwvbW90aW9uLnNwYW4+XHJcbiAgICAgICAgKX1cclxuICAgICAgPC9idXR0b24+XHJcblxyXG4gICAgICA8QW5pbWF0ZVByZXNlbmNlPlxyXG4gICAgICAgIHtpc09wZW4gJiYgKFxyXG4gICAgICAgICAgPG1vdGlvbi5kaXZcclxuICAgICAgICAgICAgaW5pdGlhbD17eyBvcGFjaXR5OiAwLCB5OiAtMTAsIHNjYWxlOiAwLjk1IH19XHJcbiAgICAgICAgICAgIGFuaW1hdGU9e3sgb3BhY2l0eTogMSwgeTogMCwgc2NhbGU6IDEgfX1cclxuICAgICAgICAgICAgZXhpdD17eyBvcGFjaXR5OiAwLCB5OiAtMTAsIHNjYWxlOiAwLjk1IH19XHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImFic29sdXRlIHRvcC1mdWxsIHJpZ2h0LTAgbXQtMiB3LTk2IG1heC1oLVs2MDBweF0gYmctZ3JheS05MDAvOTUgYmFja2Ryb3AtYmx1ci14bCByb3VuZGVkLTJ4bCBib3JkZXIgYm9yZGVyLXdoaXRlLzEwIHNoYWRvdy0yeGwgei1bNzBdIG92ZXJmbG93LWhpZGRlblwiXHJcbiAgICAgICAgICA+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicC00IGJvcmRlci1iIGJvcmRlci13aGl0ZS8xMFwiPlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIG1iLTJcIj5cclxuICAgICAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9XCJ0ZXh0LXdoaXRlIGZvbnQtc2VtaWJvbGQgdGV4dC1sZyBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMlwiPlxyXG4gICAgICAgICAgICAgICAgICA8QmVsbCBjbGFzc05hbWU9XCJ3LTUgaC01XCIgLz5cclxuICAgICAgICAgICAgICAgICAgTm90aWZpY2HDp8O1ZXNcclxuICAgICAgICAgICAgICAgIDwvaDM+XHJcbiAgICAgICAgICAgICAgICB7dW5yZWFkQ291bnQgPiAwICYmIChcclxuICAgICAgICAgICAgICAgICAgPGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZU1hcmtBbGxBc1JlYWR9XHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidGV4dC1wdXJwbGUtNDAwIGhvdmVyOnRleHQtcHVycGxlLTMwMCB0ZXh0LXNtIGZvbnQtbWVkaXVtXCJcclxuICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgIE1hcmNhciB0b2RhcyBjb21vIGxpZGFzXHJcbiAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm92ZXJmbG93LXktYXV0byBtYXgtaC1bNTAwcHhdXCI+XHJcbiAgICAgICAgICAgICAge2xvYWRpbmcgPyAoXHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHAtOFwiPlxyXG4gICAgICAgICAgICAgICAgICA8QmVsbCBjbGFzc05hbWU9XCJ3LTggaC04IHRleHQtd2hpdGUvNDAgYW5pbWF0ZS1wdWxzZVwiIC8+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICApIDogYWxsSXRlbXMubGVuZ3RoID09PSAwID8gKFxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGZsZXgtY29sIGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBwLTggdGV4dC1jZW50ZXJcIj5cclxuICAgICAgICAgICAgICAgICAgPEJlbGwgY2xhc3NOYW1lPVwidy0xMiBoLTEyIHRleHQtd2hpdGUvMjAgbWItM1wiIC8+XHJcbiAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtd2hpdGUvNjAgdGV4dC1zbVwiPk5lbmh1bWEgbm90aWZpY2HDp8OjbzwvcD5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImRpdmlkZS15IGRpdmlkZS13aGl0ZS8xMFwiPlxyXG4gICAgICAgICAgICAgICAgICB7YWxsSXRlbXMubWFwKChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgSWNvbiA9IGdldE5vdGlmaWNhdGlvbkljb24oaXRlbS5ub3RpZmljYXRpb25fdHlwZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaWNvbkNvbG9yID0gZ2V0Tm90aWZpY2F0aW9uQ29sb3IoaXRlbS5ub3RpZmljYXRpb25fdHlwZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNVbnJlYWQgPSAhaXRlbS5zZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzUGFzc3dvcmROb3RpZiA9IGl0ZW0ubm90aWZpY2F0aW9uX3R5cGUgPT09ICdldmVudF9wYXNzd29yZCc7IC8vIPCfhpVcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgICAgIDxtb3Rpb24uYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleT17YCR7aXRlbS50eXBlfS0ke2l0ZW0uaWR9YH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLnR5cGUgPT09ICdwb2tlJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlUG9rZUNsaWNrKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVOb3RpZmljYXRpb25DbGljayhpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YHctZnVsbCB0ZXh0LWxlZnQgcC00IGhvdmVyOmJnLXdoaXRlLzUgdHJhbnNpdGlvbi1jb2xvcnMgJHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBpc1VucmVhZCA/ICdiZy1wdXJwbGUtNTAwLzEwJyA6ICcnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gJHtpc1Bhc3N3b3JkTm90aWYgPyAnYmctZ3JlZW4tNTAwLzUnIDogJyd9YH0gLy8g8J+GlVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZUhvdmVyPXt7IHg6IDQgfX1cclxuICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLXN0YXJ0IGdhcC0zXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAge2l0ZW0udHlwZSA9PT0gJ3Bva2UnICYmIGl0ZW0ucHJvZmlsZXMgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJlbGF0aXZlIGZsZXgtc2hyaW5rLTBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGltZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyYz17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnByb2ZpbGVzLmF2YXRhcl91cmwgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBodHRwczovL3VpLWF2YXRhcnMuY29tL2FwaS8/bmFtZT0ke2VuY29kZVVSSUNvbXBvbmVudChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5wcm9maWxlcy51c2VybmFtZSB8fCAnVXNlcidcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9JmJhY2tncm91bmQ9OGI1Y2Y2JmNvbG9yPWZmZiZzaXplPTQ4YFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHQ9e2l0ZW0ucHJvZmlsZXMudXNlcm5hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy0xMCBoLTEwIHJvdW5kZWQtZnVsbCBib3JkZXItMiBib3JkZXItcGluay01MDAvNTAgb2JqZWN0LWNvdmVyXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkVycm9yPXsoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS50YXJnZXQuc3JjID0gYGh0dHBzOi8vdWktYXZhdGFycy5jb20vYXBpLz9uYW1lPSR7ZW5jb2RlVVJJQ29tcG9uZW50KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnByb2ZpbGVzPy51c2VybmFtZSB8fCAnVXNlcidcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9JmJhY2tncm91bmQ9OGI1Y2Y2JmNvbG9yPWZmZiZzaXplPTQ4YDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFic29sdXRlIC1ib3R0b20tMSAtcmlnaHQtMSB3LTUgaC01IHJvdW5kZWQtZnVsbCBiZy1waW5rLTUwMCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlclwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxIYW5kIGNsYXNzTmFtZT1cInctMyBoLTMgdGV4dC13aGl0ZVwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IGl0ZW0ubm90aWZpY2F0aW9uX3R5cGUgPT09ICdDYW5kaWRhdHVyYSBSZWNlYmlkYScgJiYgaXRlbS5wYXJ0aWNpcGF0aW9uPy51c2VyID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyZWxhdGl2ZSBmbGV4LXNocmluay0wXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcmM9e2dldFVzZXJBdmF0YXIoaXRlbSl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWx0PXtpdGVtLnBhcnRpY2lwYXRpb24udXNlci51c2VybmFtZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LTEwIGgtMTAgcm91bmRlZC1mdWxsIGJvcmRlci0yIGJvcmRlci1wdXJwbGUtNTAwLzUwIG9iamVjdC1jb3ZlclwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25FcnJvcj17KGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUudGFyZ2V0LnNyYyA9IGBodHRwczovL3VpLWF2YXRhcnMuY29tL2FwaS8/bmFtZT0ke2VuY29kZVVSSUNvbXBvbmVudChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5wYXJ0aWNpcGF0aW9uPy51c2VyPy51c2VybmFtZSB8fCAnVXNlcidcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9JmJhY2tncm91bmQ9OGI1Y2Y2JmNvbG9yPWZmZiZzaXplPTQ4YDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFic29sdXRlIC1ib3R0b20tMSAtcmlnaHQtMSB3LTUgaC01IHJvdW5kZWQtZnVsbCBiZy1wdXJwbGUtNTAwIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb24gY2xhc3NOYW1lPVwidy0zIGgtMyB0ZXh0LXdoaXRlXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICApIDogKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2B3LTEwIGgtMTAgcm91bmRlZC1mdWxsIGJnLXdoaXRlLzEwIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIGZsZXgtc2hyaW5rLTAgJHtpY29uQ29sb3J9YH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljb24gY2xhc3NOYW1lPVwidy01IGgtNVwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBtaW4tdy0wXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtc3RhcnQganVzdGlmeS1iZXR3ZWVuIGdhcC0yIG1iLTFcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC13aGl0ZSBmb250LW1lZGl1bSB0ZXh0LXNtXCI+e2l0ZW0udGl0bGV9PC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aXNVbnJlYWQgJiYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy0yIGgtMiByb3VuZGVkLWZ1bGwgYmctcHVycGxlLTUwMCBmbGV4LXNocmluay0wIG10LTFcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXdoaXRlLzYwIHRleHQtc20gbWItMlwiPntpdGVtLm1lc3NhZ2V9PC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Lyog8J+GlSBSZW5kZXJpemFyIHNlbmhhIHNlIGZvciBub3RpZmljYcOnw6NvIGRlIHNlbmhhICovfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3JlbmRlclBhc3N3b3JkTm90aWZpY2F0aW9uKGl0ZW0pfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXdoaXRlLzQwIHRleHQteHMgbXQtMlwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Zm9ybWF0KG5ldyBEYXRlKGl0ZW0uY3JlYXRlZF9hdCksIFwiZGQvTU0gJ8OgcycgSEg6bW1cIiwgeyBsb2NhbGU6IHB0QlIgfSl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9tb3Rpb24uYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgIH0pfVxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICB7YWxsSXRlbXMubGVuZ3RoID4gMCAmJiAoXHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwLTMgdGV4dC1jZW50ZXIgYm9yZGVyLXQgYm9yZGVyLXdoaXRlLzEwXCI+XHJcbiAgICAgICAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBuYXZpZ2F0ZSgnL25vdGlmaWNhdGlvbnMnKTtcclxuICAgICAgICAgICAgICAgICAgICBzZXRJc09wZW4oZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0ZXh0LXB1cnBsZS00MDAgaG92ZXI6dGV4dC1wdXJwbGUtMzAwIHRleHQtc20gZm9udC1tZWRpdW1cIlxyXG4gICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICBWZXIgdG9kYXMgYXMgbm90aWZpY2HDp8O1ZXNcclxuICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICApfVxyXG4gICAgICAgICAgPC9tb3Rpb24uZGl2PlxyXG4gICAgICAgICl9XHJcbiAgICAgIDwvQW5pbWF0ZVByZXNlbmNlPlxyXG4gICAgPC9kaXY+XHJcbiAgKTtcclxufTtcclxuXHJcbk5vdGlmaWNhdGlvbkRyb3Bkb3duLnByb3BUeXBlcyA9IHtcclxuICB1c2VySWQ6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IE5vdGlmaWNhdGlvbkRyb3Bkb3duOyJdLCJ2ZXJzaW9uIjozfQ==