614973ea079d3cfa548577ec9c9e3847
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const prop_types_1 = tslib_1.__importDefault(require("prop-types"));
const lucide_react_1 = require("lucide-react");
const AuthContext_1 = require("@/contexts/AuthContext");
const use_toast_1 = require("@/features/shared/components/ui/use-toast");
const supabaseClient_1 = require("@/lib/supabaseClient");
const RatingService_1 = tslib_1.__importDefault(require("@/services/RatingService"));
const RatingModal_1 = tslib_1.__importDefault(require("./RatingModal"));
// 1. CORREÇÃO: 'hostName' removido, pois não estava sendo usado.
const EventRating = ({ eventId, hostId, onAllRatingsComplete }) => {
    const { user } = (0, AuthContext_1.useAuth)();
    // 2. CORREÇÃO: 'toast' agora será usado nos blocos 'catch'.
    const { toast } = (0, use_toast_1.useToast)();
    const [isLoading, setIsLoading] = (0, react_1.useState)(true);
    const [error, setError] = (0, react_1.useState)(null);
    const [hostData, setHostData] = (0, react_1.useState)(null);
    const [participants, setParticipants] = (0, react_1.useState)([]);
    const [ratedStatus, setRatedStatus] = (0, react_1.useState)({});
    const [selectedRatingModal, setSelectedRatingModal] = (0, react_1.useState)(null);
    const loadRatingData = (0, react_1.useCallback)(async () => {
        try {
            setIsLoading(true);
            setError(null);
            const { data: host, error: hostError } = await supabaseClient_1.supabase
                .from('profiles')
                .select('id, username, avatar_url, reputation_stars')
                .eq('id', hostId)
                .single();
            if (hostError)
                throw hostError;
            setHostData(host);
            const { data: eventParticipants, error: partError } = await supabaseClient_1.supabase
                .from('event_participants')
                .select(`
          id,
          participant_id,
          status,
          presenca_confirmada,
          participant:profiles(id, username, avatar_url, reputation_stars)
        `)
                .eq('event_id', eventId)
                .eq('presenca_confirmada', true)
                .not('participant_id', 'eq', user.id);
            if (partError)
                throw partError;
            const validParticipants = (eventParticipants || []).filter(p => p.participant && p.participant_id !== hostId);
            setParticipants(validParticipants);
            // 3. CORREÇÃO (IMPORTANTE): Removemos a chamada do loadRatingStatus daqui
            // para quebrar o loop infinito de dependência.
            // await loadRatingStatus(); 
        }
        catch (err) {
            console.error('Erro ao carregar dados de avaliação:', err);
            setError('Erro ao carregar dados. Tente novamente.');
            // 2. CORREÇÃO: Usando o 'toast' no erro.
            toast({
                title: 'Erro ao carregar dados',
                description: 'Não foi possível buscar os participantes para avaliação.',
                variant: 'destructive',
            });
        }
        finally {
            setIsLoading(false);
        }
        // 4. CORREÇÃO: Adicionado 'toast' às dependências. 'loadRatingStatus' foi removido.
    }, [eventId, hostId, user.id, toast]);
    const loadRatingStatus = (0, react_1.useCallback)(async () => {
        try {
            const status = {};
            if (hostData) {
                const hasHostRating = await RatingService_1.default.hasUserRated(eventId, user.id, hostId, 'host');
                status[`host-${hostId}`] = hasHostRating;
            }
            for (const p of participants) {
                const hasParticipantRating = await RatingService_1.default.hasUserRated(eventId, user.id, p.participant_id, 'participant');
                status[`participant-${p.participant_id}`] = hasParticipantRating;
            }
            setRatedStatus(status);
        }
        catch (error) {
            console.error('Erro ao carregar status de avaliações:', error);
            // 2. CORREÇÃO: Usando o 'toast' no erro.
            toast({
                title: 'Erro ao verificar status',
                description: 'Não foi possível verificar suas avaliações pendentes.',
                variant: 'destructive',
            });
        }
        // 5. CORREÇÃO: Adicionado 'toast' às dependências.
    }, [eventId, hostData, hostId, participants, user.id, toast]);
    // useEffect 1: Busca os dados principais (participantes e host)
    (0, react_1.useEffect)(() => {
        if (eventId && user) {
            loadRatingData();
        }
    }, [eventId, user, loadRatingData]);
    // 6. CORREÇÃO (IMPORTANTE): Novo useEffect para carregar o STATUS das avaliações.
    // Ele só roda DEPOIS que 'hostData' ou 'participants' forem carregados,
    // quebrando o ciclo de dependência.
    (0, react_1.useEffect)(() => {
        if (hostData || participants.length > 0) {
            loadRatingStatus();
        }
    }, [hostData, participants, loadRatingStatus]);
    const handleRatingClick = (targetUser, ratingType) => {
        setSelectedRatingModal({
            targetUser,
            ratingType,
            ratedId: targetUser.id,
            ratedName: targetUser.username
        });
    };
    const handleRatingSubmit = async () => {
        // Recarrega o status após uma avaliação ser submetida
        await loadRatingStatus();
        // NOTA: É preciso checar o 'ratedStatus' atualizado.
        // O 'loadRatingStatus' atualiza o estado, mas o 'ratedStatus'
        // nesta função ainda será o antigo. Precisamos de uma lógica
        // um pouco diferente para verificar 'allRated'
        // Vamos re-checar o status aqui
        const status = {};
        if (hostData) {
            const hasHostRating = await RatingService_1.default.hasUserRated(eventId, user.id, hostId, 'host');
            status[`host-${hostId}`] = hasHostRating;
        }
        for (const p of participants) {
            const hasParticipantRating = await RatingService_1.default.hasUserRated(eventId, user.id, p.participant_id, 'participant');
            status[`participant-${p.participant_id}`] = hasParticipantRating;
        }
        setRatedStatus(status); // Atualiza o estado para a UI
        // Verifica com o status recém-buscado
        const allRated = participants.every(p => status[`participant-${p.participant_id}`]) && status[`host-${hostId}`];
        if (allRated && onAllRatingsComplete) {
            onAllRatingsComplete();
        }
    };
    if (isLoading) {
        return (0, jsx_runtime_1.jsx)("div", { className: "text-white/60 text-center py-8", children: "Carregando avalia\u00E7\u00F5es..." });
    }
    if (error) {
        return ((0, jsx_runtime_1.jsxs)("div", { className: "bg-red-500/10 border border-red-500/20 rounded-2xl p-6 text-center", children: [(0, jsx_runtime_1.jsx)("p", { className: "text-red-200", children: error }), (0, jsx_runtime_1.jsx)("button", { onClick: () => loadRatingData(), className: "mt-4 px-4 py-2 bg-red-600/50 hover:bg-red-600 text-white rounded-lg transition-colors", children: "Tentar Novamente" })] }));
    }
    const hostRated = ratedStatus[`host-${hostId}`];
    const participantsRated = participants.filter(p => ratedStatus[`participant-${p.participant_id}`]);
    const allRated = hostRated && participantsRated.length === participants.length;
    // Evita divisão por zero se não houver participantes + host
    const totalToRate = participants.length + (hostData ? 1 : 0);
    const totalRated = participantsRated.length + (hostRated ? 1 : 0);
    const percentage = totalToRate > 0 ? (totalRated / totalToRate) * 100 : 100;
    return ((0, jsx_runtime_1.jsxs)("div", { className: "space-y-6", children: [(0, jsx_runtime_1.jsxs)("div", { className: "glass-effect rounded-2xl p-6 border border-white/10", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between mb-4", children: [(0, jsx_runtime_1.jsx)("h2", { className: "text-xl font-bold text-white", children: "Avalia\u00E7\u00F5es do Evento" }), totalToRate > 0 && ((0, jsx_runtime_1.jsxs)("span", { className: "text-sm font-semibold px-3 py-1 rounded-full bg-purple-600/30 text-purple-200 border border-purple-500/30", children: [totalRated, " / ", totalToRate] }))] }), totalToRate > 0 && ((0, jsx_runtime_1.jsx)("div", { className: "w-full bg-white/10 rounded-full h-2 overflow-hidden", children: (0, jsx_runtime_1.jsx)("div", { className: "bg-gradient-to-r from-yellow-400 to-yellow-600 h-full transition-all duration-500", style: {
                                width: `${percentage}%`
                            } }) })), allRated && totalToRate > 0 && ((0, jsx_runtime_1.jsx)("div", { className: "mt-4 bg-green-500/10 border border-green-500/20 rounded-lg p-3", children: (0, jsx_runtime_1.jsxs)("p", { className: "text-sm text-green-200 flex items-center gap-2", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Check, { size: 16, className: "text-green-400" }), "Voc\u00EA completou todas as avalia\u00E7\u00F5es!"] }) }))] }), hostData && ((0, jsx_runtime_1.jsx)("div", { className: "glass-effect rounded-2xl p-6 border border-white/10 hover:border-white/20 transition-all", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-4 flex-1", children: [(0, jsx_runtime_1.jsx)("div", { className: "w-16 h-16 rounded-full bg-gradient-to-br from-purple-400 to-pink-400 p-1 flex-shrink-0", children: hostData.avatar_url ? ((0, jsx_runtime_1.jsx)("img", { src: hostData.avatar_url, alt: hostData.username, className: "w-full h-full rounded-full object-cover" })) : ((0, jsx_runtime_1.jsx)("div", { className: "w-full h-full rounded-full bg-white/10 flex items-center justify-center text-white font-semibold", children: hostData.username?.[0]?.toUpperCase() })) }), (0, jsx_runtime_1.jsxs)("div", { className: "flex-1", children: [(0, jsx_runtime_1.jsx)("h3", { className: "text-lg font-bold text-white", children: hostData.username }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-white/60", children: "Anfitri\u00E3o do evento" }), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2 mt-2", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex gap-1", children: [...Array(5)].map((_, i) => ((0, jsx_runtime_1.jsx)(lucide_react_1.Star, { size: 16, className: i < Math.floor(hostData.reputation_stars || 0)
                                                            ? 'fill-yellow-400 text-yellow-400'
                                                            : 'text-white/20' }, i))) }), (0, jsx_runtime_1.jsxs)("span", { className: "text-sm text-white/60", children: [hostData.reputation_stars || '0', " estrelas"] })] })] })] }), (0, jsx_runtime_1.jsx)("div", { className: "flex flex-col items-end gap-2", children: hostRated ? ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2 px-3 py-2 rounded-lg bg-green-500/10 border border-green-500/20", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Check, { size: 18, className: "text-green-400" }), (0, jsx_runtime_1.jsx)("span", { className: "text-sm font-semibold text-green-200", children: "Avaliado" })] })) : ((0, jsx_runtime_1.jsx)("button", { onClick: () => handleRatingClick(hostData, 'host'), className: "px-4 py-2 rounded-lg bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white font-semibold transition-all hover:shadow-lg active:scale-95", children: "Avaliar" })) })] }) })), participants.length > 0 && ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-3", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex-1 h-px bg-white/10" }), (0, jsx_runtime_1.jsx)("span", { className: "text-xs font-semibold text-white/50 px-2", children: "PARTICIPANTES" }), (0, jsx_runtime_1.jsx)("div", { className: "flex-1 h-px bg-white/10" })] })), participants.length > 0 ? ((0, jsx_runtime_1.jsx)("div", { className: "space-y-3", children: participants.map((participation) => {
                    const participant = participation.participant;
                    const isRated = ratedStatus[`participant-${participant.id}`];
                    return ((0, jsx_runtime_1.jsx)("div", { className: "glass-effect rounded-2xl p-4 border border-white/10 hover:border-white/20 transition-all", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-3 flex-1", children: [(0, jsx_runtime_1.jsx)("div", { className: "w-12 h-12 rounded-full bg-gradient-to-br from-blue-400 to-cyan-400 p-1 flex-shrink-0", children: participant.avatar_url ? ((0, jsx_runtime_1.jsx)("img", { src: participant.avatar_url, alt: participant.username, className: "w-full h-full rounded-full object-cover" })) : ((0, jsx_runtime_1.jsx)("div", { className: "w-full h-full rounded-full bg-white/10 flex items-center justify-center text-white font-semibold text-sm", children: participant.username?.[0]?.toUpperCase() })) }), (0, jsx_runtime_1.jsxs)("div", { className: "flex-1 min-w-0", children: [(0, jsx_runtime_1.jsx)("h4", { className: "font-semibold text-white truncate", children: participant.username }), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex gap-0.5", children: [...Array(5)].map((_, i) => ((0, jsx_runtime_1.jsx)(lucide_react_1.Star, { size: 12, className: i < Math.floor(participant.reputation_stars || 0)
                                                                    ? 'fill-yellow-400 text-yellow-400'
                                                                    : 'text-white/20' }, i))) }), (0, jsx_runtime_1.jsx)("span", { className: "text-xs text-white/60", children: participant.reputation_stars || '0' })] })] })] }), isRated ? ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-1.5 px-2 py-1 rounded-lg bg-green-500/10 border border-green-500/20 flex-shrink-0", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Check, { size: 14, className: "text-green-400" }), (0, jsx_runtime_1.jsx)("span", { className: "text-xs font-semibold text-green-200", children: "Avaliado" })] })) : ((0, jsx_runtime_1.jsx)("button", { onClick: () => handleRatingClick(participant, 'participant'), className: "px-3 py-1.5 rounded-lg bg-white/10 hover:bg-white/20 text-white font-semibold text-sm transition-colors flex-shrink-0", children: "Avaliar" }))] }) }, participant.id));
                }) })) : ((0, jsx_runtime_1.jsxs)("div", { className: "text-center py-8 text-white/60", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Clock, { size: 32, className: "mx-auto mb-3 opacity-50" }), (0, jsx_runtime_1.jsx)("p", { children: "Nenhum outro participante confirmou presen\u00E7a" })] })), selectedRatingModal && ((0, jsx_runtime_1.jsx)(RatingModal_1.default, { isOpen: true, onClose: () => setSelectedRatingModal(null), eventId: eventId, raterId: user.id, ratedId: selectedRatingModal.ratedId, ratedName: selectedRatingModal.ratedName, ratingType: selectedRatingModal.ratingType, onRatingSubmit: handleRatingSubmit }))] }));
};
// 7. CORREÇÃO: Removido 'hostName' dos propTypes.
EventRating.propTypes = {
    eventId: prop_types_1.default.number.isRequired,
    hostId: prop_types_1.default.string.isRequired,
    onAllRatingsComplete: prop_types_1.default.func
};
exports.default = EventRating;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxmZWF0dXJlc1xcc2hhcmVkXFxjb21wb25lbnRzXFxldmVudHNcXEV2ZW50UmF0aW5nLmpzeCIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsaUNBQXlEO0FBQ3pELG9FQUFtQztBQUNuQywrQ0FBa0Q7QUFDbEQsd0RBQWlEO0FBQ2pELHlFQUFxRTtBQUNyRSx5REFBZ0Q7QUFDaEQscUZBQXFEO0FBQ3JELHdFQUF3QztBQUV4QyxpRUFBaUU7QUFDakUsTUFBTSxXQUFXLEdBQUcsQ0FBQyxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsb0JBQW9CLEVBQUUsRUFBRSxFQUFFO0lBQ2hFLE1BQU0sRUFBRSxJQUFJLEVBQUUsR0FBRyxJQUFBLHFCQUFPLEdBQUUsQ0FBQztJQUMzQiw0REFBNEQ7SUFDNUQsTUFBTSxFQUFFLEtBQUssRUFBRSxHQUFHLElBQUEsb0JBQVEsR0FBRSxDQUFDO0lBRTdCLE1BQU0sQ0FBQyxTQUFTLEVBQUUsWUFBWSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2pELE1BQU0sQ0FBQyxLQUFLLEVBQUUsUUFBUSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3pDLE1BQU0sQ0FBQyxRQUFRLEVBQUUsV0FBVyxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLElBQUksQ0FBQyxDQUFDO0lBQy9DLE1BQU0sQ0FBQyxZQUFZLEVBQUUsZUFBZSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ3JELE1BQU0sQ0FBQyxXQUFXLEVBQUUsY0FBYyxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ25ELE1BQU0sQ0FBQyxtQkFBbUIsRUFBRSxzQkFBc0IsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxJQUFJLENBQUMsQ0FBQztJQUVyRSxNQUFNLGNBQWMsR0FBRyxJQUFBLG1CQUFXLEVBQUMsS0FBSyxJ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RyxFQUFFLENBQUMsc0JBQXNCLENBQUMsSUFBSSxDQUFDLEVBQzNDLE9BQU8sRUFBRSxPQUFPLEVBQ2hCLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUNoQixPQUFPLEVBQUUsbUJBQW1CLENBQUMsT0FBTyxFQUNwQyxTQUFTLEVBQUUsbUJBQW1CLENBQUMsU0FBUyxFQUN4QyxVQUFVLEVBQUUsbUJBQW1CLENBQUMsVUFBVSxFQUMxQyxjQUFjLEVBQUUsa0JBQWtCLEdBQ2xDLENBQ0gsSUFDRyxDQUNQLENBQUM7QUFDSixDQUFDLENBQUM7QUFFRixrREFBa0Q7QUFDbEQsV0FBVyxDQUFDLFNBQVMsR0FBRztJQUN0QixPQUFPLEVBQUUsb0JBQVMsQ0FBQyxNQUFNLENBQUMsVUFBVTtJQUNwQyxNQUFNLEVBQUUsb0JBQVMsQ0FBQyxNQUFNLENBQUMsVUFBVTtJQUNuQyxvQkFBb0IsRUFBRSxvQkFBUyxDQUFDLElBQUk7Q0FDckMsQ0FBQztBQUVGLGtCQUFlLFdBQVcsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcREVWTWl4XFxBcHAuTWVzYXByYTIuY29tXFxzcmNcXGZlYXR1cmVzXFxzaGFyZWRcXGNvbXBvbmVudHNcXGV2ZW50c1xcRXZlbnRSYXRpbmcuanN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xyXG5pbXBvcnQgeyBTdGFyLCBDaGVjaywgQ2xvY2sgfSBmcm9tICdsdWNpZGUtcmVhY3QnO1xyXG5pbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSAnQC9jb250ZXh0cy9BdXRoQ29udGV4dCc7XHJcbmltcG9ydCB7IHVzZVRvYXN0IH0gZnJvbSAnQC9mZWF0dXJlcy9zaGFyZWQvY29tcG9uZW50cy91aS91c2UtdG9hc3QnO1xyXG5pbXBvcnQgeyBzdXBhYmFzZSB9IGZyb20gJ0AvbGliL3N1cGFiYXNlQ2xpZW50JztcclxuaW1wb3J0IFJhdGluZ1NlcnZpY2UgZnJvbSAnQC9zZXJ2aWNlcy9SYXRpbmdTZXJ2aWNlJztcclxuaW1wb3J0IFJhdGluZ01vZGFsIGZyb20gJy4vUmF0aW5nTW9kYWwnO1xyXG5cclxuLy8gMS4gQ09SUkXDh8ODTzogJ2hvc3ROYW1lJyByZW1vdmlkbywgcG9pcyBuw6NvIGVzdGF2YSBzZW5kbyB1c2Fkby5cclxuY29uc3QgRXZlbnRSYXRpbmcgPSAoeyBldmVudElkLCBob3N0SWQsIG9uQWxsUmF0aW5nc0NvbXBsZXRlIH0pID0+IHtcclxuICBjb25zdCB7IHVzZXIgfSA9IHVzZUF1dGgoKTtcclxuICAvLyAyLiBDT1JSRcOHw4NPOiAndG9hc3QnIGFnb3JhIHNlcsOhIHVzYWRvIG5vcyBibG9jb3MgJ2NhdGNoJy5cclxuICBjb25zdCB7IHRvYXN0IH0gPSB1c2VUb2FzdCgpO1xyXG5cclxuICBjb25zdCBbaXNMb2FkaW5nLCBzZXRJc0xvYWRpbmddID0gdXNlU3RhdGUodHJ1ZSk7XHJcbiAgY29uc3QgW2Vycm9yLCBzZXRFcnJvcl0gPSB1c2VTdGF0ZShudWxsKTtcclxuICBjb25zdCBbaG9zdERhdGEsIHNldEhvc3REYXRhXSA9IHVzZVN0YXRlKG51bGwpO1xyXG4gIGNvbnN0IFtwYXJ0aWNpcGFudHMsIHNldFBhcnRpY2lwYW50c10gPSB1c2VTdGF0ZShbXSk7XHJcbiAgY29uc3QgW3JhdGVkU3RhdHVzLCBzZXRSYXRlZFN0YXR1c10gPSB1c2VTdGF0ZSh7fSk7XHJcbiAgY29uc3QgW3NlbGVjdGVkUmF0aW5nTW9kYWwsIHNldFNlbGVjdGVkUmF0aW5nTW9kYWxdID0gdXNlU3RhdGUobnVsbCk7XHJcblxyXG4gIGNvbnN0IGxvYWRSYXRpbmdEYXRhID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgc2V0SXNMb2FkaW5nKHRydWUpO1xyXG4gICAgICBzZXRFcnJvcihudWxsKTtcclxuXHJcbiAgICAgIGNvbnN0IHsgZGF0YTogaG9zdCwgZXJyb3I6IGhvc3RFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgncHJvZmlsZXMnKVxyXG4gICAgICAgIC5zZWxlY3QoJ2lkLCB1c2VybmFtZSwgYXZhdGFyX3VybCwgcmVwdXRhdGlvbl9zdGFycycpXHJcbiAgICAgICAgLmVxKCdpZCcsIGhvc3RJZClcclxuICAgICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgICBpZiAoaG9zdEVycm9yKSB0aHJvdyBob3N0RXJyb3I7XHJcbiAgICAgIHNldEhvc3REYXRhKGhvc3QpO1xyXG5cclxuICAgICAgY29uc3QgeyBkYXRhOiBldmVudFBhcnRpY2lwYW50cywgZXJyb3I6IHBhcnRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgnZXZlbnRfcGFydGljaXBhbnRzJylcclxuICAgICAgICAuc2VsZWN0KGBcclxuICAgICAgICAgIGlkLFxyXG4gICAgICAgICAgcGFydGljaXBhbnRfaWQsXHJcbiAgICAgICAgICBzdGF0dXMsXHJcbiAgICAgICAgICBwcmVzZW5jYV9jb25maXJtYWRhLFxyXG4gICAgICAgICAgcGFydGljaXBhbnQ6cHJvZmlsZXMoaWQsIHVzZXJuYW1lLCBhdmF0YXJfdXJsLCByZXB1dGF0aW9uX3N0YXJzKVxyXG4gICAgICAgIGApXHJcbiAgICAgICAgLmVxKCdldmVudF9pZCcsIGV2ZW50SWQpXHJcbiAgICAgICAgLmVxKCdwcmVzZW5jYV9jb25maXJtYWRhJywgdHJ1ZSlcclxuICAgICAgICAubm90KCdwYXJ0aWNpcGFudF9pZCcsICdlcScsIHVzZXIuaWQpO1xyXG5cclxuICAgICAgaWYgKHBhcnRFcnJvcikgdGhyb3cgcGFydEVycm9yO1xyXG5cclxuICAgICAgY29uc3QgdmFsaWRQYXJ0aWNpcGFudHMgPSAoZXZlbnRQYXJ0aWNpcGFudHMgfHwgW10pLmZpbHRlcihcclxuICAgICAgICBwID0+IHAucGFydGljaXBhbnQgJiYgcC5wYXJ0aWNpcGFudF9pZCAhPT0gaG9zdElkXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBzZXRQYXJ0aWNpcGFudHModmFsaWRQYXJ0aWNpcGFudHMpO1xyXG5cclxuICAgICAgLy8gMy4gQ09SUkXDh8ODTyAoSU1QT1JUQU5URSk6IFJlbW92ZW1vcyBhIGNoYW1hZGEgZG8gbG9hZFJhdGluZ1N0YXR1cyBkYXF1aVxyXG4gICAgICAvLyBwYXJhIHF1ZWJyYXIgbyBsb29wIGluZmluaXRvIGRlIGRlcGVuZMOqbmNpYS5cclxuICAgICAgLy8gYXdhaXQgbG9hZFJhdGluZ1N0YXR1cygpOyBcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvIGFvIGNhcnJlZ2FyIGRhZG9zIGRlIGF2YWxpYcOnw6NvOicsIGVycik7XHJcbiAgICAgIHNldEVycm9yKCdFcnJvIGFvIGNhcnJlZ2FyIGRhZG9zLiBUZW50ZSBub3ZhbWVudGUuJyk7XHJcbiAgICAgIC8vIDIuIENPUlJFw4fDg086IFVzYW5kbyBvICd0b2FzdCcgbm8gZXJyby5cclxuICAgICAgdG9hc3Qoe1xyXG4gICAgICAgIHRpdGxlOiAnRXJybyBhbyBjYXJyZWdhciBkYWRvcycsXHJcbiAgICAgICAgZGVzY3JpcHRpb246ICdOw6NvIGZvaSBwb3Nzw612ZWwgYnVzY2FyIG9zIHBhcnRpY2lwYW50ZXMgcGFyYSBhdmFsaWHDp8Ojby4nLFxyXG4gICAgICAgIHZhcmlhbnQ6ICdkZXN0cnVjdGl2ZScsXHJcbiAgICAgIH0pO1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcclxuICAgIH1cclxuICAvLyA0LiBDT1JSRcOHw4NPOiBBZGljaW9uYWRvICd0b2FzdCcgw6BzIGRlcGVuZMOqbmNpYXMuICdsb2FkUmF0aW5nU3RhdHVzJyBmb2kgcmVtb3ZpZG8uXHJcbiAgfSwgW2V2ZW50SWQsIGhvc3RJZCwgdXNlci5pZCwgdG9hc3RdKTtcclxuXHJcbiAgY29uc3QgbG9hZFJhdGluZ1N0YXR1cyA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHN0YXR1cyA9IHt9O1xyXG5cclxuICAgICAgaWYgKGhvc3REYXRhKSB7XHJcbiAgICAgICAgY29uc3QgaGFzSG9zdFJhdGluZyA9IGF3YWl0IFJhdGluZ1NlcnZpY2UuaGFzVXNlclJhdGVkKFxyXG4gICAgICAgICAgZXZlbnRJZCxcclxuICAgICAgICAgIHVzZXIuaWQsXHJcbiAgICAgICAgICBob3N0SWQsXHJcbiAgICAgICAgICAnaG9zdCdcclxuICAgICAgICApO1xyXG4gICAgICAgIHN0YXR1c1tgaG9zdC0ke2hvc3RJZH1gXSA9IGhhc0hvc3RSYXRpbmc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZvciAoY29uc3QgcCBvZiBwYXJ0aWNpcGFudHMpIHtcclxuICAgICAgICBjb25zdCBoYXNQYXJ0aWNpcGFudFJhdGluZyA9IGF3YWl0IFJhdGluZ1NlcnZpY2UuaGFzVXNlclJhdGVkKFxyXG4gICAgICAgICAgZXZlbnRJZCxcclxuICAgICAgICAgIHVzZXIuaWQsXHJcbiAgICAgICAgICBwLnBhcnRpY2lwYW50X2lkLFxyXG4gICAgICAgICAgJ3BhcnRpY2lwYW50J1xyXG4gICAgICAgICk7XHJcbiAgICAgICAgc3RhdHVzW2BwYXJ0aWNpcGFudC0ke3AucGFydGljaXBhbnRfaWR9YF0gPSBoYXNQYXJ0aWNpcGFudFJhdGluZztcclxuICAgICAgfVxyXG5cclxuICAgICAgc2V0UmF0ZWRTdGF0dXMoc3RhdHVzKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gYW8gY2FycmVnYXIgc3RhdHVzIGRlIGF2YWxpYcOnw7VlczonLCBlcnJvcik7XHJcbiAgICAgIC8vIDIuIENPUlJFw4fDg086IFVzYW5kbyBvICd0b2FzdCcgbm8gZXJyby5cclxuICAgICAgdG9hc3Qoe1xyXG4gICAgICAgIHRpdGxlOiAnRXJybyBhbyB2ZXJpZmljYXIgc3RhdHVzJyxcclxuICAgICAgICBkZXNjcmlwdGlvbjogJ07Do28gZm9pIHBvc3PDrXZlbCB2ZXJpZmljYXIgc3VhcyBhdmFsaWHDp8O1ZXMgcGVuZGVudGVzLicsXHJcbiAgICAgICAgdmFyaWFudDogJ2Rlc3RydWN0aXZlJyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgLy8gNS4gQ09SUkXDh8ODTzogQWRpY2lvbmFkbyAndG9hc3QnIMOgcyBkZXBlbmTDqm5jaWFzLlxyXG4gIH0sIFtldmVudElkLCBob3N0RGF0YSwgaG9zdElkLCBwYXJ0aWNpcGFudHMsIHVzZXIuaWQsIHRvYXN0XSk7XHJcblxyXG4gIC8vIHVzZUVmZmVjdCAxOiBCdXNjYSBvcyBkYWRvcyBwcmluY2lwYWlzIChwYXJ0aWNpcGFudGVzIGUgaG9zdClcclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgaWYgKGV2ZW50SWQgJiYgdXNlcikge1xyXG4gICAgICBsb2FkUmF0aW5nRGF0YSgpO1xyXG4gICAgfVxyXG4gIH0sIFtldmVudElkLCB1c2VyLCBsb2FkUmF0aW5nRGF0YV0pO1xyXG5cclxuICAvLyA2LiBDT1JSRcOHw4NPIChJTVBPUlRBTlRFKTogTm92byB1c2VFZmZlY3QgcGFyYSBjYXJyZWdhciBvIFNUQVRVUyBkYXMgYXZhbGlhw6fDtWVzLlxyXG4gIC8vIEVsZSBzw7Mgcm9kYSBERVBPSVMgcXVlICdob3N0RGF0YScgb3UgJ3BhcnRpY2lwYW50cycgZm9yZW0gY2FycmVnYWRvcyxcclxuICAvLyBxdWVicmFuZG8gbyBjaWNsbyBkZSBkZXBlbmTDqm5jaWEuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGlmIChob3N0RGF0YSB8fCBwYXJ0aWNpcGFudHMubGVuZ3RoID4gMCkge1xyXG4gICAgICBsb2FkUmF0aW5nU3RhdHVzKCk7XHJcbiAgICB9XHJcbiAgfSwgW2hvc3REYXRhLCBwYXJ0aWNpcGFudHMsIGxvYWRSYXRpbmdTdGF0dXNdKTtcclxuXHJcblxyXG4gIGNvbnN0IGhhbmRsZVJhdGluZ0NsaWNrID0gKHRhcmdldFVzZXIsIHJhdGluZ1R5cGUpID0+IHtcclxuICAgIHNldFNlbGVjdGVkUmF0aW5nTW9kYWwoe1xyXG4gICAgICB0YXJnZXRVc2VyLFxyXG4gICAgICByYXRpbmdUeXBlLFxyXG4gICAgICByYXRlZElkOiB0YXJnZXRVc2VyLmlkLFxyXG4gICAgICByYXRlZE5hbWU6IHRhcmdldFVzZXIudXNlcm5hbWVcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZVJhdGluZ1N1Ym1pdCA9IGFzeW5jICgpID0+IHtcclxuICAgIC8vIFJlY2FycmVnYSBvIHN0YXR1cyBhcMOzcyB1bWEgYXZhbGlhw6fDo28gc2VyIHN1Ym1ldGlkYVxyXG4gICAgYXdhaXQgbG9hZFJhdGluZ1N0YXR1cygpO1xyXG5cclxuICAgIC8vIE5PVEE6IMOJIHByZWNpc28gY2hlY2FyIG8gJ3JhdGVkU3RhdHVzJyBhdHVhbGl6YWRvLlxyXG4gICAgLy8gTyAnbG9hZFJhdGluZ1N0YXR1cycgYXR1YWxpemEgbyBlc3RhZG8sIG1hcyBvICdyYXRlZFN0YXR1cydcclxuICAgIC8vIG5lc3RhIGZ1bsOnw6NvIGFpbmRhIHNlcsOhIG8gYW50aWdvLiBQcmVjaXNhbW9zIGRlIHVtYSBsw7NnaWNhXHJcbiAgICAvLyB1bSBwb3VjbyBkaWZlcmVudGUgcGFyYSB2ZXJpZmljYXIgJ2FsbFJhdGVkJ1xyXG4gICAgXHJcbiAgICAvLyBWYW1vcyByZS1jaGVjYXIgbyBzdGF0dXMgYXF1aVxyXG4gICAgY29uc3Qgc3RhdHVzID0ge307XHJcbiAgICBpZiAoaG9zdERhdGEpIHtcclxuICAgICAgY29uc3QgaGFzSG9zdFJhdGluZyA9IGF3YWl0IFJhdGluZ1NlcnZpY2UuaGFzVXNlclJhdGVkKGV2ZW50SWQsIHVzZXIuaWQsIGhvc3RJZCwgJ2hvc3QnKTtcclxuICAgICAgc3RhdHVzW2Bob3N0LSR7aG9zdElkfWBdID0gaGFzSG9zdFJhdGluZztcclxuICAgIH1cclxuICAgIGZvciAoY29uc3QgcCBvZiBwYXJ0aWNpcGFudHMpIHtcclxuICAgICAgY29uc3QgaGFzUGFydGljaXBhbnRSYXRpbmcgPSBhd2FpdCBSYXRpbmdTZXJ2aWNlLmhhc1VzZXJSYXRlZChldmVudElkLCB1c2VyLmlkLCBwLnBhcnRpY2lwYW50X2lkLCAncGFydGljaXBhbnQnKTtcclxuICAgICAgc3RhdHVzW2BwYXJ0aWNpcGFudC0ke3AucGFydGljaXBhbnRfaWR9YF0gPSBoYXNQYXJ0aWNpcGFudFJhdGluZztcclxuICAgIH1cclxuICAgIHNldFJhdGVkU3RhdHVzKHN0YXR1cyk7IC8vIEF0dWFsaXphIG8gZXN0YWRvIHBhcmEgYSBVSVxyXG5cclxuICAgIC8vIFZlcmlmaWNhIGNvbSBvIHN0YXR1cyByZWPDqW0tYnVzY2Fkb1xyXG4gICAgY29uc3QgYWxsUmF0ZWQgPSBwYXJ0aWNpcGFudHMuZXZlcnkocCA9PlxyXG4gICAgICBzdGF0dXNbYHBhcnRpY2lwYW50LSR7cC5wYXJ0aWNpcGFudF9pZH1gXVxyXG4gICAgKSAmJiBzdGF0dXNbYGhvc3QtJHtob3N0SWR9YF07XHJcblxyXG4gICAgaWYgKGFsbFJhdGVkICYmIG9uQWxsUmF0aW5nc0NvbXBsZXRlKSB7XHJcbiAgICAgIG9uQWxsUmF0aW5nc0NvbXBsZXRlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwidGV4dC13aGl0ZS82MCB0ZXh0LWNlbnRlciBweS04XCI+Q2FycmVnYW5kbyBhdmFsaWHDp8O1ZXMuLi48L2Rpdj47XHJcbiAgfVxyXG5cclxuICBpZiAoZXJyb3IpIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmctcmVkLTUwMC8xMCBib3JkZXIgYm9yZGVyLXJlZC01MDAvMjAgcm91bmRlZC0yeGwgcC02IHRleHQtY2VudGVyXCI+XHJcbiAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1yZWQtMjAwXCI+e2Vycm9yfTwvcD5cclxuICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBsb2FkUmF0aW5nRGF0YSgpfVxyXG4gICAgICAgICAgY2xhc3NOYW1lPVwibXQtNCBweC00IHB5LTIgYmctcmVkLTYwMC81MCBob3ZlcjpiZy1yZWQtNjAwIHRleHQtd2hpdGUgcm91bmRlZC1sZyB0cmFuc2l0aW9uLWNvbG9yc1wiXHJcbiAgICAgICAgPlxyXG4gICAgICAgICAgVGVudGFyIE5vdmFtZW50ZVxyXG4gICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICA8L2Rpdj5cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBob3N0UmF0ZWQgPSByYXRlZFN0YXR1c1tgaG9zdC0ke2hvc3RJZH1gXTtcclxuICBjb25zdCBwYXJ0aWNpcGFudHNSYXRlZCA9IHBhcnRpY2lwYW50cy5maWx0ZXIocCA9PlxyXG4gICAgcmF0ZWRTdGF0dXNbYHBhcnRpY2lwYW50LSR7cC5wYXJ0aWNpcGFudF9pZH1gXVxyXG4gICk7XHJcbiAgY29uc3QgYWxsUmF0ZWQgPSBob3N0UmF0ZWQgJiYgcGFydGljaXBhbnRzUmF0ZWQubGVuZ3RoID09PSBwYXJ0aWNpcGFudHMubGVuZ3RoO1xyXG4gIFxyXG4gIC8vIEV2aXRhIGRpdmlzw6NvIHBvciB6ZXJvIHNlIG7Do28gaG91dmVyIHBhcnRpY2lwYW50ZXMgKyBob3N0XHJcbiAgY29uc3QgdG90YWxUb1JhdGUgPSBwYXJ0aWNpcGFudHMubGVuZ3RoICsgKGhvc3REYXRhID8gMSA6IDApO1xyXG4gIGNvbnN0IHRvdGFsUmF0ZWQgPSBwYXJ0aWNpcGFudHNSYXRlZC5sZW5ndGggKyAoaG9zdFJhdGVkID8gMSA6IDApO1xyXG4gIGNvbnN0IHBlcmNlbnRhZ2UgPSB0b3RhbFRvUmF0ZSA+IDAgPyAodG90YWxSYXRlZCAvIHRvdGFsVG9SYXRlKSAqIDEwMCA6IDEwMDtcclxuXHJcbiAgcmV0dXJuIChcclxuICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS02XCI+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ2xhc3MtZWZmZWN0IHJvdW5kZWQtMnhsIHAtNiBib3JkZXIgYm9yZGVyLXdoaXRlLzEwXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW4gbWItNFwiPlxyXG4gICAgICAgICAgPGgyIGNsYXNzTmFtZT1cInRleHQteGwgZm9udC1ib2xkIHRleHQtd2hpdGVcIj5BdmFsaWHDp8O1ZXMgZG8gRXZlbnRvPC9oMj5cclxuICAgICAgICAgIHt0b3RhbFRvUmF0ZSA+IDAgJiYgKFxyXG4gICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtc2VtaWJvbGQgcHgtMyBweS0xIHJvdW5kZWQtZnVsbCBiZy1wdXJwbGUtNjAwLzMwIHRleHQtcHVycGxlLTIwMCBib3JkZXIgYm9yZGVyLXB1cnBsZS01MDAvMzBcIj5cclxuICAgICAgICAgICAgICB7dG90YWxSYXRlZH0gLyB7dG90YWxUb1JhdGV9XHJcbiAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICl9XHJcbiAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgIHt0b3RhbFRvUmF0ZSA+IDAgJiYgKFxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LWZ1bGwgYmctd2hpdGUvMTAgcm91bmRlZC1mdWxsIGgtMiBvdmVyZmxvdy1oaWRkZW5cIj5cclxuICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cImJnLWdyYWRpZW50LXRvLXIgZnJvbS15ZWxsb3ctNDAwIHRvLXllbGxvdy02MDAgaC1mdWxsIHRyYW5zaXRpb24tYWxsIGR1cmF0aW9uLTUwMFwiXHJcbiAgICAgICAgICAgICAgc3R5bGU9e3tcclxuICAgICAgICAgICAgICAgIHdpZHRoOiBgJHtwZXJjZW50YWdlfSVgXHJcbiAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgLz5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICl9XHJcblxyXG4gICAgICAgIHthbGxSYXRlZCAmJiB0b3RhbFRvUmF0ZSA+IDAgJiYgKFxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtdC00IGJnLWdyZWVuLTUwMC8xMCBib3JkZXIgYm9yZGVyLWdyZWVuLTUwMC8yMCByb3VuZGVkLWxnIHAtM1wiPlxyXG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtZ3JlZW4tMjAwIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XHJcbiAgICAgICAgICAgICAgPENoZWNrIHNpemU9ezE2fSBjbGFzc05hbWU9XCJ0ZXh0LWdyZWVuLTQwMFwiIC8+XHJcbiAgICAgICAgICAgICAgVm9jw6ogY29tcGxldG91IHRvZGFzIGFzIGF2YWxpYcOnw7VlcyFcclxuICAgICAgICAgICAgPC9wPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKX1cclxuICAgICAgPC9kaXY+XHJcblxyXG4gICAgICB7aG9zdERhdGEgJiYgKFxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ2xhc3MtZWZmZWN0IHJvdW5kZWQtMnhsIHAtNiBib3JkZXIgYm9yZGVyLXdoaXRlLzEwIGhvdmVyOmJvcmRlci13aGl0ZS8yMCB0cmFuc2l0aW9uLWFsbFwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW5cIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtNCBmbGV4LTFcIj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctMTYgaC0xNiByb3VuZGVkLWZ1bGwgYmctZ3JhZGllbnQtdG8tYnIgZnJvbS1wdXJwbGUtNDAwIHRvLXBpbmstNDAwIHAtMSBmbGV4LXNocmluay0wXCI+XHJcbiAgICAgICAgICAgICAgICB7aG9zdERhdGEuYXZhdGFyX3VybCA/IChcclxuICAgICAgICAgICAgICAgICAgPGltZ1xyXG4gICAgICAgICAgICAgICAgICAgIHNyYz17aG9zdERhdGEuYXZhdGFyX3VybH1cclxuICAgICAgICAgICAgICAgICAgICBhbHQ9e2hvc3REYXRhLnVzZXJuYW1lfVxyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctZnVsbCBoLWZ1bGwgcm91bmRlZC1mdWxsIG9iamVjdC1jb3ZlclwiXHJcbiAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICApIDogKFxyXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctZnVsbCBoLWZ1bGwgcm91bmRlZC1mdWxsIGJnLXdoaXRlLzEwIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHRleHQtd2hpdGUgZm9udC1zZW1pYm9sZFwiPlxyXG4gICAgICAgICAgICAgICAgICAgIHtob3N0RGF0YS51c2VybmFtZT8uWzBdPy50b1VwcGVyQ2FzZSgpfVxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xXCI+XHJcbiAgICAgICAgICAgICAgICA8aDMgY2xhc3NOYW1lPVwidGV4dC1sZyBmb250LWJvbGQgdGV4dC13aGl0ZVwiPntob3N0RGF0YS51c2VybmFtZX08L2gzPlxyXG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LXdoaXRlLzYwXCI+QW5maXRyacOjbyBkbyBldmVudG88L3A+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0yIG10LTJcIj5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGdhcC0xXCI+XHJcbiAgICAgICAgICAgICAgICAgICAge1suLi5BcnJheSg1KV0ubWFwKChfLCBpKSA9PiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICA8U3RhclxyXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk9e2l9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9ezE2fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGkgPCBNYXRoLmZsb29yKGhvc3REYXRhLnJlcHV0YXRpb25fc3RhcnMgfHwgMClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gJ2ZpbGwteWVsbG93LTQwMCB0ZXh0LXllbGxvdy00MDAnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICd0ZXh0LXdoaXRlLzIwJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICkpfVxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LXdoaXRlLzYwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAge2hvc3REYXRhLnJlcHV0YXRpb25fc3RhcnMgfHwgJzAnfSBlc3RyZWxhc1xyXG4gICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZmxleC1jb2wgaXRlbXMtZW5kIGdhcC0yXCI+XHJcbiAgICAgICAgICAgICAge2hvc3RSYXRlZCA/IChcclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgcHgtMyBweS0yIHJvdW5kZWQtbGcgYmctZ3JlZW4tNTAwLzEwIGJvcmRlciBib3JkZXItZ3JlZW4tNTAwLzIwXCI+XHJcbiAgICAgICAgICAgICAgICAgIDxDaGVjayBzaXplPXsxOH0gY2xhc3NOYW1lPVwidGV4dC1ncmVlbi00MDBcIiAvPlxyXG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtc2VtaWJvbGQgdGV4dC1ncmVlbi0yMDBcIj5BdmFsaWFkbzwvc3Bhbj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZVJhdGluZ0NsaWNrKGhvc3REYXRhLCAnaG9zdCcpfVxyXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJweC00IHB5LTIgcm91bmRlZC1sZyBiZy1ncmFkaWVudC10by1yIGZyb20teWVsbG93LTUwMCB0by15ZWxsb3ctNjAwIGhvdmVyOmZyb20teWVsbG93LTYwMCBob3Zlcjp0by15ZWxsb3ctNzAwIHRleHQtd2hpdGUgZm9udC1zZW1pYm9sZCB0cmFuc2l0aW9uLWFsbCBob3ZlcjpzaGFkb3ctbGcgYWN0aXZlOnNjYWxlLTk1XCJcclxuICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgQXZhbGlhclxyXG4gICAgICAgICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgKX1cclxuXHJcbiAgICAgIHtwYXJ0aWNpcGFudHMubGVuZ3RoID4gMCAmJiAoXHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtM1wiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTEgaC1weCBiZy13aGl0ZS8xMFwiIC8+XHJcbiAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LXhzIGZvbnQtc2VtaWJvbGQgdGV4dC13aGl0ZS81MCBweC0yXCI+UEFSVElDSVBBTlRFUzwvc3Bhbj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xIGgtcHggYmctd2hpdGUvMTBcIiAvPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICApfVxyXG5cclxuICAgICAge3BhcnRpY2lwYW50cy5sZW5ndGggPiAwID8gKFxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0zXCI+XHJcbiAgICAgICAgICB7cGFydGljaXBhbnRzLm1hcCgocGFydGljaXBhdGlvbikgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwYXJ0aWNpcGFudCA9IHBhcnRpY2lwYXRpb24ucGFydGljaXBhbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IGlzUmF0ZWQgPSByYXRlZFN0YXR1c1tgcGFydGljaXBhbnQtJHtwYXJ0aWNpcGFudC5pZH1gXTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgICAga2V5PXtwYXJ0aWNpcGFudC5pZH1cclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImdsYXNzLWVmZmVjdCByb3VuZGVkLTJ4bCBwLTQgYm9yZGVyIGJvcmRlci13aGl0ZS8xMCBob3Zlcjpib3JkZXItd2hpdGUvMjAgdHJhbnNpdGlvbi1hbGxcIlxyXG4gICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuXCI+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTMgZmxleC0xXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LTEyIGgtMTIgcm91bmRlZC1mdWxsIGJnLWdyYWRpZW50LXRvLWJyIGZyb20tYmx1ZS00MDAgdG8tY3lhbi00MDAgcC0xIGZsZXgtc2hyaW5rLTBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIHtwYXJ0aWNpcGFudC5hdmF0YXJfdXJsID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8aW1nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjPXtwYXJ0aWNpcGFudC5hdmF0YXJfdXJsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGFsdD17cGFydGljaXBhbnQudXNlcm5hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsIGgtZnVsbCByb3VuZGVkLWZ1bGwgb2JqZWN0LWNvdmVyXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy1mdWxsIGgtZnVsbCByb3VuZGVkLWZ1bGwgYmctd2hpdGUvMTAgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdGV4dC13aGl0ZSBmb250LXNlbWlib2xkIHRleHQtc21cIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICB7cGFydGljaXBhbnQudXNlcm5hbWU/LlswXT8udG9VcHBlckNhc2UoKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBtaW4tdy0wXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8aDQgY2xhc3NOYW1lPVwiZm9udC1zZW1pYm9sZCB0ZXh0LXdoaXRlIHRydW5jYXRlXCI+e3BhcnRpY2lwYW50LnVzZXJuYW1lfTwvaDQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBnYXAtMC41XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAge1suLi5BcnJheSg1KV0ubWFwKChfLCBpKSA9PiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U3RhclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk9e2l9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9ezEyfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPCBNYXRoLmZsb29yKHBhcnRpY2lwYW50LnJlcHV0YXRpb25fc3RhcnMgfHwgMClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gJ2ZpbGwteWVsbG93LTQwMCB0ZXh0LXllbGxvdy00MDAnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICd0ZXh0LXdoaXRlLzIwJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICkpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC14cyB0ZXh0LXdoaXRlLzYwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAge3BhcnRpY2lwYW50LnJlcHV0YXRpb25fc3RhcnMgfHwgJzAnfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICAgICAgICB7aXNSYXRlZCA/IChcclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0xLjUgcHgtMiBweS0xIHJvdW5kZWQtbGcgYmctZ3JlZW4tNTAwLzEwIGJvcmRlciBib3JkZXItZ3JlZW4tNTAwLzIwIGZsZXgtc2hyaW5rLTBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxDaGVjayBzaXplPXsxNH0gY2xhc3NOYW1lPVwidGV4dC1ncmVlbi00MDBcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC14cyBmb250LXNlbWlib2xkIHRleHQtZ3JlZW4tMjAwXCI+QXZhbGlhZG88L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gaGFuZGxlUmF0aW5nQ2xpY2socGFydGljaXBhbnQsICdwYXJ0aWNpcGFudCcpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwicHgtMyBweS0xLjUgcm91bmRlZC1sZyBiZy13aGl0ZS8xMCBob3ZlcjpiZy13aGl0ZS8yMCB0ZXh0LXdoaXRlIGZvbnQtc2VtaWJvbGQgdGV4dC1zbSB0cmFuc2l0aW9uLWNvbG9ycyBmbGV4LXNocmluay0wXCJcclxuICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICBBdmFsaWFyXHJcbiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgIH0pfVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICApIDogKFxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXIgcHktOCB0ZXh0LXdoaXRlLzYwXCI+XHJcbiAgICAgICAgICA8Q2xvY2sgc2l6ZT17MzJ9IGNsYXNzTmFtZT1cIm14LWF1dG8gbWItMyBvcGFjaXR5LTUwXCIgLz5cclxuICAgICAgICAgIDxwPk5lbmh1bSBvdXRybyBwYXJ0aWNpcGFudGUgY29uZmlybW91IHByZXNlbsOnYTwvcD5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgKX1cclxuXHJcbiAgICAgIHtzZWxlY3RlZFJhdGluZ01vZGFsICYmIChcclxuICAgICAgICA8UmF0aW5nTW9kYWxcclxuICAgICAgICAgIGlzT3Blbj17dHJ1ZX1cclxuICAgICAgICAgIG9uQ2xvc2U9eygpID0+IHNldFNlbGVjdGVkUmF0aW5nTW9kYWwobnVsbCl9XHJcbiAgICAgICAgICBldmVudElkPXtldmVudElkfVxyXG4gICAgICAgICAgcmF0ZXJJZD17dXNlci5pZH1cclxuICAgICAgICAgIHJhdGVkSWQ9e3NlbGVjdGVkUmF0aW5nTW9kYWwucmF0ZWRJZH1cclxuICAgICAgICAgIHJhdGVkTmFtZT17c2VsZWN0ZWRSYXRpbmdNb2RhbC5yYXRlZE5hbWV9XHJcbiAgICAgICAgICByYXRpbmdUeXBlPXtzZWxlY3RlZFJhdGluZ01vZGFsLnJhdGluZ1R5cGV9XHJcbiAgICAgICAgICBvblJhdGluZ1N1Ym1pdD17aGFuZGxlUmF0aW5nU3VibWl0fVxyXG4gICAgICAgIC8+XHJcbiAgICAgICl9XHJcbiAgICA8L2Rpdj5cclxuICApO1xyXG59O1xyXG5cclxuLy8gNy4gQ09SUkXDh8ODTzogUmVtb3ZpZG8gJ2hvc3ROYW1lJyBkb3MgcHJvcFR5cGVzLlxyXG5FdmVudFJhdGluZy5wcm9wVHlwZXMgPSB7XHJcbiAgZXZlbnRJZDogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxyXG4gIGhvc3RJZDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxyXG4gIG9uQWxsUmF0aW5nc0NvbXBsZXRlOiBQcm9wVHlwZXMuZnVuY1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgRXZlbnRSYXRpbmc7Il0sInZlcnNpb24iOjN9