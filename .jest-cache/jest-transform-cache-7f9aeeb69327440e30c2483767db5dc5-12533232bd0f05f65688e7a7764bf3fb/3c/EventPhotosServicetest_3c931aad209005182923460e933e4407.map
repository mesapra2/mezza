{"file":"C:\\DEVMix\\App.Mesapra2.com\\src\\services\\EventPhotosService.test.ts","mappings":"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","names":[],"sources":["C:\\DEVMix\\App.Mesapra2.com\\src\\services\\EventPhotosService.test.ts"],"sourcesContent":["// src/services/EventPhotosService.test.ts\r\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\n// @ts-nocheck\r\nimport EventPhotosService, {\r\n  type EventPhoto,\r\n  type PhotoStats,\r\n  type UploadResult\r\n} from './EventPhotosService';\r\nimport { supabase } from '../lib/supabaseClient';\r\n\r\njest.mock('../lib/supabaseClient', () => {\r\n  const from = jest.fn();\r\n  const storageFrom = jest.fn();\r\n  return {\r\n    supabase: {\r\n      from,\r\n      storage: {\r\n        from: storageFrom\r\n      }\r\n    }\r\n  };\r\n});\r\n\r\ndescribe('EventPhotosService', () => {\r\n  const mockedSupabase = supabase as unknown as {\r\n    from: jest.Mock;\r\n    storage: {\r\n      from: jest.Mock;\r\n    };\r\n  };\r\n\r\n  // helpers de narrowing SEM acessar propriedades do outro ramo\r\n  function assertFailure(\r\n    result: UploadResult,\r\n    message?: string\r\n  ): asserts result is { success: false; error: string } {\r\n    if (result.success) {\r\n      throw new Error('expected failure but got success');\r\n    }\r\n    expect(result.success).toBe(false);\r\n    if (message) {\r\n      expect(result.error).toBe(message);\r\n    }\r\n  }\r\n\r\n  function assertSuccess(\r\n    result: UploadResult\r\n  ): asserts result is { success: true; photoUrl: string } {\r\n    expect(result.success).toBe(true);\r\n    if (result.success) {\r\n      expect(result.photoUrl).toBeDefined();\r\n    }\r\n  }\r\n\r\n  const makeFile = (\r\n    name = 'photo.jpg',\r\n    size = 1024,\r\n    type = 'image/jpeg'\r\n  ): File =>\r\n    ({\r\n      name,\r\n      size,\r\n      type\r\n    } as unknown as File);\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  describe('uploadEventPhoto', () => {\r\n    it('retorna erro quando o arquivo não é imagem', async () => {\r\n      const file = makeFile('doc.pdf', 1000, 'application/pdf');\r\n\r\n      const result = await EventPhotosService.uploadEventPhoto(1, 'user-1', file);\r\n\r\n      assertFailure(result, 'Apenas imagens são permitidas');\r\n      expect(mockedSupabase.storage.from).not.toHaveBeenCalled();\r\n    });\r\n\r\n    it('retorna erro quando o arquivo tem mais de 10MB antes do resize', async () => {\r\n      const big = makeFile('big.jpg', 10 * 1024 * 1024 + 5);\r\n\r\n      const result = await EventPhotosService.uploadEventPhoto(2, 'user-2', big);\r\n\r\n      assertFailure(result, 'Arquivo muito grande (máx: 10MB)');\r\n    });\r\n\r\n    it('faz upload de nova foto, deleta a anterior e salva no BD', async () => {\r\n      const file = makeFile();\r\n\r\n      const oldPhoto: EventPhoto = {\r\n        id: 99,\r\n        event_id: 1,\r\n        user_id: 'user-1',\r\n        photo_url:\r\n          'https://example.com/storage/v1/object/public/event-photos/1/user-1-old.jpg',\r\n        status: 'aprovado'\r\n      };\r\n\r\n      const getUserSpy = jest\r\n        .spyOn(EventPhotosService, 'getUserPhotoForEvent')\r\n        .mockResolvedValue(oldPhoto);\r\n\r\n      const deleteSpy = jest\r\n        .spyOn(EventPhotosService, 'deleteEventPhoto')\r\n        .mockResolvedValue(true);\r\n\r\n      const upload = jest.fn().mockResolvedValue({ error: null });\r\n      const getPublicUrl = jest.fn(() => ({\r\n        data: {\r\n          publicUrl:\r\n            'https://example.com/storage/v1/object/public/event-photos/1/user-1-123.jpg'\r\n        }\r\n      }));\r\n\r\n      mockedSupabase.storage.from.mockReturnValue({\r\n        upload,\r\n        getPublicUrl,\r\n        remove: jest.fn()\r\n      });\r\n\r\n      const insert = jest.fn().mockResolvedValue({ error: null });\r\n      mockedSupabase.from.mockImplementation((table: string) => {\r\n        if (table === 'event_photos') {\r\n          return {\r\n            insert\r\n          } as unknown;\r\n        }\r\n        return {} as unknown;\r\n      });\r\n\r\n      const result = await EventPhotosService.uploadEventPhoto(1, 'user-1', file);\r\n\r\n      assertSuccess(result);\r\n      if (result.success) {\r\n        expect(result.photoUrl).toContain('event-photos/1/user-1-');\r\n      }\r\n\r\n      expect(getUserSpy).toHaveBeenCalledWith(1, 'user-1');\r\n      expect(deleteSpy).toHaveBeenCalledWith(99, 'user-1');\r\n\r\n      getUserSpy.mockRestore();\r\n      deleteSpy.mockRestore();\r\n    });\r\n\r\n    it('remove o arquivo do storage se o insert no BD falhar', async () => {\r\n      const file = makeFile();\r\n\r\n      jest\r\n        .spyOn(EventPhotosService, 'getUserPhotoForEvent')\r\n        .mockResolvedValue(null);\r\n\r\n      const upload = jest.fn().mockResolvedValue({ error: null });\r\n      const getPublicUrl = jest.fn(() => ({\r\n        data: {\r\n          publicUrl:\r\n            'https://example.com/storage/v1/object/public/event-photos/1/user-1-123.jpg'\r\n        }\r\n      }));\r\n      const remove = jest.fn();\r\n\r\n      mockedSupabase.storage.from.mockReturnValue({\r\n        upload,\r\n        getPublicUrl,\r\n        remove\r\n      });\r\n\r\n      const insert = jest.fn().mockResolvedValue({\r\n        error: { message: 'db error' }\r\n      });\r\n\r\n      mockedSupabase.from.mockImplementation((table: string) => {\r\n        if (table === 'event_photos') {\r\n          return {\r\n            insert\r\n          } as unknown;\r\n        }\r\n        return {} as unknown;\r\n      });\r\n\r\n      const result = await EventPhotosService.uploadEventPhoto(1, 'user-1', file);\r\n\r\n      assertFailure(result, 'db error');\r\n      expect(remove).toHaveBeenCalled();\r\n    });\r\n\r\n    it('retorna erro quando o upload no storage falha', async () => {\r\n      const file = makeFile();\r\n\r\n      jest\r\n        .spyOn(EventPhotosService, 'getUserPhotoForEvent')\r\n        .mockResolvedValue(null);\r\n\r\n      const upload = jest.fn().mockResolvedValue({\r\n        error: { message: 'storage error' }\r\n      });\r\n\r\n      mockedSupabase.storage.from.mockReturnValue({\r\n        upload,\r\n        getPublicUrl: jest.fn(),\r\n        remove: jest.fn()\r\n      });\r\n\r\n      const result = await EventPhotosService.uploadEventPhoto(5, 'user-5', file);\r\n\r\n      assertFailure(result, 'storage error');\r\n    });\r\n  });\r\n\r\n  describe('getEventPhotos', () => {\r\n    it('busca fotos aprovadas do evento', async () => {\r\n      const select = jest.fn(() => ({\r\n        eq: jest\r\n          .fn()\r\n          .mockImplementationOnce(() => ({\r\n            eq: jest.fn(() => ({\r\n              order: jest.fn().mockResolvedValue({\r\n                data: [\r\n                  {\r\n                    id: 1,\r\n                    event_id: 10,\r\n                    user_id: 'u1',\r\n                    photo_url: 'https://example.com/p1.jpg',\r\n                    status: 'aprovado'\r\n                  }\r\n                ],\r\n                error: null\r\n              })\r\n            }))\r\n          }))\r\n      }));\r\n\r\n      mockedSupabase.from.mockImplementation((table: string) => {\r\n        if (table === 'event_photos') {\r\n          return { select } as unknown;\r\n        }\r\n        return {} as unknown;\r\n      });\r\n\r\n      const photos = await EventPhotosService.getEventPhotos(10);\r\n\r\n      expect(photos).toHaveLength(1);\r\n      expect(photos[0].photo_url).toBe('https://example.com/p1.jpg');\r\n    });\r\n\r\n    it('retorna array vazio em caso de erro', async () => {\r\n      const select = jest.fn(() => ({\r\n        eq: jest.fn(() => ({\r\n          eq: jest.fn(() => ({\r\n            order: jest.fn().mockResolvedValue({\r\n              data: null,\r\n              error: { message: 'erro' }\r\n            })\r\n          }))\r\n        }))\r\n      }));\r\n\r\n      mockedSupabase.from.mockReturnValue({\r\n        select\r\n      } as unknown);\r\n\r\n      const photos = await EventPhotosService.getEventPhotos(10);\r\n\r\n      expect(photos).toEqual([]);\r\n    });\r\n  });\r\n\r\n  describe('getUserPhotoForEvent', () => {\r\n    it('retorna a foto do usuário quando existir', async () => {\r\n      // Spy no método diretamente\r\n      const mockPhoto: EventPhoto = {\r\n        id: 2,\r\n        event_id: 11,\r\n        user_id: 'user-1',\r\n        photo_url: 'https://example.com/p2.jpg',\r\n        status: 'aprovado'\r\n      };\r\n\r\n      jest.spyOn(EventPhotosService, 'getUserPhotoForEvent').mockResolvedValueOnce(mockPhoto);\r\n\r\n      const photo = await EventPhotosService.getUserPhotoForEvent(11, 'user-1');\r\n\r\n      expect(photo).not.toBeNull();\r\n      expect(photo?.photo_url).toBe('https://example.com/p2.jpg');\r\n    });\r\n\r\n    it('retorna null em caso de erro', async () => {\r\n      const maybeSingle = jest.fn().mockResolvedValue({\r\n        data: null,\r\n        error: { message: 'erro' }\r\n      });\r\n      const eq = jest.fn(() => ({ maybeSingle }));\r\n      const select = jest.fn(() => ({ eq }));\r\n\r\n      mockedSupabase.from.mockReturnValue({\r\n        select\r\n      } as unknown);\r\n\r\n      const photo = await EventPhotosService.getUserPhotoForEvent(11, 'user-1');\r\n\r\n      expect(photo).toBeNull();\r\n    });\r\n  });\r\n\r\n  describe('deleteEventPhoto', () => {\r\n    it('retorna false se a foto não existir', async () => {\r\n      const maybeSingle = jest.fn().mockResolvedValue({\r\n        data: null,\r\n        error: { message: 'not found' }\r\n      });\r\n      const select = jest.fn(() => ({\r\n        eq: jest.fn(() => ({ maybeSingle }))\r\n      }));\r\n\r\n      mockedSupabase.from.mockImplementation((table: string) => {\r\n        if (table === 'event_photos') {\r\n          return { select } as unknown;\r\n        }\r\n        return {} as unknown;\r\n      });\r\n\r\n      const result = await EventPhotosService.deleteEventPhoto(10, 'user-x');\r\n\r\n      expect(result).toBe(false);\r\n    });\r\n\r\n    it('retorna false se não for o dono da foto', async () => {\r\n      const maybeSingle = jest.fn().mockResolvedValue({\r\n        data: {\r\n          id: 5,\r\n          photo_url:\r\n            'https://example.com/storage/v1/object/public/event-photos/10/other.jpg',\r\n          user_id: 'outro-user'\r\n        },\r\n        error: null\r\n      });\r\n      const select = jest.fn(() => ({\r\n        eq: jest.fn(() => ({ maybeSingle }))\r\n      }));\r\n\r\n      mockedSupabase.from.mockReturnValue({\r\n        select\r\n      } as unknown);\r\n\r\n      const result = await EventPhotosService.deleteEventPhoto(10, 'user-x');\r\n\r\n      expect(result).toBe(false);\r\n      expect(mockedSupabase.storage.from).not.toHaveBeenCalled();\r\n    });\r\n\r\n    it('deleta do storage e do BD quando for o dono', async () => {\r\n      const maybeSingle = jest.fn().mockResolvedValue({\r\n        data: {\r\n          id: 7,\r\n          photo_url:\r\n            'https://example.com/storage/v1/object/public/event-photos/10/user-1-123.jpg',\r\n          user_id: 'user-1'\r\n        },\r\n        error: null\r\n      });\r\n      const select = jest.fn(() => ({\r\n        eq: jest.fn(() => ({ maybeSingle }))\r\n      }));\r\n\r\n      const deleteFn = jest.fn(() => ({\r\n        eq: jest.fn(() => ({\r\n          eq: jest.fn().mockResolvedValue({ error: null })\r\n        }))\r\n      }));\r\n\r\n      mockedSupabase.from.mockImplementation((table: string) => {\r\n        if (table === 'event_photos') {\r\n          return {\r\n            select,\r\n            delete: deleteFn\r\n          } as unknown;\r\n        }\r\n        return {} as unknown;\r\n      });\r\n\r\n      const remove = jest.fn().mockResolvedValue({});\r\n\r\n      mockedSupabase.storage.from.mockReturnValue({\r\n        remove\r\n      } as unknown);\r\n\r\n      const result = await EventPhotosService.deleteEventPhoto(10, 'user-1');\r\n\r\n      expect(result).toBe(true);\r\n      expect(mockedSupabase.storage.from).toHaveBeenCalledWith('event-photos');\r\n      expect(remove).toHaveBeenCalledWith(['10/user-1-123.jpg']);\r\n      expect(deleteFn).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('getPhotoStats', () => {\r\n    it('retorna estatísticas calculadas', async () => {\r\n      let callCount = 0;\r\n      \r\n      mockedSupabase.from.mockImplementation((table: string) => {\r\n        callCount++;\r\n        \r\n        if (callCount === 1 && table === 'event_photos') {\r\n          return {\r\n            select: jest.fn(() => ({\r\n              eq: jest.fn(() => ({\r\n                eq: jest.fn().mockResolvedValue({\r\n                  count: 3,\r\n                  error: null\r\n                })\r\n              }))\r\n            }))\r\n          } as unknown;\r\n        }\r\n        \r\n        if (callCount === 2 && table === 'event_participants') {\r\n          return {\r\n            select: jest.fn(() => ({\r\n              eq: jest.fn().mockResolvedValue({\r\n                count: 6,\r\n                error: null\r\n              })\r\n            }))\r\n          } as unknown;\r\n        }\r\n        \r\n        return {} as unknown;\r\n      });\r\n\r\n      const stats = await EventPhotosService.getPhotoStats(50);\r\n\r\n      expect(stats.totalPhotos).toBe(3);\r\n      expect(stats.totalParticipants).toBe(6);\r\n      expect(stats.percentageWithPhotos).toBeCloseTo(50);\r\n    });\r\n\r\n    it('retorna tudo 0 em caso de erro', async () => {\r\n      mockedSupabase.from.mockReturnValue({\r\n        select: jest.fn(() => ({\r\n          eq: jest.fn(() => ({\r\n            eq: jest.fn(() => ({\r\n              eq: jest.fn().mockRejectedValue(new Error('erro'))\r\n            }))\r\n          }))\r\n        }))\r\n      } as unknown);\r\n\r\n      const stats = await EventPhotosService.getPhotoStats(50);\r\n\r\n      const expected: PhotoStats = {\r\n        totalPhotos: 0,\r\n        totalParticipants: 0,\r\n        percentageWithPhotos: 0\r\n      };\r\n      expect(stats).toEqual(expected);\r\n    });\r\n  });\r\n});"],"version":3}