{"file":"C:\\DEVMix\\App.Mesapra2.com\\src\\features\\shared\\pages\\EventChatPage.jsx","mappings":"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","names":[],"sources":["C:\\DEVMix\\App.Mesapra2.com\\src\\features\\shared\\pages\\EventChatPage.jsx"],"sourcesContent":["// src/features/shared/pages/EventChatPage.jsx\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport { useParams, useNavigate, Link } from 'react-router-dom';\r\nimport { Helmet } from 'react-helmet-async';\r\nimport { Send, ArrowLeft, Loader2, Trash2, MoreVertical, Lock } from 'lucide-react';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { supabase } from '@/lib/supabaseClient';\r\nimport { Button } from '@/features/shared/components/ui/button';\r\nimport { Input } from '@/features/shared/components/ui/input';\r\nimport { format } from 'date-fns';\r\nimport { ptBR } from 'date-fns/locale';\r\nimport { SimpleDropdown, SimpleDropdownItem } from '@/features/shared/components/ui/SimpleDropdown';\r\nimport { isChatAvailable } from '@/utils/chatAvailability';\r\n\r\nconst EventChatPage = () => {\r\n  const { id } = useParams();\r\n  const eventId = parseInt(id, 10);\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const messagesEndRef = useRef(null);\r\n\r\n  const [messages, setMessages] = useState([]);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [profileMap, setProfileMap] = useState(new Map());\r\n  const [activeParticipantCount, setActiveParticipantCount] = useState(0);\r\n  const [eventName, setEventName] = useState('');\r\n  const [isCreator, setIsCreator] = useState(false);\r\n  const [eventStatus, setEventStatus] = useState('Aberto');\r\n  const [event, setEvent] = useState(null);\r\n  const [isApprovedParticipant, setIsApprovedParticipant] = useState(false);\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  const getSenderProfile = (userId) => {\r\n    return profileMap.get(userId) || { username: 'Usuário', full_name: '', avatar_url: null };\r\n  };\r\n\r\n  const getAvatarUrl = (profile) => {\r\n    if (!profile || !profile.avatar_url) {\r\n      const name = profile?.username || profile?.full_name || 'U';\r\n      return `https://ui-avatars.com/api/?name=${encodeURIComponent(name)}&background=8b5cf6&color=fff&size=40`;\r\n    }\r\n\r\n    try {\r\n      const { data } = supabase.storage.from('avatars').getPublicUrl(profile.avatar_url);\r\n      return data.publicUrl || `https://ui-avatars.com/api/?name=${encodeURIComponent(profile.username || 'U')}&background=8b5cf6&color=fff&size=40`;\r\n    } catch {\r\n      return `https://ui-avatars.com/api/?name=${encodeURIComponent(profile.username || 'U')}&background=8b5cf6&color=fff&size=40`;\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!eventId || !user) {\r\n      if (!eventId) setError('ID do evento inválido.');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    const loadChatData = async () => {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      try {\r\n        const { data: eventData, error: eventError } = await supabase\r\n          .from('events')\r\n          .select('id, title, creator_id, status, event_type, vagas')\r\n          .eq('id', eventId)\r\n          .single();\r\n\r\n        if (eventError) throw eventError;\r\n\r\n        const { count: approvedCount, error: countError } = await supabase\r\n          .from('event_participants')\r\n          .select('*', { count: 'exact', head: true })\r\n          .eq('event_id', eventId)\r\n          .eq('status', 'aprovado');\r\n\r\n        if (countError) throw countError;\r\n\r\n        const eventWithCount = { ...eventData, approvedCount: approvedCount || 0 };\r\n        setEvent(eventWithCount);\r\n        setEventName(eventData.title);\r\n        setEventStatus(eventData.status);\r\n\r\n        const userIsCreator = eventData.creator_id === user.id;\r\n        setIsCreator(userIsCreator);\r\n\r\n        let userIsApproved = false;\r\n        if (!userIsCreator) {\r\n          const { data: participation } = await supabase\r\n            .from('event_participants')\r\n            .select('status')\r\n            .eq('event_id', eventId)\r\n            .eq('user_id', user.id)\r\n            .single();\r\n\r\n          userIsApproved = participation?.status === 'aprovado';\r\n        }\r\n        setIsApprovedParticipant(userIsApproved);\r\n\r\n        const availability = isChatAvailable(eventWithCount, userIsCreator, userIsApproved);\r\n        if (!availability.available) {\r\n          setError(availability.reason);\r\n          setLoading(false);\r\n          return;\r\n        }\r\n\r\n        const { data: messagesData, error: messagesError } = await supabase\r\n          .from('event_messages')\r\n          .select('*')\r\n          .eq('event_id', eventId)\r\n          .order('created_at', { ascending: true });\r\n\r\n        if (messagesError) throw messagesError;\r\n        setMessages(messagesData);\r\n\r\n        const senderIds = [...new Set(messagesData.map(msg => msg.user_id))];\r\n        const { data: approvedParticipants, error: participantsError } = await supabase\r\n          .from('event_participants')\r\n          .select('profile:profiles(id, username, avatar_url, full_name)')\r\n          .eq('event_id', eventId)\r\n          .eq('status', 'aprovado');\r\n\r\n        if (participantsError) throw participantsError;\r\n\r\n        const newProfileMap = new Map();\r\n        const approvedIds = [];\r\n\r\n        approvedParticipants.forEach(p => {\r\n          if (p.profile) {\r\n            newProfileMap.set(p.profile.id, p.profile);\r\n            approvedIds.push(p.profile.id);\r\n          }\r\n        });\r\n\r\n        if (userIsCreator && !newProfileMap.has(user.id)) {\r\n          const { data: creatorProfile } = await supabase\r\n            .from('profiles')\r\n            .select('id, username, avatar_url, full_name')\r\n            .eq('id', user.id)\r\n            .single();\r\n          if (creatorProfile) newProfileMap.set(creatorProfile.id, creatorProfile);\r\n        }\r\n\r\n        const missingIds = senderIds.filter(id => !newProfileMap.has(id));\r\n        if (missingIds.length > 0) {\r\n          const { data: _ } = await supabase\r\n            .from('profiles')\r\n            .select('id, username, avatar_url, full_name')\r\n            .in('id', missingIds);\r\n\r\n          _?.forEach(p => newProfileMap.set(p.id, p));\r\n        }\r\n\r\n        setProfileMap(newProfileMap);\r\n\r\n        let activeCount = approvedIds.length;\r\n        if (userIsCreator && !approvedIds.includes(user.id)) activeCount++;\r\n        setActiveParticipantCount(activeCount);\r\n\r\n      } catch (err) {\r\n        console.error('Erro ao carregar chat:', err);\r\n        setError('Falha ao carregar o chat.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadChatData();\r\n\r\n    const channel = supabase\r\n      .channel(`chat_room:${eventId}`)\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: 'INSERT',\r\n          schema: 'public',\r\n          table: 'event_messages',\r\n          filter: `event_id=eq.${eventId}`,\r\n        },\r\n        async (payload) => {\r\n          const newMsg = payload.new;\r\n          setMessages(prev => [...prev, newMsg]);\r\n\r\n          const newSenderId = newMsg.user_id;\r\n          if (!profileMap.has(newSenderId)) {\r\n            const { data: newProfile } = await supabase\r\n              .from('profiles')\r\n              .select('id, username, avatar_url, full_name')\r\n              .eq('id', newSenderId)\r\n              .single();\r\n\r\n            if (newProfile) {\r\n              setProfileMap(prev => new Map(prev).set(newProfile.id, newProfile));\r\n            }\r\n          }\r\n\r\n          scrollToBottom();\r\n        }\r\n      )\r\n      .subscribe();\r\n\r\n    return () => {\r\n      supabase.removeChannel(channel);\r\n    };\r\n  }, [eventId, user, profileMap]);\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!newMessage.trim() || eventStatus === 'Concluído') return;\r\n\r\n    try {\r\n      const { error } = await supabase\r\n        .from('event_messages')\r\n        .insert({\r\n          event_id: eventId,\r\n          user_id: user.id,\r\n          content: newMessage.trim(),\r\n        });\r\n\r\n      if (error) throw error;\r\n      setNewMessage('');\r\n    } catch (err) {\r\n      console.error('Erro ao enviar mensagem:', err);\r\n    }\r\n  };\r\n\r\n  const handleDeleteMessage = async (messageId) => {\r\n    if (!confirm('Apagar esta mensagem?')) return;\r\n\r\n    try {\r\n      const { error } = await supabase\r\n        .from('event_messages')\r\n        .delete()\r\n        .eq('id', messageId)\r\n        .eq('user_id', user.id);\r\n\r\n      if (error) throw error;\r\n\r\n      setMessages(prev => prev.filter(m => m.id !== messageId));\r\n    } catch (err) {\r\n      console.error('Erro ao apagar mensagem:', err);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <Loader2 className=\"w-12 h-12 animate-spin text-purple-500\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    const isInstitutional = event?.event_type === 'institucional';\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen p-4\">\r\n        <div className=\"text-center glass-effect rounded-2xl p-8 border border-white/10 max-w-md\">\r\n          <Lock className=\"w-16 h-16 text-purple-500 mb-4 mx-auto\" />\r\n          <h2 className=\"text-2xl font-semibold text-white mb-3\">Chat não disponível</h2>\r\n          <p className=\"text-white/70 mb-6\">{error}</p>\r\n\r\n          {isInstitutional && !isCreator && isApprovedParticipant && (\r\n            <div className=\"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4 mb-6\">\r\n              <p className=\"text-blue-300 text-sm\">\r\n                Evento Institucional: O chat será liberado automaticamente assim que o primeiro participante for aprovado.\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          {!isInstitutional && !isCreator && isApprovedParticipant && event && (\r\n            <div className=\"bg-purple-500/10 border border-purple-500/30 rounded-lg p-4 mb-6\">\r\n              <p className=\"text-purple-300 text-sm mb-2\">Progresso do evento:</p>\r\n              <p className=\"text-white text-lg font-semibold\">\r\n                {event.approvedCount} / {event.vagas} vagas preenchidas\r\n              </p>\r\n              <p className=\"text-white/60 text-xs mt-2\">\r\n                O chat será liberado quando todas as vagas forem preenchidas ou o evento for confirmado.\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          <Button onClick={() => navigate(`/event/${eventId}`)}>\r\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\r\n            Voltar ao Evento\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>Chat: {eventName || 'Evento'} | Mesapra2</title>\r\n      </Helmet>\r\n\r\n      <div className=\"flex flex-col h-[calc(100vh-8rem)] bg-gray-900/50 rounded-2xl border border-white/10 overflow-hidden\">\r\n        <header className=\"flex items-center p-4 border-b border-white/10 bg-background/80 backdrop-blur-sm z-10\">\r\n          <Link to={`/event/${eventId}`} className=\"mr-4\">\r\n            <Button variant=\"ghost\" size=\"icon\">\r\n              <ArrowLeft className=\"w-5 h-5\" />\r\n            </Button>\r\n          </Link>\r\n          <div className=\"flex-1\">\r\n            <h1 className=\"text-lg font-semibold text-white truncate\">{eventName}</h1>\r\n            <p className=\"text-xs text-white/50\">\r\n              {activeParticipantCount} participantes\r\n              {event?.event_type === 'institucional' && <span className=\"ml-2 text-purple-400\">• Institucional</span>}\r\n            </p>\r\n          </div>\r\n        </header>\r\n\r\n        <div className=\"flex-1 p-4 overflow-y-auto space-y-4\">\r\n          {event?.event_type === 'institucional' && messages.length === 0 && (\r\n            <div className=\"text-center py-8\">\r\n              <div className=\"inline-block p-4 rounded-lg bg-purple-500/10 border border-purple-500/30\">\r\n                <p className=\"text-purple-300 text-sm\">\r\n                  Chat liberado! Este é um evento institucional.<br />\r\n                  Aproveite para interagir e tirar dúvidas com os outros participantes.\r\n                </p>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {messages.map((msg) => {\r\n            const senderProfile = getSenderProfile(msg.user_id);\r\n            const isMe = msg.user_id === user.id;\r\n\r\n            return (\r\n              <div key={msg.id} className={`flex items-end gap-3 ${isMe ? 'justify-end' : 'justify-start'}`}>\r\n                {!isMe && (\r\n                  <img\r\n                    src={getAvatarUrl(senderProfile)}\r\n                    alt={senderProfile.username || 'Usuário'}\r\n                    className=\"w-8 h-8 rounded-full border border-white/10 flex-shrink-0 object-cover\"\r\n                    onError={(e) => {\r\n                      e.target.src = `https://ui-avatars.com/api/?name=U&background=8b5cf6&color=fff&size=40`;\r\n                    }}\r\n                  />\r\n                )}\r\n                <div className=\"flex items-end gap-2\">\r\n                  <div\r\n                    className={`flex flex-col max-w-xs md:max-w-md p-3 rounded-lg ${\r\n                      isMe ? 'bg-purple-600 text-white rounded-br-none' : 'bg-gray-800 text-white/90 rounded-bl-none'\r\n                    }`}\r\n                  >\r\n                    {!isMe && (\r\n                      <span className=\"text-xs font-semibold text-purple-300 mb-1\">\r\n                        {senderProfile.username || senderProfile.full_name || 'Usuário'}\r\n                      </span>\r\n                    )}\r\n                    <p className=\"text-sm whitespace-pre-wrap\">{msg.content}</p>\r\n                    <span className=\"text-xs text-white/50 mt-1 self-end\">\r\n                      {format(new Date(msg.created_at), 'HH:mm', { locale: ptBR })}\r\n                    </span>\r\n                  </div>\r\n\r\n                  {(isMe || isCreator) && (\r\n                    <SimpleDropdown\r\n                      trigger={\r\n                        <Button variant=\"ghost\" size=\"icon\" className=\"h-6 w-6 opacity-0 hover:opacity-100 transition-opacity\">\r\n                          <MoreVertical className=\"h-4 h-4\" />\r\n                        </Button>\r\n                      }\r\n                    >\r\n                      <SimpleDropdownItem onClick={() => handleDeleteMessage(msg.id)} className=\"text-red-400\">\r\n                        <Trash2 className=\"w-4 h-4 mr-2\" />\r\n                        Apagar mensagem\r\n                      </SimpleDropdownItem>\r\n                    </SimpleDropdown>\r\n                  )}\r\n                </div>\r\n                {isMe && (\r\n                  <img\r\n                    src={getAvatarUrl(senderProfile)}\r\n                    alt=\"Você\"\r\n                    className=\"w-8 h-8 rounded-full border border-white/10 flex-shrink-0 object-cover\"\r\n                    onError={(e) => {\r\n                      e.target.src = `https://ui-avatars.com/api/?name=U&background=8b5cf6&color=fff&size=40`;\r\n                    }}\r\n                  />\r\n                )}\r\n              </div>\r\n            );\r\n          })}\r\n          <div ref={messagesEndRef} />\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit} className=\"p-4 border-t border-white/10 bg-background/80 backdrop-blur-sm\">\r\n          {eventStatus === 'Concluído' && (\r\n            <div className=\"mb-3 p-2 rounded-lg bg-gray-700/50 border border-gray-600/50\">\r\n              <p className=\"text-gray-300 text-xs text-center\">\r\n                Evento concluído - Chat em modo leitura\r\n              </p>\r\n            </div>\r\n          )}\r\n          <div className=\"flex items-center gap-3\">\r\n            <Input\r\n              type=\"text\"\r\n              value={newMessage}\r\n              onChange={(e) => setNewMessage(e.target.value)}\r\n              placeholder={eventStatus === 'Concluído' ? 'Chat encerrado...' : 'Digite sua mensagem...'}\r\n              className=\"flex-1 bg-gray-800 border-gray-700\"\r\n              autoComplete=\"off\"\r\n              disabled={eventStatus === 'Concluído'}\r\n            />\r\n            <Button\r\n              type=\"submit\"\r\n              size=\"icon\"\r\n              className=\"flex-shrink-0\"\r\n              disabled={!newMessage.trim() || eventStatus === 'Concluído'}\r\n            >\r\n              <Send className=\"w-5 h-5\" />\r\n            </Button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EventChatPage;"],"version":3}