46326c020e086e9362315f30dd369434
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const jsx_runtime_1 = require("react/jsx-runtime");
// src/features/shared/components/events/ParticipantsManager.jsx
const react_1 = tslib_1.__importStar(require("react"));
const framer_motion_1 = require("framer-motion");
const lucide_react_1 = require("lucide-react"); // Removido Star
const button_1 = require("@/features/shared/components/ui/button");
const ParticipationService_1 = tslib_1.__importDefault(require("@/services/ParticipationService"));
const date_fns_1 = require("date-fns");
const locale_1 = require("date-fns/locale");
const use_toast_1 = require("@/features/shared/components/ui/use-toast");
const prop_types_1 = tslib_1.__importDefault(require("prop-types"));
const avatarHelper_1 = require("@/utils/avatarHelper");
const supabaseClient_1 = require("@/lib/supabaseClient");
/**
 * Componente para gerenciar participantes de um evento (AnfitriÃ£o)
 */
const ParticipantsManagement = ({ eventId, eventType, onUpdate }) => {
    const [participants, setParticipants] = (0, react_1.useState)([]);
    const [loading, setLoading] = (0, react_1.useState)(true);
    const [filter, setFilter] = (0, react_1.useState)('todos'); // todos, pendente, aprovado, rejeitado
    const [eventStartTime, setEventStartTime] = (0, react_1.useState)(null);
    // ðŸ• Verifica se o evento comeÃ§a em menos de 1 minuto
    const isEventTooClose = () => {
        if (!eventStartTime)
            return false;
        const now = new Date();
        const startTime = new Date(eventStartTime);
        const oneMinuteBefore = new Date(startTime.getTime() - 1 * 60 * 1000);
        return now >= oneMinuteBefore;
    };
    const loadParticipants = async () => {
        setLoading(true);
        const result = await ParticipationService_1.default.getEventParticipations(eventId);
        if (result.success) {
            setParticipants(result.data);
        }
        setLoading(false);
    };
    // Buscar start_time do evento
    const loadEventStartTime = async () => {
        try {
            const { data, error } = await supabaseClient_1.supabase
                .from('events')
                .select('start_time')
                .eq('id', eventId)
                .single();
            if (!error && data) {
                setEventStartTime(data.start_time);
            }
        }
        catch (err) {
            console.error('Erro ao buscar start_time do evento:', err);
        }
    };
    (0, react_1.useEffect)(() => {
        if (eventId) {
            loadParticipants();
            loadEventStartTime();
        }
        // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [eventId]);
    const handleApprove = async (participationId) => {
        try {
            // ðŸ”’ Verificar se o evento nÃ£o estÃ¡ muito perto
            if (isEventTooClose()) {
                (0, use_toast_1.toast)({
                    variant: "destructive",
                    title: "AprovaÃ§Ã£o bloqueada",
                    description: "NÃ£o Ã© possÃ­vel aprovar participantes a menos de 1 minuto do evento",
                });
                return;
            }
            console.log('Aprovando participaÃ§Ã£o:', participationId);
            const result = await ParticipationService_1.default.approveParticipation(participationId, eventId);
            if (result.success) {
                console.log('ParticipaÃ§Ã£o aprovada com sucesso');
                loadParticipants();
                if (onUpdate)
                    onUpdate();
                (0, use_toast_1.toast)({
                    title: "Participante aprovado!",
                    description: "O participante foi notificado da aprovaÃ§Ã£o.",
                });
            }
            else {
                console.error('Erro ao aprovar:', result.error);
                (0, use_toast_1.toast)({
                    variant: "destructive",
                    title: "Erro ao aprovar",
                    description: result.error,
                });
            }
        }
        catch (error) {
            console.error('Erro:', error);
            (0, use_toast_1.toast)({
                variant: "destructive",
                title: "Erro",
                description: "Erro ao aprovar participaÃ§Ã£o",
            });
        }
    };
    const handleReject = async (participationId) => {
        const confirmed = confirm('Deseja realmente rejeitar esta candidatura?');
        if (!confirmed)
            return;
        try {
            const result = await ParticipationService_1.default.rejectParticipation(participationId);
            if (result.success) {
                loadParticipants();
                if (onUpdate)
                    onUpdate();
                (0, use_toast_1.toast)({
                    title: "Rejeitado",
                    description: "A candidatura foi rejeitada.",
                    variant: "destructive"
                });
            }
        }
        catch (error) {
            console.error('Erro ao rejeitar:', error);
            (0, use_toast_1.toast)({
                variant: "destructive",
                title: "Erro",
                description: "Erro ao rejeitar participaÃ§Ã£o",
            });
        }
    };
    const filteredParticipants = participants.filter(p => {
        if (filter === 'todos')
            return true;
        if (filter === 'pendente')
            return p.status === 'pendente';
        if (filter === 'aprovado')
            return p.status === 'aprovado';
        if (filter === 'rejeitado')
            return p.status === 'rejeitado';
        return true;
    });
    return ((0, jsx_runtime_1.jsxs)("div", { className: "space-y-4", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex gap-2 flex-wrap", children: ['todos', 'pendente', 'aprovado', 'rejeitado'].map(f => ((0, jsx_runtime_1.jsxs)(button_1.Button, { variant: filter === f ? "default" : "outline", size: "sm", onClick: () => setFilter(f), className: "capitalize", children: [f, " (", participants.filter(p => p.status === f || f === 'todos').length, ")"] }, f))) }), loading ? ((0, jsx_runtime_1.jsx)("div", { className: "flex justify-center py-8", children: (0, jsx_runtime_1.jsx)("div", { className: "animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary" }) })) : filteredParticipants.length === 0 ? ((0, jsx_runtime_1.jsxs)("div", { className: "glass-effect rounded-lg p-6 border border-white/10 text-center", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Users, { className: "w-8 h-8 mx-auto mb-2 text-white/40" }), (0, jsx_runtime_1.jsx)("p", { className: "text-white/60", children: "Nenhum participante encontrado." })] })) : ((0, jsx_runtime_1.jsx)("div", { className: "space-y-3", children: filteredParticipants.map((participant) => ((0, jsx_runtime_1.jsx)(framer_motion_1.motion.div, { initial: { opacity: 0, x: -20 }, animate: { opacity: 1, x: 0 }, transition: { duration: 0.2 }, className: "glass-effect rounded-lg p-4 border border-white/10", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-start gap-4", children: [(0, jsx_runtime_1.jsx)("img", { src: (0, avatarHelper_1.getAvatarUrl)(participant.user.avatar_url, participant.user.username, 48), alt: participant.user.username, className: "w-12 h-12 rounded-full object-cover border-2 border-purple-500/30", onError: (e) => {
                                    e.target.src = `https://ui-avatars.com/api/?name=${encodeURIComponent(participant.user.username || 'U')}&background=8b5cf6&color=fff&size=48`;
                                } }), (0, jsx_runtime_1.jsxs)("div", { className: "flex-1 space-y-1", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2 text-sm text-white/60", children: [(0, jsx_runtime_1.jsx)("span", { className: "font-medium text-white", children: participant.user.username }), (0, jsx_runtime_1.jsxs)("span", { className: `inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${participant.status === 'aprovado' ? 'bg-green-500/20 text-green-300 border-green-500/30' :
                                                    participant.status === 'pendente' ? 'bg-yellow-500/20 text-yellow-300 border-yellow-500/30' :
                                                        'bg-red-500/20 text-red-300 border-red-500/30'}`, children: [participant.status === 'aprovado' && (0, jsx_runtime_1.jsx)(lucide_react_1.CheckCircle, { className: "w-3 h-3" }), participant.status === 'pendente' && (0, jsx_runtime_1.jsx)(lucide_react_1.Clock, { className: "w-3 h-3" }), participant.status === 'rejeitado' && (0, jsx_runtime_1.jsx)(lucide_react_1.XCircle, { className: "w-3 h-3" }), participant.status] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2 text-xs text-white/40", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.UserCheck, { className: "w-3 h-3" }), participant.user.reputation_stars || 0, " estrelas", (0, jsx_runtime_1.jsx)("span", { children: "\u2022" }), (0, jsx_runtime_1.jsxs)("span", { children: ["Candidatura: ", (0, date_fns_1.format)(new Date(participant.created_at), "dd/MM 'Ã s' HH:mm", { locale: locale_1.ptBR })] })] }), participant.mensagem_candidatura && ((0, jsx_runtime_1.jsxs)("p", { className: "text-white/60 text-sm bg-white/5 rounded p-2 mb-2", children: ["\"", participant.mensagem_candidatura, "\""] })), participant.status === 'pendente' && eventType !== 'institucional' && ((0, jsx_runtime_1.jsxs)("div", { className: "space-y-2 mt-2", children: [isEventTooClose() && ((0, jsx_runtime_1.jsx)("div", { className: "p-2 rounded bg-red-500/20 border border-red-500/30", children: (0, jsx_runtime_1.jsx)("p", { className: "text-red-300 text-xs font-medium", children: "\u23F0 Evento come\u00E7a em menos de 1 minuto - aprova\u00E7\u00F5es bloqueadas" }) })), (0, jsx_runtime_1.jsxs)("div", { className: "flex gap-2", children: [(0, jsx_runtime_1.jsxs)(button_1.Button, { onClick: () => handleApprove(participant.id), size: "sm", className: "bg-green-500 hover:bg-green-600", disabled: isEventTooClose(), children: [(0, jsx_runtime_1.jsx)(lucide_react_1.CheckCircle, { className: "w-4 h-4 mr-1" }), "Aprovar"] }), (0, jsx_runtime_1.jsxs)(button_1.Button, { onClick: () => handleReject(participant.id), size: "sm", variant: "destructive", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.XCircle, { className: "w-4 h-4 mr-1" }), "Rejeitar"] })] })] }))] })] }) }, participant.id))) })), eventType === 'institucional' && ((0, jsx_runtime_1.jsx)("div", { className: "glass-effect rounded-lg p-4 border border-blue-500/30 bg-blue-500/10", children: (0, jsx_runtime_1.jsxs)("p", { className: "text-blue-300 text-sm flex items-start gap-2", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Users, { className: "w-4 h-4 mt-0.5 flex-shrink-0" }), (0, jsx_runtime_1.jsxs)("span", { children: [(0, jsx_runtime_1.jsx)("strong", { children: "Evento Institucional:" }), " As inscri\u00E7\u00F5es s\u00E3o aprovadas automaticamente."] })] }) }))] }));
};
ParticipantsManagement.propTypes = {
    eventId: prop_types_1.default.string.isRequired,
    eventType: prop_types_1.default.string.isRequired,
    onUpdate: prop_types_1.default.func,
};
exports.default = ParticipantsManagement;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxmZWF0dXJlc1xcc2hhcmVkXFxjb21wb25lbnRzXFxldmVudHNcXFBhcnRpY2lwYW50c01hbmFnZXIuanN4IiwibWFwcGluZ3MiOiI7Ozs7QUFBQSxnRUFBZ0U7QUFDaEUsdURBQW1EO0FBQ25ELGlEQUF1QztBQUN2QywrQ0FBNkUsQ0FBQyxnQkFBZ0I7QUFDOUYsbUVBQWdFO0FBQ2hFLG1HQUFtRTtBQUNuRSx1Q0FBa0M7QUFDbEMsNENBQXVDO0FBQ3ZDLHlFQUFrRTtBQUNsRSxvRUFBbUM7QUFDbkMsdURBQW9EO0FBQ3BELHlEQUFnRDtBQUVoRDs7R0FFRztBQUNILE1BQU0sc0JBQXNCLEdBQUcsQ0FBQyxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLEVBQUUsRUFBRTtJQUNsRSxNQUFNLENBQUMsWUFBWSxFQUFFLGVBQWUsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxFQUFFLENBQUMsQ0FBQztJQUNyRCxNQUFNLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxJQUFJLENBQUMsQ0FBQztJQUM3QyxNQUFNLENBQUMsTUFBTSxFQUFFLFNBQVMsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLHVDQUF1QztJQUN0RixNQUFNLENBQUMsY0FBYyxFQUFFLGlCQUFpQixDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLElBQUksQ0FBQyxDQUFDO0lBRTNELHNEQUFzRDtJQUN0RCxNQUFNLGVBQWUsR0FBRyxHQUFHLEVBQUU7UUFDM0IsSUFBSSxDQUFDLGNBQWM7WUFBRSxPQUFPLEtBQUssQ0FBQztRQUNsQyxNQUFNLEdBQUcsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQ3ZCLE1BQU0sU0FBUyxHQUFHLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQzNDLE1BQU0sZUFBZSxHQUFHLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxP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XFxERVZNaXhcXEFwcC5NZXNhcHJhMi5jb21cXHNyY1xcZmVhdHVyZXNcXHNoYXJlZFxcY29tcG9uZW50c1xcZXZlbnRzXFxQYXJ0aWNpcGFudHNNYW5hZ2VyLmpzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvZmVhdHVyZXMvc2hhcmVkL2NvbXBvbmVudHMvZXZlbnRzL1BhcnRpY2lwYW50c01hbmFnZXIuanN4XHJcbmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBtb3Rpb24gfSBmcm9tICdmcmFtZXItbW90aW9uJztcclxuaW1wb3J0IHsgVXNlcnMsIENoZWNrQ2lyY2xlLCBYQ2lyY2xlLCBDbG9jaywgVXNlckNoZWNrIH0gZnJvbSAnbHVjaWRlLXJlYWN0JzsgLy8gUmVtb3ZpZG8gU3RhclxyXG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tICdAL2ZlYXR1cmVzL3NoYXJlZC9jb21wb25lbnRzL3VpL2J1dHRvbic7XHJcbmltcG9ydCBQYXJ0aWNpcGF0aW9uU2VydmljZSBmcm9tICdAL3NlcnZpY2VzL1BhcnRpY2lwYXRpb25TZXJ2aWNlJztcclxuaW1wb3J0IHsgZm9ybWF0IH0gZnJvbSAnZGF0ZS1mbnMnO1xyXG5pbXBvcnQgeyBwdEJSIH0gZnJvbSAnZGF0ZS1mbnMvbG9jYWxlJztcclxuaW1wb3J0IHsgdG9hc3QgfSBmcm9tICdAL2ZlYXR1cmVzL3NoYXJlZC9jb21wb25lbnRzL3VpL3VzZS10b2FzdCc7XHJcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XHJcbmltcG9ydCB7IGdldEF2YXRhclVybCB9IGZyb20gJ0AvdXRpbHMvYXZhdGFySGVscGVyJztcclxuaW1wb3J0IHsgc3VwYWJhc2UgfSBmcm9tICdAL2xpYi9zdXBhYmFzZUNsaWVudCc7XHJcblxyXG4vKipcclxuICogQ29tcG9uZW50ZSBwYXJhIGdlcmVuY2lhciBwYXJ0aWNpcGFudGVzIGRlIHVtIGV2ZW50byAoQW5maXRyacOjbylcclxuICovXHJcbmNvbnN0IFBhcnRpY2lwYW50c01hbmFnZW1lbnQgPSAoeyBldmVudElkLCBldmVudFR5cGUsIG9uVXBkYXRlIH0pID0+IHtcclxuICBjb25zdCBbcGFydGljaXBhbnRzLCBzZXRQYXJ0aWNpcGFudHNdID0gdXNlU3RhdGUoW10pO1xyXG4gIGNvbnN0IFtsb2FkaW5nLCBzZXRMb2FkaW5nXSA9IHVzZVN0YXRlKHRydWUpO1xyXG4gIGNvbnN0IFtmaWx0ZXIsIHNldEZpbHRlcl0gPSB1c2VTdGF0ZSgndG9kb3MnKTsgLy8gdG9kb3MsIHBlbmRlbnRlLCBhcHJvdmFkbywgcmVqZWl0YWRvXHJcbiAgY29uc3QgW2V2ZW50U3RhcnRUaW1lLCBzZXRFdmVudFN0YXJ0VGltZV0gPSB1c2VTdGF0ZShudWxsKTtcclxuXHJcbiAgLy8g8J+VkCBWZXJpZmljYSBzZSBvIGV2ZW50byBjb21lw6dhIGVtIG1lbm9zIGRlIDEgbWludXRvXHJcbiAgY29uc3QgaXNFdmVudFRvb0Nsb3NlID0gKCkgPT4ge1xyXG4gICAgaWYgKCFldmVudFN0YXJ0VGltZSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcclxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IG5ldyBEYXRlKGV2ZW50U3RhcnRUaW1lKTtcclxuICAgIGNvbnN0IG9uZU1pbnV0ZUJlZm9yZSA9IG5ldyBEYXRlKHN0YXJ0VGltZS5nZXRUaW1lKCkgLSAxICogNjAgKiAxMDAwKTtcclxuICAgIHJldHVybiBub3cgPj0gb25lTWludXRlQmVmb3JlO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGxvYWRQYXJ0aWNpcGFudHMgPSBhc3luYyAoKSA9PiB7XHJcbiAgICBzZXRMb2FkaW5nKHRydWUpO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgUGFydGljaXBhdGlvblNlcnZpY2UuZ2V0RXZlbnRQYXJ0aWNpcGF0aW9ucyhldmVudElkKTtcclxuICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICBzZXRQYXJ0aWNpcGFudHMocmVzdWx0LmRhdGEpO1xyXG4gICAgfVxyXG4gICAgc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgfTtcclxuXHJcbiAgLy8gQnVzY2FyIHN0YXJ0X3RpbWUgZG8gZXZlbnRvXHJcbiAgY29uc3QgbG9hZEV2ZW50U3RhcnRUaW1lID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgnZXZlbnRzJylcclxuICAgICAgICAuc2VsZWN0KCdzdGFydF90aW1lJylcclxuICAgICAgICAuZXEoJ2lkJywgZXZlbnRJZClcclxuICAgICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgICBpZiAoIWVycm9yICYmIGRhdGEpIHtcclxuICAgICAgICBzZXRFdmVudFN0YXJ0VGltZShkYXRhLnN0YXJ0X3RpbWUpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJybyBhbyBidXNjYXIgc3RhcnRfdGltZSBkbyBldmVudG86JywgZXJyKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgaWYgKGV2ZW50SWQpIHtcclxuICAgICAgbG9hZFBhcnRpY2lwYW50cygpO1xyXG4gICAgICBsb2FkRXZlbnRTdGFydFRpbWUoKTtcclxuICAgIH1cclxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHNcclxuICB9LCBbZXZlbnRJZF0pO1xyXG5cclxuICBjb25zdCBoYW5kbGVBcHByb3ZlID0gYXN5bmMgKHBhcnRpY2lwYXRpb25JZCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8g8J+UkiBWZXJpZmljYXIgc2UgbyBldmVudG8gbsOjbyBlc3TDoSBtdWl0byBwZXJ0b1xyXG4gICAgICBpZiAoaXNFdmVudFRvb0Nsb3NlKCkpIHtcclxuICAgICAgICB0b2FzdCh7XHJcbiAgICAgICAgICB2YXJpYW50OiBcImRlc3RydWN0aXZlXCIsXHJcbiAgICAgICAgICB0aXRsZTogXCJBcHJvdmHDp8OjbyBibG9xdWVhZGFcIixcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIk7Do28gw6kgcG9zc8OtdmVsIGFwcm92YXIgcGFydGljaXBhbnRlcyBhIG1lbm9zIGRlIDEgbWludXRvIGRvIGV2ZW50b1wiLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc29sZS5sb2coJ0Fwcm92YW5kbyBwYXJ0aWNpcGHDp8OjbzonLCBwYXJ0aWNpcGF0aW9uSWQpO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgUGFydGljaXBhdGlvblNlcnZpY2UuYXBwcm92ZVBhcnRpY2lwYXRpb24ocGFydGljaXBhdGlvbklkLCBldmVudElkKTtcclxuICAgICAgXHJcbiAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdQYXJ0aWNpcGHDp8OjbyBhcHJvdmFkYSBjb20gc3VjZXNzbycpO1xyXG4gICAgICAgIGxvYWRQYXJ0aWNpcGFudHMoKTtcclxuICAgICAgICBpZiAob25VcGRhdGUpIG9uVXBkYXRlKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdG9hc3Qoe1xyXG4gICAgICAgICAgdGl0bGU6IFwiUGFydGljaXBhbnRlIGFwcm92YWRvIVwiLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiTyBwYXJ0aWNpcGFudGUgZm9pIG5vdGlmaWNhZG8gZGEgYXByb3Zhw6fDo28uXCIsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJybyBhbyBhcHJvdmFyOicsIHJlc3VsdC5lcnJvcik7XHJcbiAgICAgICAgdG9hc3Qoe1xyXG4gICAgICAgICAgdmFyaWFudDogXCJkZXN0cnVjdGl2ZVwiLFxyXG4gICAgICAgICAgdGl0bGU6IFwiRXJybyBhbyBhcHJvdmFyXCIsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogcmVzdWx0LmVycm9yLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvOicsIGVycm9yKTtcclxuICAgICAgdG9hc3Qoe1xyXG4gICAgICAgIHZhcmlhbnQ6IFwiZGVzdHJ1Y3RpdmVcIixcclxuICAgICAgICB0aXRsZTogXCJFcnJvXCIsXHJcbiAgICAgICAgZGVzY3JpcHRpb246IFwiRXJybyBhbyBhcHJvdmFyIHBhcnRpY2lwYcOnw6NvXCIsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZVJlamVjdCA9IGFzeW5jIChwYXJ0aWNpcGF0aW9uSWQpID0+IHtcclxuICAgIGNvbnN0IGNvbmZpcm1lZCA9IGNvbmZpcm0oJ0Rlc2VqYSByZWFsbWVudGUgcmVqZWl0YXIgZXN0YSBjYW5kaWRhdHVyYT8nKTtcclxuICAgIGlmICghY29uZmlybWVkKSByZXR1cm47XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgUGFydGljaXBhdGlvblNlcnZpY2UucmVqZWN0UGFydGljaXBhdGlvbihwYXJ0aWNpcGF0aW9uSWQpO1xyXG4gICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcclxuICAgICAgICBsb2FkUGFydGljaXBhbnRzKCk7XHJcbiAgICAgICAgaWYgKG9uVXBkYXRlKSBvblVwZGF0ZSgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRvYXN0KHtcclxuICAgICAgICAgIHRpdGxlOiBcIlJlamVpdGFkb1wiLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IFwiQSBjYW5kaWRhdHVyYSBmb2kgcmVqZWl0YWRhLlwiLFxyXG4gICAgICAgICAgdmFyaWFudDogXCJkZXN0cnVjdGl2ZVwiXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gYW8gcmVqZWl0YXI6JywgZXJyb3IpO1xyXG4gICAgICB0b2FzdCh7XHJcbiAgICAgICAgdmFyaWFudDogXCJkZXN0cnVjdGl2ZVwiLFxyXG4gICAgICAgIHRpdGxlOiBcIkVycm9cIixcclxuICAgICAgICBkZXNjcmlwdGlvbjogXCJFcnJvIGFvIHJlamVpdGFyIHBhcnRpY2lwYcOnw6NvXCIsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGZpbHRlcmVkUGFydGljaXBhbnRzID0gcGFydGljaXBhbnRzLmZpbHRlcihwID0+IHtcclxuICAgIGlmIChmaWx0ZXIgPT09ICd0b2RvcycpIHJldHVybiB0cnVlO1xyXG4gICAgaWYgKGZpbHRlciA9PT0gJ3BlbmRlbnRlJykgcmV0dXJuIHAuc3RhdHVzID09PSAncGVuZGVudGUnO1xyXG4gICAgaWYgKGZpbHRlciA9PT0gJ2Fwcm92YWRvJykgcmV0dXJuIHAuc3RhdHVzID09PSAnYXByb3ZhZG8nO1xyXG4gICAgaWYgKGZpbHRlciA9PT0gJ3JlamVpdGFkbycpIHJldHVybiBwLnN0YXR1cyA9PT0gJ3JlamVpdGFkbyc7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIChcclxuICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS00XCI+XHJcbiAgICAgIHsvKiBGaWx0cm9zICovfVxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZ2FwLTIgZmxleC13cmFwXCI+XHJcbiAgICAgICAge1sndG9kb3MnLCAncGVuZGVudGUnLCAnYXByb3ZhZG8nLCAncmVqZWl0YWRvJ10ubWFwKGYgPT4gKFxyXG4gICAgICAgICAgPEJ1dHRvblxyXG4gICAgICAgICAgICBrZXk9e2Z9XHJcbiAgICAgICAgICAgIHZhcmlhbnQ9e2ZpbHRlciA9PT0gZiA/IFwiZGVmYXVsdFwiIDogXCJvdXRsaW5lXCJ9XHJcbiAgICAgICAgICAgIHNpemU9XCJzbVwiXHJcbiAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHNldEZpbHRlcihmKX1cclxuICAgICAgICAgICAgY2xhc3NOYW1lPVwiY2FwaXRhbGl6ZVwiXHJcbiAgICAgICAgICA+XHJcbiAgICAgICAgICAgIHtmfSAoe3BhcnRpY2lwYW50cy5maWx0ZXIocCA9PiBwLnN0YXR1cyA9PT0gZiB8fCBmID09PSAndG9kb3MnKS5sZW5ndGh9KVxyXG4gICAgICAgICAgPC9CdXR0b24+XHJcbiAgICAgICAgKSl9XHJcbiAgICAgIDwvZGl2PlxyXG5cclxuICAgICAge2xvYWRpbmcgPyAoXHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGp1c3RpZnktY2VudGVyIHB5LThcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYW5pbWF0ZS1zcGluIHJvdW5kZWQtZnVsbCBoLTggdy04IGJvcmRlci10LTIgYm9yZGVyLWItMiBib3JkZXItcHJpbWFyeVwiPjwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICApIDogZmlsdGVyZWRQYXJ0aWNpcGFudHMubGVuZ3RoID09PSAwID8gKFxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ2xhc3MtZWZmZWN0IHJvdW5kZWQtbGcgcC02IGJvcmRlciBib3JkZXItd2hpdGUvMTAgdGV4dC1jZW50ZXJcIj5cclxuICAgICAgICAgIDxVc2VycyBjbGFzc05hbWU9XCJ3LTggaC04IG14LWF1dG8gbWItMiB0ZXh0LXdoaXRlLzQwXCIgLz5cclxuICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtd2hpdGUvNjBcIj5OZW5odW0gcGFydGljaXBhbnRlIGVuY29udHJhZG8uPC9wPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICApIDogKFxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0zXCI+XHJcbiAgICAgICAgICB7ZmlsdGVyZWRQYXJ0aWNpcGFudHMubWFwKChwYXJ0aWNpcGFudCkgPT4gKFxyXG4gICAgICAgICAgICA8bW90aW9uLmRpdlxyXG4gICAgICAgICAgICAgIGtleT17cGFydGljaXBhbnQuaWR9XHJcbiAgICAgICAgICAgICAgaW5pdGlhbD17eyBvcGFjaXR5OiAwLCB4OiAtMjAgfX1cclxuICAgICAgICAgICAgICBhbmltYXRlPXt7IG9wYWNpdHk6IDEsIHg6IDAgfX1cclxuICAgICAgICAgICAgICB0cmFuc2l0aW9uPXt7IGR1cmF0aW9uOiAwLjIgfX1cclxuICAgICAgICAgICAgICBjbGFzc05hbWU9XCJnbGFzcy1lZmZlY3Qgcm91bmRlZC1sZyBwLTQgYm9yZGVyIGJvcmRlci13aGl0ZS8xMFwiXHJcbiAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtc3RhcnQgZ2FwLTRcIj5cclxuICAgICAgICAgICAgICAgIDxpbWdcclxuICAgICAgICAgICAgICAgICAgc3JjPXtnZXRBdmF0YXJVcmwocGFydGljaXBhbnQudXNlci5hdmF0YXJfdXJsLCBwYXJ0aWNpcGFudC51c2VyLnVzZXJuYW1lLCA0OCl9XHJcbiAgICAgICAgICAgICAgICAgIGFsdD17cGFydGljaXBhbnQudXNlci51c2VybmFtZX1cclxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy0xMiBoLTEyIHJvdW5kZWQtZnVsbCBvYmplY3QtY292ZXIgYm9yZGVyLTIgYm9yZGVyLXB1cnBsZS01MDAvMzBcIlxyXG4gICAgICAgICAgICAgICAgICBvbkVycm9yPXsoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGUudGFyZ2V0LnNyYyA9IGBodHRwczovL3VpLWF2YXRhcnMuY29tL2FwaS8/bmFtZT0ke2VuY29kZVVSSUNvbXBvbmVudChcclxuICAgICAgICAgICAgICAgICAgICAgIHBhcnRpY2lwYW50LnVzZXIudXNlcm5hbWUgfHwgJ1UnXHJcbiAgICAgICAgICAgICAgICAgICAgKX0mYmFja2dyb3VuZD04YjVjZjYmY29sb3I9ZmZmJnNpemU9NDhgO1xyXG4gICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xIHNwYWNlLXktMVwiPlxyXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0yIHRleHQtc20gdGV4dC13aGl0ZS82MFwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImZvbnQtbWVkaXVtIHRleHQtd2hpdGVcIj57cGFydGljaXBhbnQudXNlci51c2VybmFtZX08L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPXtgaW5saW5lLWZsZXggaXRlbXMtY2VudGVyIGdhcC0xIHB4LTIgcHktMC41IHJvdW5kZWQtZnVsbCB0ZXh0LXhzIGZvbnQtbWVkaXVtICR7XHJcbiAgICAgICAgICAgICAgICAgICAgICBwYXJ0aWNpcGFudC5zdGF0dXMgPT09ICdhcHJvdmFkbycgPyAnYmctZ3JlZW4tNTAwLzIwIHRleHQtZ3JlZW4tMzAwIGJvcmRlci1ncmVlbi01MDAvMzAnIDpcclxuICAgICAgICAgICAgICAgICAgICAgIHBhcnRpY2lwYW50LnN0YXR1cyA9PT0gJ3BlbmRlbnRlJyA/ICdiZy15ZWxsb3ctNTAwLzIwIHRleHQteWVsbG93LTMwMCBib3JkZXIteWVsbG93LTUwMC8zMCcgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgJ2JnLXJlZC01MDAvMjAgdGV4dC1yZWQtMzAwIGJvcmRlci1yZWQtNTAwLzMwJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1gfT5cclxuICAgICAgICAgICAgICAgICAgICAgIHtwYXJ0aWNpcGFudC5zdGF0dXMgPT09ICdhcHJvdmFkbycgJiYgPENoZWNrQ2lyY2xlIGNsYXNzTmFtZT1cInctMyBoLTNcIiAvPn1cclxuICAgICAgICAgICAgICAgICAgICAgIHtwYXJ0aWNpcGFudC5zdGF0dXMgPT09ICdwZW5kZW50ZScgJiYgPENsb2NrIGNsYXNzTmFtZT1cInctMyBoLTNcIiAvPn1cclxuICAgICAgICAgICAgICAgICAgICAgIHtwYXJ0aWNpcGFudC5zdGF0dXMgPT09ICdyZWplaXRhZG8nICYmIDxYQ2lyY2xlIGNsYXNzTmFtZT1cInctMyBoLTNcIiAvPn1cclxuICAgICAgICAgICAgICAgICAgICAgIHtwYXJ0aWNpcGFudC5zdGF0dXN9XHJcbiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgdGV4dC14cyB0ZXh0LXdoaXRlLzQwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPFVzZXJDaGVjayBjbGFzc05hbWU9XCJ3LTMgaC0zXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICB7cGFydGljaXBhbnQudXNlci5yZXB1dGF0aW9uX3N0YXJzIHx8IDB9IGVzdHJlbGFzXHJcbiAgICAgICAgICAgICAgICAgICAgPHNwYW4+4oCiPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgIDxzcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgQ2FuZGlkYXR1cmE6IHtmb3JtYXQobmV3IERhdGUocGFydGljaXBhbnQuY3JlYXRlZF9hdCksIFwiZGQvTU0gJ8OgcycgSEg6bW1cIiwgeyBsb2NhbGU6IHB0QlIgfSl9XHJcbiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgICAgICAgICAgIHtwYXJ0aWNpcGFudC5tZW5zYWdlbV9jYW5kaWRhdHVyYSAmJiAoXHJcbiAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC13aGl0ZS82MCB0ZXh0LXNtIGJnLXdoaXRlLzUgcm91bmRlZCBwLTIgbWItMlwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgJnF1b3Q7e3BhcnRpY2lwYW50Lm1lbnNhZ2VtX2NhbmRpZGF0dXJhfSZxdW90O1xyXG4gICAgICAgICAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICAgICAgICAgKX1cclxuXHJcbiAgICAgICAgICAgICAgICAgIHsvKiBBw6fDtWVzICovfVxyXG4gICAgICAgICAgICAgICAgICB7cGFydGljaXBhbnQuc3RhdHVzID09PSAncGVuZGVudGUnICYmIGV2ZW50VHlwZSAhPT0gJ2luc3RpdHVjaW9uYWwnICYmIChcclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktMiBtdC0yXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICB7Lyog8J+UkiBBbGVydGEgc2UgZXZlbnRvIGVzdMOhIG11aXRvIHByw7N4aW1vICovfVxyXG4gICAgICAgICAgICAgICAgICAgICAge2lzRXZlbnRUb29DbG9zZSgpICYmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwLTIgcm91bmRlZCBiZy1yZWQtNTAwLzIwIGJvcmRlciBib3JkZXItcmVkLTUwMC8zMFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtcmVkLTMwMCB0ZXh0LXhzIGZvbnQtbWVkaXVtXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICDij7AgRXZlbnRvIGNvbWXDp2EgZW0gbWVub3MgZGUgMSBtaW51dG8gLSBhcHJvdmHDp8O1ZXMgYmxvcXVlYWRhc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZ2FwLTJcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZUFwcHJvdmUocGFydGljaXBhbnQuaWQpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9XCJzbVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYmctZ3JlZW4tNTAwIGhvdmVyOmJnLWdyZWVuLTYwMFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2lzRXZlbnRUb29DbG9zZSgpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPENoZWNrQ2lyY2xlIGNsYXNzTmFtZT1cInctNCBoLTQgbXItMVwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgQXByb3ZhclxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZVJlamVjdChwYXJ0aWNpcGFudC5pZCl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT1cInNtXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PVwiZGVzdHJ1Y3RpdmVcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPFhDaXJjbGUgY2xhc3NOYW1lPVwidy00IGgtNCBtci0xXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBSZWplaXRhclxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvbW90aW9uLmRpdj5cclxuICAgICAgICAgICkpfVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICApfVxyXG5cclxuICAgICAgey8qIE5vdGEgc29icmUgZXZlbnRvcyBpbnN0aXR1Y2lvbmFpcyAqL31cclxuICAgICAge2V2ZW50VHlwZSA9PT0gJ2luc3RpdHVjaW9uYWwnICYmIChcclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdsYXNzLWVmZmVjdCByb3VuZGVkLWxnIHAtNCBib3JkZXIgYm9yZGVyLWJsdWUtNTAwLzMwIGJnLWJsdWUtNTAwLzEwXCI+XHJcbiAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LWJsdWUtMzAwIHRleHQtc20gZmxleCBpdGVtcy1zdGFydCBnYXAtMlwiPlxyXG4gICAgICAgICAgICA8VXNlcnMgY2xhc3NOYW1lPVwidy00IGgtNCBtdC0wLjUgZmxleC1zaHJpbmstMFwiIC8+XHJcbiAgICAgICAgICAgIDxzcGFuPlxyXG4gICAgICAgICAgICAgIDxzdHJvbmc+RXZlbnRvIEluc3RpdHVjaW9uYWw6PC9zdHJvbmc+IEFzIGluc2NyacOnw7VlcyBzw6NvIGFwcm92YWRhcyBhdXRvbWF0aWNhbWVudGUuXHJcbiAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgIDwvcD5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgKX1cclxuICAgIDwvZGl2PlxyXG4gICk7XHJcbn07XHJcblxyXG5QYXJ0aWNpcGFudHNNYW5hZ2VtZW50LnByb3BUeXBlcyA9IHtcclxuICBldmVudElkOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXHJcbiAgZXZlbnRUeXBlOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXHJcbiAgb25VcGRhdGU6IFByb3BUeXBlcy5mdW5jLFxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgUGFydGljaXBhbnRzTWFuYWdlbWVudDsiXSwidmVyc2lvbiI6M30=