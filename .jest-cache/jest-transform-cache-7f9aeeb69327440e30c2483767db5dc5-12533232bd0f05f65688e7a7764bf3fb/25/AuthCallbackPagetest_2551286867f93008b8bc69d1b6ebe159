267ad6b6183ad8cb34f87bace0dcae12
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const jsx_runtime_1 = require("react/jsx-runtime");
// src/features/auth/pages/AuthCallbackPage.test.jsx
/* eslint-disable react/prop-types */
const globals_1 = require("@jest/globals");
// Mock do react-router-dom
globals_1.jest.mock('react-router-dom', () => ({
    ...globals_1.jest.requireActual('react-router-dom'),
    useNavigate: () => mockNavigate,
    useSearchParams: () => [{ get: mockGet }],
}));
// Mock do Supabase
globals_1.jest.mock('@/lib/supabaseClient', () => ({
    supabase: {
        auth: {
            verifyOtp: mockVerifyOtp,
        },
    },
}));
// Mock do Helmet
globals_1.jest.mock('react-helmet-async', () => ({
    Helmet: ({ children }) => (0, jsx_runtime_1.jsx)("div", { "data-testid": "helmet", children: children }),
}));
// Mock do Framer Motion
globals_1.jest.mock('framer-motion', () => ({
    motion: {
        div: ({ children, ...props }) => (0, jsx_runtime_1.jsx)("div", { ...props, children: children }),
    },
}));
// Mock dos componentes Lucide
globals_1.jest.mock('lucide-react', () => ({
    CheckCircle: () => (0, jsx_runtime_1.jsx)("div", { "data-testid": "check-icon", children: "\u2713" }),
    XCircle: () => (0, jsx_runtime_1.jsx)("div", { "data-testid": "x-icon", children: "\u2717" }),
    Loader2: () => (0, jsx_runtime_1.jsx)("div", { "data-testid": "loader-icon", children: "Loading..." }),
}));
// Mock do Button
globals_1.jest.mock('@/features/shared/components/ui/button', () => ({
    Button: ({ children, onClick, ...props }) => ((0, jsx_runtime_1.jsx)("button", { onClick: onClick, "data-testid": props['data-testid'], ...props, children: children })),
}));
const react_1 = require("@testing-library/react");
const react_router_dom_1 = require("react-router-dom");
const user_event_1 = tslib_1.__importDefault(require("@testing-library/user-event"));
const AuthCallbackPage_1 = tslib_1.__importDefault(require("./AuthCallbackPage"));
// --- MOCKS ---
const mockNavigate = globals_1.jest.fn();
const mockGet = globals_1.jest.fn();
const mockVerifyOtp = globals_1.jest.fn();
// --- HELPER ---
const renderWithRouter = (component) => {
    return (0, react_1.render)((0, jsx_runtime_1.jsx)(react_router_dom_1.BrowserRouter, { children: component }));
};
// --- TESTES ---
(0, globals_1.describe)('AuthCallbackPage', () => {
    (0, globals_1.beforeEach)(() => {
        globals_1.jest.clearAllMocks();
        globals_1.jest.useFakeTimers();
        mockGet.mockReset();
        mockVerifyOtp.mockReset();
    });
    (0, globals_1.afterEach)(() => {
        globals_1.jest.runOnlyPendingTimers();
        globals_1.jest.useRealTimers();
    });
    (0, globals_1.describe)('Estado de loading', () => {
        (0, globals_1.it)('deve mostrar loader enquanto processa a confirmação', () => {
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'test-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            mockVerifyOtp.mockImplementation(() => new Promise(() => { })); // Never resolves
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            (0, globals_1.expect)(react_1.screen.getByTestId('loader-icon')).toBeInTheDocument();
            (0, globals_1.expect)(react_1.screen.getByText('Confirmando seu email...')).toBeInTheDocument();
            (0, globals_1.expect)(react_1.screen.getByText('Aguarde enquanto validamos seu cadastro')).toBeInTheDocument();
        });
    });
    (0, globals_1.describe)('Confirmação bem-sucedida', () => {
        (0, globals_1.it)('deve mostrar mensagem de sucesso e redirecionar após confirmar email', async () => {
            const mockUser = { email: 'test@example.com' };
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'valid-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            mockVerifyOtp.mockResolvedValue({
                data: { user: mockUser },
                error: null,
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            // Aguarda processamento
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByTestId('check-icon')).toBeInTheDocument();
            });
            (0, globals_1.expect)(react_1.screen.getByText('Email Confirmado!')).toBeInTheDocument();
            (0, globals_1.expect)(react_1.screen.getByText('Email confirmado com sucesso! Agora você pode fazer login.')).toBeInTheDocument();
            (0, globals_1.expect)(react_1.screen.getByText('Redirecionando para o login...')).toBeInTheDocument();
            // Verifica se verifyOtp foi chamado corretamente
            (0, globals_1.expect)(mockVerifyOtp).toHaveBeenCalledWith({
                token_hash: 'valid-token',
                type: 'email',
            });
            // Avança o timer para simular o timeout
            globals_1.jest.advanceTimersByTime(2000);
            // Verifica redirecionamento
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(mockNavigate).toHaveBeenCalledWith('/login', {
                    state: {
                        emailConfirmed: true,
                        email: 'test@example.com',
                    },
                });
            });
        });
        (0, globals_1.it)('deve funcionar mesmo sem email do usuário', async () => {
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'valid-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            mockVerifyOtp.mockResolvedValue({
                data: { user: null },
                error: null,
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByTestId('check-icon')).toBeInTheDocument();
            });
            globals_1.jest.advanceTimersByTime(2000);
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(mockNavigate).toHaveBeenCalledWith('/login', {
                    state: {
                        emailConfirmed: true,
                        email: undefined,
                    },
                });
            });
        });
    });
    (0, globals_1.describe)('Erros de validação', () => {
        (0, globals_1.it)('deve mostrar erro quando token_hash estiver ausente', async () => {
            mockGet.mockImplementation((param) => {
                if (param === 'type')
                    return 'email';
                return null; // token_hash ausente
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByTestId('x-icon')).toBeInTheDocument();
            });
            (0, globals_1.expect)(react_1.screen.getByText('Erro na Confirmação')).toBeInTheDocument();
            (0, globals_1.expect)(react_1.screen.getByText('Link de confirmação inválido')).toBeInTheDocument();
            (0, globals_1.expect)(mockVerifyOtp).not.toHaveBeenCalled();
        });
        (0, globals_1.it)('deve mostrar erro quando type não for "email"', async () => {
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'test-token';
                if (param === 'type')
                    return 'recovery'; // tipo errado
                return null;
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByTestId('x-icon')).toBeInTheDocument();
            });
            (0, globals_1.expect)(react_1.screen.getByText('Link de confirmação inválido')).toBeInTheDocument();
            (0, globals_1.expect)(mockVerifyOtp).not.toHaveBeenCalled();
        });
        (0, globals_1.it)('deve mostrar erro quando verifyOtp falhar', async () => {
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'invalid-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            mockVerifyOtp.mockResolvedValue({
                data: null,
                error: { message: 'Token inválido' },
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByTestId('x-icon')).toBeInTheDocument();
            });
            (0, globals_1.expect)(react_1.screen.getByText('Token inválido')).toBeInTheDocument();
        });
        (0, globals_1.it)('deve mostrar mensagem específica para email já confirmado', async () => {
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'already-used-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            mockVerifyOtp.mockResolvedValue({
                data: null,
                error: { message: 'Email already confirmed' },
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByText('Este email já foi confirmado anteriormente. Você pode fazer login normalmente.')).toBeInTheDocument();
            });
        });
        (0, globals_1.it)('deve mostrar mensagem específica para link expirado', async () => {
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'expired-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            mockVerifyOtp.mockResolvedValue({
                data: null,
                error: { message: 'Token expired' },
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByText('Este link de confirmação expirou. Solicite um novo link de confirmação.')).toBeInTheDocument();
            });
        });
    });
    (0, globals_1.describe)('Interações do usuário no estado de erro', () => {
        (0, globals_1.beforeEach)(async () => {
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'error-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            mockVerifyOtp.mockResolvedValue({
                data: null,
                error: { message: 'Erro genérico' },
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByTestId('x-icon')).toBeInTheDocument();
            });
        });
        (0, globals_1.it)('deve navegar para login ao clicar em "Ir para Login"', async () => {
            const user = user_event_1.default.setup({ delay: null });
            const loginButton = react_1.screen.getByText('Ir para Login');
            await user.click(loginButton);
            (0, globals_1.expect)(mockNavigate).toHaveBeenCalledWith('/login');
        });
        (0, globals_1.it)('deve navegar para registro ao clicar em "Tentar Novamente"', async () => {
            const user = user_event_1.default.setup({ delay: null });
            const retryButton = react_1.screen.getByText('Tentar Novamente');
            await user.click(retryButton);
            (0, globals_1.expect)(mockNavigate).toHaveBeenCalledWith('/partner/register');
        });
    });
    (0, globals_1.describe)('Metadados e SEO', () => {
        (0, globals_1.it)('deve renderizar o Helmet com título correto', () => {
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'test-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            mockVerifyOtp.mockImplementation(() => new Promise(() => { }));
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            const helmet = react_1.screen.getByTestId('helmet');
            (0, globals_1.expect)(helmet).toBeInTheDocument();
            (0, globals_1.expect)(react_1.screen.getByText('Confirmação de Email - Mesa Pra 2')).toBeInTheDocument();
        });
    });
    (0, globals_1.describe)('Console errors', () => {
        (0, globals_1.it)('deve logar erro no console quando verificação falhar', async () => {
            const consoleErrorSpy = globals_1.jest.spyOn(console, 'error').mockImplementation(() => { });
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'error-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            const error = { message: 'Test error' };
            mockVerifyOtp.mockResolvedValue({
                data: null,
                error,
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(consoleErrorSpy).toHaveBeenCalledWith('Erro na confirmação:', error);
            });
            consoleErrorSpy.mockRestore();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxmZWF0dXJlc1xcc2hhcmVkXFxwYWdlc1xcQXV0aENhbGxiYWNrUGFnZS50ZXN0LmpzeCIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsb0RBQW9EO0FBQ3BELHFDQUFxQztBQUVyQywyQ0FBa0Y7QUFZbEYsMkJBQTJCO0FBQzNCLGNBQUksQ0FBQyxJQUFJLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNuQyxHQUFHLGNBQUksQ0FBQyxhQUFhLENBQUMsa0JBQWtCLENBQUM7SUFDekMsV0FBVyxFQUFFLEdBQUcsRUFBRSxDQUFDLFlBQVk7SUFDL0IsZUFBZSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUMsRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLENBQUM7Q0FDMUMsQ0FBQyxDQUFDLENBQUM7QUFFSixtQkFBbUI7QUFDbkIsY0FBSSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3ZDLFFBQVEsRUFBRTtRQUNSLElBQUksRUFBRTtZQUNKLFNBQVMsRUFBRSxhQUFhO1NBQ3pCO0tBQ0Y7Q0FDRixDQUFDLENBQUMsQ0FBQztBQUVKLGlCQUFpQjtBQUNqQixjQUFJLENBQUMsSUFBSSxDQUFDLG9CQUFvQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDckMsTUFBTSxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsRUFBRSxFQUFFLENBQUMsK0NBQWlCLFFBQVEsWUFBRSxRQUFRLEdBQU87Q0FDckUsQ0FBQyxDQUFDLENBQUM7QUFFSix3QkFBd0I7QUFDeEIsY0FBSSxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNoQyxNQUFNLEVBQUU7UUFDTixHQUFHLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxHQUFHLEtBQUssRUFBRSxFQUFFLEVBQUUsQ0FBQyxtQ0FBUyxLQUFLLFlBQUcsUUFBUSxHQUFPO0tBQ2xFO0NBQ0YsQ0FBQyxD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LEVBQUUsR0FBRSxDQUFDLENBQUMsQ0FBQztZQUVsRixPQUFPLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRTtnQkFDbkMsSUFBSSxLQUFLLEtBQUssWUFBWTtvQkFBRSxPQUFPLGFBQWEsQ0FBQztnQkFDakQsSUFBSSxLQUFLLEtBQUssTUFBTTtvQkFBRSxPQUFPLE9BQU8sQ0FBQztnQkFDckMsT0FBTyxJQUFJLENBQUM7WUFDZCxDQUFDLENBQUMsQ0FBQztZQUVILE1BQU0sS0FBSyxHQUFHLEVBQUUsT0FBTyxFQUFFLFlBQVksRUFBRSxDQUFDO1lBQ3hDLGFBQWEsQ0FBQyxpQkFBaUIsQ0FBQztnQkFDOUIsSUFBSSxFQUFFLElBQUk7Z0JBQ1YsS0FBSzthQUNOLENBQUMsQ0FBQztZQUVILGdCQUFnQixDQUFDLHVCQUFDLDBCQUFnQixLQUFHLENBQUMsQ0FBQztZQUV2QyxNQUFNLElBQUEsZUFBTyxFQUFDLEdBQUcsRUFBRTtnQkFDakIsSUFBQSxnQkFBTSxFQUFDLGVBQWUsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLHNCQUFzQixFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQzlFLENBQUMsQ0FBQyxDQUFDO1lBRUgsZUFBZSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ2hDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcREVWTWl4XFxBcHAuTWVzYXByYTIuY29tXFxzcmNcXGZlYXR1cmVzXFxzaGFyZWRcXHBhZ2VzXFxBdXRoQ2FsbGJhY2tQYWdlLnRlc3QuanN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9mZWF0dXJlcy9hdXRoL3BhZ2VzL0F1dGhDYWxsYmFja1BhZ2UudGVzdC5qc3hcclxuLyogZXNsaW50LWRpc2FibGUgcmVhY3QvcHJvcC10eXBlcyAqL1xyXG5cclxuaW1wb3J0IHsgZGVzY3JpYmUsIGl0LCBleHBlY3QsIGplc3QsIGJlZm9yZUVhY2gsIGFmdGVyRWFjaCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xyXG5pbXBvcnQgeyByZW5kZXIsIHNjcmVlbiwgd2FpdEZvciB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnO1xyXG5pbXBvcnQgeyBCcm93c2VyUm91dGVyIH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XHJcbmltcG9ydCB1c2VyRXZlbnQgZnJvbSAnQHRlc3RpbmctbGlicmFyeS91c2VyLWV2ZW50JztcclxuaW1wb3J0IEF1dGhDYWxsYmFja1BhZ2UgZnJvbSAnLi9BdXRoQ2FsbGJhY2tQYWdlJztcclxuXHJcbi8vIC0tLSBNT0NLUyAtLS1cclxuXHJcbmNvbnN0IG1vY2tOYXZpZ2F0ZSA9IGplc3QuZm4oKTtcclxuY29uc3QgbW9ja0dldCA9IGplc3QuZm4oKTtcclxuY29uc3QgbW9ja1ZlcmlmeU90cCA9IGplc3QuZm4oKTtcclxuXHJcbi8vIE1vY2sgZG8gcmVhY3Qtcm91dGVyLWRvbVxyXG5qZXN0Lm1vY2soJ3JlYWN0LXJvdXRlci1kb20nLCAoKSA9PiAoe1xyXG4gIC4uLmplc3QucmVxdWlyZUFjdHVhbCgncmVhY3Qtcm91dGVyLWRvbScpLFxyXG4gIHVzZU5hdmlnYXRlOiAoKSA9PiBtb2NrTmF2aWdhdGUsXHJcbiAgdXNlU2VhcmNoUGFyYW1zOiAoKSA9PiBbeyBnZXQ6IG1vY2tHZXQgfV0sXHJcbn0pKTtcclxuXHJcbi8vIE1vY2sgZG8gU3VwYWJhc2VcclxuamVzdC5tb2NrKCdAL2xpYi9zdXBhYmFzZUNsaWVudCcsICgpID0+ICh7XHJcbiAgc3VwYWJhc2U6IHtcclxuICAgIGF1dGg6IHtcclxuICAgICAgdmVyaWZ5T3RwOiBtb2NrVmVyaWZ5T3RwLFxyXG4gICAgfSxcclxuICB9LFxyXG59KSk7XHJcblxyXG4vLyBNb2NrIGRvIEhlbG1ldFxyXG5qZXN0Lm1vY2soJ3JlYWN0LWhlbG1ldC1hc3luYycsICgpID0+ICh7XHJcbiAgSGVsbWV0OiAoeyBjaGlsZHJlbiB9KSA9PiA8ZGl2IGRhdGEtdGVzdGlkPVwiaGVsbWV0XCI+e2NoaWxkcmVufTwvZGl2PixcclxufSkpO1xyXG5cclxuLy8gTW9jayBkbyBGcmFtZXIgTW90aW9uXHJcbmplc3QubW9jaygnZnJhbWVyLW1vdGlvbicsICgpID0+ICh7XHJcbiAgbW90aW9uOiB7XHJcbiAgICBkaXY6ICh7IGNoaWxkcmVuLCAuLi5wcm9wcyB9KSA9PiA8ZGl2IHsuLi5wcm9wc30+e2NoaWxkcmVufTwvZGl2PixcclxuICB9LFxyXG59KSk7XHJcblxyXG4vLyBNb2NrIGRvcyBjb21wb25lbnRlcyBMdWNpZGVcclxuamVzdC5tb2NrKCdsdWNpZGUtcmVhY3QnLCAoKSA9PiAoe1xyXG4gIENoZWNrQ2lyY2xlOiAoKSA9PiA8ZGl2IGRhdGEtdGVzdGlkPVwiY2hlY2staWNvblwiPuKckzwvZGl2PixcclxuICBYQ2lyY2xlOiAoKSA9PiA8ZGl2IGRhdGEtdGVzdGlkPVwieC1pY29uXCI+4pyXPC9kaXY+LFxyXG4gIExvYWRlcjI6ICgpID0+IDxkaXYgZGF0YS10ZXN0aWQ9XCJsb2FkZXItaWNvblwiPkxvYWRpbmcuLi48L2Rpdj4sXHJcbn0pKTtcclxuXHJcbi8vIE1vY2sgZG8gQnV0dG9uXHJcbmplc3QubW9jaygnQC9mZWF0dXJlcy9zaGFyZWQvY29tcG9uZW50cy91aS9idXR0b24nLCAoKSA9PiAoe1xyXG4gIEJ1dHRvbjogKHsgY2hpbGRyZW4sIG9uQ2xpY2ssIC4uLnByb3BzIH0pID0+IChcclxuICAgIDxidXR0b24gb25DbGljaz17b25DbGlja30gZGF0YS10ZXN0aWQ9e3Byb3BzWydkYXRhLXRlc3RpZCddfSB7Li4ucHJvcHN9PlxyXG4gICAgICB7Y2hpbGRyZW59XHJcbiAgICA8L2J1dHRvbj5cclxuICApLFxyXG59KSk7XHJcblxyXG4vLyAtLS0gSEVMUEVSIC0tLVxyXG5cclxuY29uc3QgcmVuZGVyV2l0aFJvdXRlciA9IChjb21wb25lbnQpID0+IHtcclxuICByZXR1cm4gcmVuZGVyKFxyXG4gICAgPEJyb3dzZXJSb3V0ZXI+XHJcbiAgICAgIHtjb21wb25lbnR9XHJcbiAgICA8L0Jyb3dzZXJSb3V0ZXI+XHJcbiAgKTtcclxufTtcclxuXHJcbi8vIC0tLSBURVNURVMgLS0tXHJcblxyXG5kZXNjcmliZSgnQXV0aENhbGxiYWNrUGFnZScsICgpID0+IHtcclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gICAgamVzdC51c2VGYWtlVGltZXJzKCk7XHJcbiAgICBtb2NrR2V0Lm1vY2tSZXNldCgpO1xyXG4gICAgbW9ja1ZlcmlmeU90cC5tb2NrUmVzZXQoKTtcclxuICB9KTtcclxuXHJcbiAgYWZ0ZXJFYWNoKCgpID0+IHtcclxuICAgIGplc3QucnVuT25seVBlbmRpbmdUaW1lcnMoKTtcclxuICAgIGplc3QudXNlUmVhbFRpbWVycygpO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnRXN0YWRvIGRlIGxvYWRpbmcnLCAoKSA9PiB7XHJcbiAgICBpdCgnZGV2ZSBtb3N0cmFyIGxvYWRlciBlbnF1YW50byBwcm9jZXNzYSBhIGNvbmZpcm1hw6fDo28nLCAoKSA9PiB7XHJcbiAgICAgIG1vY2tHZXQubW9ja0ltcGxlbWVudGF0aW9uKChwYXJhbSkgPT4ge1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3Rva2VuX2hhc2gnKSByZXR1cm4gJ3Rlc3QtdG9rZW4nO1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3R5cGUnKSByZXR1cm4gJ2VtYWlsJztcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBtb2NrVmVyaWZ5T3RwLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBuZXcgUHJvbWlzZSgoKSA9PiB7fSkpOyAvLyBOZXZlciByZXNvbHZlc1xyXG5cclxuICAgICAgcmVuZGVyV2l0aFJvdXRlcig8QXV0aENhbGxiYWNrUGFnZSAvPik7XHJcblxyXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdsb2FkZXItaWNvbicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQ29uZmlybWFuZG8gc2V1IGVtYWlsLi4uJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdBZ3VhcmRlIGVucXVhbnRvIHZhbGlkYW1vcyBzZXUgY2FkYXN0cm8nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnQ29uZmlybWHDp8OjbyBiZW0tc3VjZWRpZGEnLCAoKSA9PiB7XHJcbiAgICBpdCgnZGV2ZSBtb3N0cmFyIG1lbnNhZ2VtIGRlIHN1Y2Vzc28gZSByZWRpcmVjaW9uYXIgYXDDs3MgY29uZmlybWFyIGVtYWlsJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBtb2NrVXNlciA9IHsgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyB9O1xyXG4gICAgICBcclxuICAgICAgbW9ja0dldC5tb2NrSW1wbGVtZW50YXRpb24oKHBhcmFtKSA9PiB7XHJcbiAgICAgICAgaWYgKHBhcmFtID09PSAndG9rZW5faGFzaCcpIHJldHVybiAndmFsaWQtdG9rZW4nO1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3R5cGUnKSByZXR1cm4gJ2VtYWlsJztcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBtb2NrVmVyaWZ5T3RwLm1vY2tSZXNvbHZlZFZhbHVlKHtcclxuICAgICAgICBkYXRhOiB7IHVzZXI6IG1vY2tVc2VyIH0sXHJcbiAgICAgICAgZXJyb3I6IG51bGwsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmVuZGVyV2l0aFJvdXRlcig8QXV0aENhbGxiYWNrUGFnZSAvPik7XHJcblxyXG4gICAgICAvLyBBZ3VhcmRhIHByb2Nlc3NhbWVudG9cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnY2hlY2staWNvbicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdFbWFpbCBDb25maXJtYWRvIScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnRW1haWwgY29uZmlybWFkbyBjb20gc3VjZXNzbyEgQWdvcmEgdm9jw6ogcG9kZSBmYXplciBsb2dpbi4nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1JlZGlyZWNpb25hbmRvIHBhcmEgbyBsb2dpbi4uLicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG5cclxuICAgICAgLy8gVmVyaWZpY2Egc2UgdmVyaWZ5T3RwIGZvaSBjaGFtYWRvIGNvcnJldGFtZW50ZVxyXG4gICAgICBleHBlY3QobW9ja1ZlcmlmeU90cCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xyXG4gICAgICAgIHRva2VuX2hhc2g6ICd2YWxpZC10b2tlbicsXHJcbiAgICAgICAgdHlwZTogJ2VtYWlsJyxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBBdmFuw6dhIG8gdGltZXIgcGFyYSBzaW11bGFyIG8gdGltZW91dFxyXG4gICAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoMjAwMCk7XHJcblxyXG4gICAgICAvLyBWZXJpZmljYSByZWRpcmVjaW9uYW1lbnRvXHJcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAgIGV4cGVjdChtb2NrTmF2aWdhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvbG9naW4nLCB7XHJcbiAgICAgICAgICBzdGF0ZToge1xyXG4gICAgICAgICAgICBlbWFpbENvbmZpcm1lZDogdHJ1ZSxcclxuICAgICAgICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2RldmUgZnVuY2lvbmFyIG1lc21vIHNlbSBlbWFpbCBkbyB1c3XDoXJpbycsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja0dldC5tb2NrSW1wbGVtZW50YXRpb24oKHBhcmFtKSA9PiB7XHJcbiAgICAgICAgaWYgKHBhcmFtID09PSAndG9rZW5faGFzaCcpIHJldHVybiAndmFsaWQtdG9rZW4nO1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3R5cGUnKSByZXR1cm4gJ2VtYWlsJztcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBtb2NrVmVyaWZ5T3RwLm1vY2tSZXNvbHZlZFZhbHVlKHtcclxuICAgICAgICBkYXRhOiB7IHVzZXI6IG51bGwgfSxcclxuICAgICAgICBlcnJvcjogbnVsbCxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZW5kZXJXaXRoUm91dGVyKDxBdXRoQ2FsbGJhY2tQYWdlIC8+KTtcclxuXHJcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ2NoZWNrLWljb24nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoMjAwMCk7XHJcblxyXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgICBleHBlY3QobW9ja05hdmlnYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2xvZ2luJywge1xyXG4gICAgICAgICAgc3RhdGU6IHtcclxuICAgICAgICAgICAgZW1haWxDb25maXJtZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGVtYWlsOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnRXJyb3MgZGUgdmFsaWRhw6fDo28nLCAoKSA9PiB7XHJcbiAgICBpdCgnZGV2ZSBtb3N0cmFyIGVycm8gcXVhbmRvIHRva2VuX2hhc2ggZXN0aXZlciBhdXNlbnRlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2V0Lm1vY2tJbXBsZW1lbnRhdGlvbigocGFyYW0pID0+IHtcclxuICAgICAgICBpZiAocGFyYW0gPT09ICd0eXBlJykgcmV0dXJuICdlbWFpbCc7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7IC8vIHRva2VuX2hhc2ggYXVzZW50ZVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJlbmRlcldpdGhSb3V0ZXIoPEF1dGhDYWxsYmFja1BhZ2UgLz4pO1xyXG5cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgneC1pY29uJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0Vycm8gbmEgQ29uZmlybWHDp8OjbycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnTGluayBkZSBjb25maXJtYcOnw6NvIGludsOhbGlkbycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICBleHBlY3QobW9ja1ZlcmlmeU90cCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkZXZlIG1vc3RyYXIgZXJybyBxdWFuZG8gdHlwZSBuw6NvIGZvciBcImVtYWlsXCInLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tHZXQubW9ja0ltcGxlbWVudGF0aW9uKChwYXJhbSkgPT4ge1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3Rva2VuX2hhc2gnKSByZXR1cm4gJ3Rlc3QtdG9rZW4nO1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3R5cGUnKSByZXR1cm4gJ3JlY292ZXJ5JzsgLy8gdGlwbyBlcnJhZG9cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZW5kZXJXaXRoUm91dGVyKDxBdXRoQ2FsbGJhY2tQYWdlIC8+KTtcclxuXHJcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ3gtaWNvbicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdMaW5rIGRlIGNvbmZpcm1hw6fDo28gaW52w6FsaWRvJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgIGV4cGVjdChtb2NrVmVyaWZ5T3RwKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2RldmUgbW9zdHJhciBlcnJvIHF1YW5kbyB2ZXJpZnlPdHAgZmFsaGFyJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2V0Lm1vY2tJbXBsZW1lbnRhdGlvbigocGFyYW0pID0+IHtcclxuICAgICAgICBpZiAocGFyYW0gPT09ICd0b2tlbl9oYXNoJykgcmV0dXJuICdpbnZhbGlkLXRva2VuJztcclxuICAgICAgICBpZiAocGFyYW0gPT09ICd0eXBlJykgcmV0dXJuICdlbWFpbCc7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbW9ja1ZlcmlmeU90cC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XHJcbiAgICAgICAgZGF0YTogbnVsbCxcclxuICAgICAgICBlcnJvcjogeyBtZXNzYWdlOiAnVG9rZW4gaW52w6FsaWRvJyB9LFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJlbmRlcldpdGhSb3V0ZXIoPEF1dGhDYWxsYmFja1BhZ2UgLz4pO1xyXG5cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgneC1pY29uJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1Rva2VuIGludsOhbGlkbycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2RldmUgbW9zdHJhciBtZW5zYWdlbSBlc3BlY8OtZmljYSBwYXJhIGVtYWlsIGrDoSBjb25maXJtYWRvJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2V0Lm1vY2tJbXBsZW1lbnRhdGlvbigocGFyYW0pID0+IHtcclxuICAgICAgICBpZiAocGFyYW0gPT09ICd0b2tlbl9oYXNoJykgcmV0dXJuICdhbHJlYWR5LXVzZWQtdG9rZW4nO1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3R5cGUnKSByZXR1cm4gJ2VtYWlsJztcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBtb2NrVmVyaWZ5T3RwLm1vY2tSZXNvbHZlZFZhbHVlKHtcclxuICAgICAgICBkYXRhOiBudWxsLFxyXG4gICAgICAgIGVycm9yOiB7IG1lc3NhZ2U6ICdFbWFpbCBhbHJlYWR5IGNvbmZpcm1lZCcgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZW5kZXJXaXRoUm91dGVyKDxBdXRoQ2FsbGJhY2tQYWdlIC8+KTtcclxuXHJcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdFc3RlIGVtYWlsIGrDoSBmb2kgY29uZmlybWFkbyBhbnRlcmlvcm1lbnRlLiBWb2PDqiBwb2RlIGZhemVyIGxvZ2luIG5vcm1hbG1lbnRlLicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkZXZlIG1vc3RyYXIgbWVuc2FnZW0gZXNwZWPDrWZpY2EgcGFyYSBsaW5rIGV4cGlyYWRvJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2V0Lm1vY2tJbXBsZW1lbnRhdGlvbigocGFyYW0pID0+IHtcclxuICAgICAgICBpZiAocGFyYW0gPT09ICd0b2tlbl9oYXNoJykgcmV0dXJuICdleHBpcmVkLXRva2VuJztcclxuICAgICAgICBpZiAocGFyYW0gPT09ICd0eXBlJykgcmV0dXJuICdlbWFpbCc7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbW9ja1ZlcmlmeU90cC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XHJcbiAgICAgICAgZGF0YTogbnVsbCxcclxuICAgICAgICBlcnJvcjogeyBtZXNzYWdlOiAnVG9rZW4gZXhwaXJlZCcgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZW5kZXJXaXRoUm91dGVyKDxBdXRoQ2FsbGJhY2tQYWdlIC8+KTtcclxuXHJcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdFc3RlIGxpbmsgZGUgY29uZmlybWHDp8OjbyBleHBpcm91LiBTb2xpY2l0ZSB1bSBub3ZvIGxpbmsgZGUgY29uZmlybWHDp8Ojby4nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0ludGVyYcOnw7VlcyBkbyB1c3XDoXJpbyBubyBlc3RhZG8gZGUgZXJybycsICgpID0+IHtcclxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2V0Lm1vY2tJbXBsZW1lbnRhdGlvbigocGFyYW0pID0+IHtcclxuICAgICAgICBpZiAocGFyYW0gPT09ICd0b2tlbl9oYXNoJykgcmV0dXJuICdlcnJvci10b2tlbic7XHJcbiAgICAgICAgaWYgKHBhcmFtID09PSAndHlwZScpIHJldHVybiAnZW1haWwnO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIG1vY2tWZXJpZnlPdHAubW9ja1Jlc29sdmVkVmFsdWUoe1xyXG4gICAgICAgIGRhdGE6IG51bGwsXHJcbiAgICAgICAgZXJyb3I6IHsgbWVzc2FnZTogJ0Vycm8gZ2Vuw6lyaWNvJyB9LFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJlbmRlcldpdGhSb3V0ZXIoPEF1dGhDYWxsYmFja1BhZ2UgLz4pO1xyXG5cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgneC1pY29uJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2RldmUgbmF2ZWdhciBwYXJhIGxvZ2luIGFvIGNsaWNhciBlbSBcIklyIHBhcmEgTG9naW5cIicsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgdXNlciA9IHVzZXJFdmVudC5zZXR1cCh7IGRlbGF5OiBudWxsIH0pO1xyXG4gICAgICBjb25zdCBsb2dpbkJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRleHQoJ0lyIHBhcmEgTG9naW4nKTtcclxuXHJcbiAgICAgIGF3YWl0IHVzZXIuY2xpY2sobG9naW5CdXR0b24pO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tOYXZpZ2F0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9sb2dpbicpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2RldmUgbmF2ZWdhciBwYXJhIHJlZ2lzdHJvIGFvIGNsaWNhciBlbSBcIlRlbnRhciBOb3ZhbWVudGVcIicsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgdXNlciA9IHVzZXJFdmVudC5zZXR1cCh7IGRlbGF5OiBudWxsIH0pO1xyXG4gICAgICBjb25zdCByZXRyeUJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRleHQoJ1RlbnRhciBOb3ZhbWVudGUnKTtcclxuXHJcbiAgICAgIGF3YWl0IHVzZXIuY2xpY2socmV0cnlCdXR0b24pO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tOYXZpZ2F0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9wYXJ0bmVyL3JlZ2lzdGVyJyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ01ldGFkYWRvcyBlIFNFTycsICgpID0+IHtcclxuICAgIGl0KCdkZXZlIHJlbmRlcml6YXIgbyBIZWxtZXQgY29tIHTDrXR1bG8gY29ycmV0bycsICgpID0+IHtcclxuICAgICAgbW9ja0dldC5tb2NrSW1wbGVtZW50YXRpb24oKHBhcmFtKSA9PiB7XHJcbiAgICAgICAgaWYgKHBhcmFtID09PSAndG9rZW5faGFzaCcpIHJldHVybiAndGVzdC10b2tlbic7XHJcbiAgICAgICAgaWYgKHBhcmFtID09PSAndHlwZScpIHJldHVybiAnZW1haWwnO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIG1vY2tWZXJpZnlPdHAubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IG5ldyBQcm9taXNlKCgpID0+IHt9KSk7XHJcblxyXG4gICAgICByZW5kZXJXaXRoUm91dGVyKDxBdXRoQ2FsbGJhY2tQYWdlIC8+KTtcclxuXHJcbiAgICAgIGNvbnN0IGhlbG1ldCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaGVsbWV0Jyk7XHJcbiAgICAgIGV4cGVjdChoZWxtZXQpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdDb25maXJtYcOnw6NvIGRlIEVtYWlsIC0gTWVzYSBQcmEgMicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdDb25zb2xlIGVycm9ycycsICgpID0+IHtcclxuICAgIGl0KCdkZXZlIGxvZ2FyIGVycm8gbm8gY29uc29sZSBxdWFuZG8gdmVyaWZpY2HDp8OjbyBmYWxoYXInLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNvbnNvbGVFcnJvclNweSA9IGplc3Quc3B5T24oY29uc29sZSwgJ2Vycm9yJykubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHt9KTtcclxuICAgICAgXHJcbiAgICAgIG1vY2tHZXQubW9ja0ltcGxlbWVudGF0aW9uKChwYXJhbSkgPT4ge1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3Rva2VuX2hhc2gnKSByZXR1cm4gJ2Vycm9yLXRva2VuJztcclxuICAgICAgICBpZiAocGFyYW0gPT09ICd0eXBlJykgcmV0dXJuICdlbWFpbCc7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc3QgZXJyb3IgPSB7IG1lc3NhZ2U6ICdUZXN0IGVycm9yJyB9O1xyXG4gICAgICBtb2NrVmVyaWZ5T3RwLm1vY2tSZXNvbHZlZFZhbHVlKHtcclxuICAgICAgICBkYXRhOiBudWxsLFxyXG4gICAgICAgIGVycm9yLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJlbmRlcldpdGhSb3V0ZXIoPEF1dGhDYWxsYmFja1BhZ2UgLz4pO1xyXG5cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KGNvbnNvbGVFcnJvclNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ0Vycm8gbmEgY29uZmlybWHDp8OjbzonLCBlcnJvcik7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc29sZUVycm9yU3B5Lm1vY2tSZXN0b3JlKCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7Il0sInZlcnNpb24iOjN9