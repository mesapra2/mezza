5f55fec959bcfd00f2c52bd274f11e21
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const jsx_runtime_1 = require("react/jsx-runtime");
// src/features/shared/components/events/EventPhotosUpload.jsx
const react_1 = require("react");
const prop_types_1 = tslib_1.__importDefault(require("prop-types"));
const lucide_react_1 = require("lucide-react");
const button_1 = require("@/features/shared/components/ui/button");
const EventPhotosService_1 = tslib_1.__importDefault(require("@/services/EventPhotosService"));
const use_toast_1 = require("@/features/shared/components/ui/use-toast");
const EventPhotosUpload = ({ eventId, userId, isParticipant, eventStatus }) => {
    const [uploading, setUploading] = (0, react_1.useState)(false);
    const [userPhoto, setUserPhoto] = (0, react_1.useState)(null);
    const [allPhotos, setAllPhotos] = (0, react_1.useState)([]);
    const [stats, setStats] = (0, react_1.useState)(null);
    const [deleting, setDeleting] = (0, react_1.useState)(false);
    const [loading, setLoading] = (0, react_1.useState)(true);
    const fileInputRef = (0, react_1.useRef)(null);
    const { toast } = (0, use_toast_1.useToast)();
    // Carregar foto do usuÃ¡rio e estatÃ­sticas
    const loadData = (0, react_1.useCallback)(async () => {
        try {
            setLoading(true);
            // Buscar foto do usuÃ¡rio
            const photo = await EventPhotosService_1.default.getUserPhotoForEvent(eventId, userId);
            setUserPhoto(photo);
            // Buscar todas as fotos do evento
            const photos = await EventPhotosService_1.default.getEventPhotos(eventId);
            setAllPhotos(photos || []);
            // Buscar estatÃ­sticas
            const photoStats = await EventPhotosService_1.default.getPhotoStats(eventId);
            setStats(photoStats);
        }
        catch (error) {
            console.error('Erro ao carregar dados:', error);
            // NÃ£o mostrar toast de erro no carregamento inicial para nÃ£o incomodar o usuÃ¡rio
            setAllPhotos([]);
            setStats(null);
        }
        finally {
            setLoading(false);
        }
    }, [eventId, userId]);
    (0, react_1.useEffect)(() => {
        if (eventId && userId) {
            loadData();
        }
    }, [eventId, userId, loadData]);
    const handleFileSelect = async (e) => {
        const file = e.target.files?.[0];
        if (!file)
            return;
        // ValidaÃ§Ã£o de tipo
        if (!file.type.startsWith('image/')) {
            toast({
                variant: 'destructive',
                title: 'Arquivo invÃ¡lido',
                description: 'Por favor, selecione uma imagem (JPG, PNG ou WEBP)'
            });
            return;
        }
        // ValidaÃ§Ã£o de tamanho (10MB antes do redimensionamento)
        if (file.size > 10 * 1024 * 1024) {
            toast({
                variant: 'destructive',
                title: 'Arquivo muito grande',
                description: 'O arquivo deve ter no mÃ¡ximo 10MB'
            });
            return;
        }
        setUploading(true);
        try {
            const result = await EventPhotosService_1.default.uploadEventPhoto(eventId, userId, file);
            if (result.success) {
                toast({
                    title: 'ðŸ“¸ Foto enviada!',
                    description: 'Sua foto foi adicionada ao evento com sucesso'
                });
                await loadData(); // Recarregar dados
            }
            else {
                toast({
                    variant: 'destructive',
                    title: 'Erro ao enviar foto',
                    description: result.error || 'Tente novamente'
                });
            }
        }
        catch (error) {
            console.error('Erro ao fazer upload:', error);
            toast({
                variant: 'destructive',
                title: 'Erro ao enviar foto',
                description: error.message || 'Ocorreu um erro inesperado'
            });
        }
        finally {
            setUploading(false);
            // Limpar input
            if (fileInputRef.current) {
                fileInputRef.current.value = '';
            }
        }
    };
    const handleDeletePhoto = async () => {
        if (!userPhoto)
            return;
        setDeleting(true);
        try {
            const success = await EventPhotosService_1.default.deleteEventPhoto(userPhoto.id, userId);
            if (success) {
                toast({
                    title: 'ðŸ—‘ï¸ Foto removida',
                    description: 'VocÃª pode enviar outra foto se desejar'
                });
                await loadData();
            }
            else {
                toast({
                    variant: 'destructive',
                    title: 'Erro ao remover foto',
                    description: 'Tente novamente'
                });
            }
        }
        catch (error) {
            console.error('Erro ao deletar:', error);
            toast({
                variant: 'destructive',
                title: 'Erro ao remover foto',
                description: error.message || 'Ocorreu um erro inesperado'
            });
        }
        finally {
            setDeleting(false);
        }
    };
    // NÃ£o mostrar nada se nÃ£o for participante ou se o evento nÃ£o estiver finalizado
    if (!isParticipant || eventStatus !== 'Finalizado') {
        return null;
    }
    // Mostrar loading enquanto carrega
    if (loading) {
        return ((0, jsx_runtime_1.jsx)("div", { className: "glass-effect rounded-2xl p-6 border border-white/10", children: (0, jsx_runtime_1.jsx)("div", { className: "flex items-center justify-center py-12", children: (0, jsx_runtime_1.jsx)(lucide_react_1.Loader, { className: "w-8 h-8 text-purple-500 animate-spin" }) }) }));
    }
    return ((0, jsx_runtime_1.jsxs)("div", { className: "glass-effect rounded-2xl p-6 border border-white/10", children: [(0, jsx_runtime_1.jsxs)("h2", { className: "text-xl font-semibold text-white mb-4 flex items-center gap-2", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Image, { className: "w-5 h-5" }), "\uD83D\uDCF8 Fotos do Evento"] }), stats && ((0, jsx_runtime_1.jsx)("div", { className: "mb-6 p-4 bg-purple-500/10 border border-purple-500/20 rounded-lg", children: (0, jsx_runtime_1.jsxs)("p", { className: "text-sm text-purple-300", children: [stats.totalPhotos, " de ", stats.totalParticipants, " participantes enviaram fotos", stats.percentageWithPhotos !== undefined && ` (${stats.percentageWithPhotos}%)`] }) })), (0, jsx_runtime_1.jsx)("div", { className: "mb-6", children: userPhoto ? (
                // Mostrar foto enviada
                (0, jsx_runtime_1.jsxs)("div", { className: "relative", children: [(0, jsx_runtime_1.jsxs)("div", { className: "relative rounded-lg overflow-hidden border-2 border-green-500/30", children: [(0, jsx_runtime_1.jsx)("img", { src: userPhoto.photo_url, alt: "Sua foto do evento", className: "w-full h-64 object-cover" }), (0, jsx_runtime_1.jsxs)("div", { className: "absolute top-2 right-2 bg-green-500 text-white px-3 py-1 rounded-full text-xs font-medium flex items-center gap-1", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.CheckCircle, { className: "w-3 h-3" }), "Enviada"] })] }), (0, jsx_runtime_1.jsx)(button_1.Button, { variant: "destructive", size: "sm", onClick: handleDeletePhoto, disabled: deleting, className: "mt-3 w-full", children: deleting ? ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Loader, { className: "w-4 h-4 mr-2 animate-spin" }), "Removendo..."] })) : ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Trash2, { className: "w-4 h-4 mr-2" }), "Remover Foto"] })) })] })) : (
                // Mostrar Ã¡rea de upload
                (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("input", { ref: fileInputRef, type: "file", accept: "image/jpeg,image/png,image/webp", onChange: handleFileSelect, className: "hidden", disabled: uploading }), (0, jsx_runtime_1.jsx)("button", { onClick: () => fileInputRef.current?.click(), disabled: uploading, className: "w-full border-2 border-dashed border-white/20 hover:border-purple-500/50 rounded-lg p-8 transition-all duration-300 hover:bg-purple-500/5 disabled:opacity-50 disabled:cursor-not-allowed", children: uploading ? ((0, jsx_runtime_1.jsxs)("div", { className: "flex flex-col items-center gap-3", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Loader, { className: "w-10 h-10 text-purple-500 animate-spin" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-white/70", children: "Processando e enviando foto..." })] })) : ((0, jsx_runtime_1.jsxs)("div", { className: "flex flex-col items-center gap-3", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Upload, { className: "w-10 h-10 text-white/40" }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("p", { className: "text-white font-medium mb-1", children: "Clique para enviar sua foto" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-white/60", children: "JPG, PNG ou WEBP (m\u00E1x. 2MB ap\u00F3s redimensionamento)" })] })] })) }), (0, jsx_runtime_1.jsx)("p", { className: "text-xs text-white/50 mt-3 text-center", children: "\uD83D\uDCA1 Imagens grandes ser\u00E3o redimensionadas automaticamente" })] })) }), allPhotos.length > 0 && ((0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsxs)("h3", { className: "text-lg font-semibold text-white mb-4", children: ["Galeria do Evento (", allPhotos.length, ")"] }), (0, jsx_runtime_1.jsx)("div", { className: "grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3", children: allPhotos.map((photo) => ((0, jsx_runtime_1.jsxs)("div", { className: "relative group", children: [(0, jsx_runtime_1.jsx)("div", { className: "aspect-square rounded-lg overflow-hidden border border-white/10", children: (0, jsx_runtime_1.jsx)("img", { src: photo.photo_url, alt: `Foto de ${photo.user?.username || 'Participante'}`, className: "w-full h-full object-cover group-hover:scale-110 transition-transform duration-300" }) }), (0, jsx_runtime_1.jsx)("div", { className: "absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-end p-2 rounded-lg", children: (0, jsx_runtime_1.jsx)("p", { className: "text-white text-xs font-medium truncate", children: photo.user?.username || photo.user?.full_name || 'Participante' }) })] }, photo.id))) })] })), allPhotos.length === 0 && !userPhoto && ((0, jsx_runtime_1.jsxs)("div", { className: "text-center py-8 text-white/50", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Image, { className: "w-12 h-12 mx-auto mb-3 opacity-30" }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm", children: "Seja o primeiro a compartilhar uma foto deste evento!" })] }))] }));
};
EventPhotosUpload.propTypes = {
    eventId: prop_types_1.default.number.isRequired,
    userId: prop_types_1.default.string.isRequired,
    isParticipant: prop_types_1.default.bool.isRequired,
    eventStatus: prop_types_1.default.string.isRequired
};
exports.default = EventPhotosUpload;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxmZWF0dXJlc1xcc2hhcmVkXFxjb21wb25lbnRzXFxldmVudHNcXEV2ZW50UGhvdG9VcGxvYWQuanN4IiwibWFwcGluZ3MiOiI7Ozs7QUFBQSw4REFBOEQ7QUFDOUQsaUNBQWlFO0FBQ2pFLG9FQUFtQztBQUNuQywrQ0FBdUY7QUFDdkYsbUVBQWdFO0FBQ2hFLCtGQUErRDtBQUMvRCx5RUFBcUU7QUFFckUsTUFBTSxpQkFBaUIsR0FBRyxDQUFDLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxhQUFhLEVBQUUsV0FBVyxFQUFFLEVBQUUsRUFBRTtJQUM1RSxNQUFNLENBQUMsU0FBUyxFQUFFLFlBQVksQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxLQUFLLENBQUMsQ0FBQztJQUNsRCxNQUFNLENBQUMsU0FBUyxFQUFFLFlBQVksQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxJQUFJLENBQUMsQ0FBQztJQUNqRCxNQUFNLENBQUMsU0FBUyxFQUFFLFlBQVksQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxFQUFFLENBQUMsQ0FBQztJQUMvQyxNQUFNLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxJQUFJLENBQUMsQ0FBQztJQUN6QyxNQUFNLENBQUMsUUFBUSxFQUFFLFdBQVcsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxLQUFLLENBQUMsQ0FBQztJQUNoRCxNQUFNLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxJQUFJLENBQUMsQ0FBQztJQUM3QyxNQUFNLFlBQVksR0FBRyxJQUFBLGNBQU0sRUFBQyxJQUFJLENBQUMsQ0FBQztJQUNsQyxNQUFNLEVBQUUsS0FBSyxFQUFFLEdBQUcsSUFBQSxvQkFBUSxHQUFFLENBQUM7SUFFN0IsMENBQTBDO0lBQzFDLE1BQU0sUUFBUSxHQUFHLElBQUEsbUJBQVcsRUFBQyxLQUFLLElBQUksRUFBRTtRQUN0QyxJ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QyxpQ0FBSyxTQUFTLEVBQUMsZ0NBQWdDLGFBQzdDLHVCQUFDLG9CQUFTLElBQUMsU0FBUyxFQUFDLG1DQUFtQyxHQUFHLEVBQzNELDhCQUFHLFNBQVMsRUFBQyxTQUFTLHNFQUVsQixJQUNBLENBQ1AsSUFDRyxDQUNQLENBQUM7QUFDSixDQUFDLENBQUM7QUFFRixpQkFBaUIsQ0FBQyxTQUFTLEdBQUc7SUFDNUIsT0FBTyxFQUFFLG9CQUFTLENBQUMsTUFBTSxDQUFDLFVBQVU7SUFDcEMsTUFBTSxFQUFFLG9CQUFTLENBQUMsTUFBTSxDQUFDLFVBQVU7SUFDbkMsYUFBYSxFQUFFLG9CQUFTLENBQUMsSUFBSSxDQUFDLFVBQVU7SUFDeEMsV0FBVyxFQUFFLG9CQUFTLENBQUMsTUFBTSxDQUFDLFVBQVU7Q0FDekMsQ0FBQztBQUVGLGtCQUFlLGlCQUFpQixDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxERVZNaXhcXEFwcC5NZXNhcHJhMi5jb21cXHNyY1xcZmVhdHVyZXNcXHNoYXJlZFxcY29tcG9uZW50c1xcZXZlbnRzXFxFdmVudFBob3RvVXBsb2FkLmpzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvZmVhdHVyZXMvc2hhcmVkL2NvbXBvbmVudHMvZXZlbnRzL0V2ZW50UGhvdG9zVXBsb2FkLmpzeFxyXG5pbXBvcnQgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0LCB1c2VSZWYsIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xyXG5pbXBvcnQgeyBVcGxvYWQsIFRyYXNoMiwgTG9hZGVyLCBDaGVja0NpcmNsZSwgSW1hZ2UgYXMgSW1hZ2VJY29uIH0gZnJvbSAnbHVjaWRlLXJlYWN0JztcclxuaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAnQC9mZWF0dXJlcy9zaGFyZWQvY29tcG9uZW50cy91aS9idXR0b24nO1xyXG5pbXBvcnQgRXZlbnRQaG90b3NTZXJ2aWNlIGZyb20gJ0Avc2VydmljZXMvRXZlbnRQaG90b3NTZXJ2aWNlJztcclxuaW1wb3J0IHsgdXNlVG9hc3QgfSBmcm9tICdAL2ZlYXR1cmVzL3NoYXJlZC9jb21wb25lbnRzL3VpL3VzZS10b2FzdCc7XHJcblxyXG5jb25zdCBFdmVudFBob3Rvc1VwbG9hZCA9ICh7IGV2ZW50SWQsIHVzZXJJZCwgaXNQYXJ0aWNpcGFudCwgZXZlbnRTdGF0dXMgfSkgPT4ge1xyXG4gIGNvbnN0IFt1cGxvYWRpbmcsIHNldFVwbG9hZGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XHJcbiAgY29uc3QgW3VzZXJQaG90bywgc2V0VXNlclBob3RvXSA9IHVzZVN0YXRlKG51bGwpO1xyXG4gIGNvbnN0IFthbGxQaG90b3MsIHNldEFsbFBob3Rvc10gPSB1c2VTdGF0ZShbXSk7XHJcbiAgY29uc3QgW3N0YXRzLCBzZXRTdGF0c10gPSB1c2VTdGF0ZShudWxsKTtcclxuICBjb25zdCBbZGVsZXRpbmcsIHNldERlbGV0aW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICBjb25zdCBbbG9hZGluZywgc2V0TG9hZGluZ10gPSB1c2VTdGF0ZSh0cnVlKTtcclxuICBjb25zdCBmaWxlSW5wdXRSZWYgPSB1c2VSZWYobnVsbCk7XHJcbiAgY29uc3QgeyB0b2FzdCB9ID0gdXNlVG9hc3QoKTtcclxuXHJcbiAgLy8gQ2FycmVnYXIgZm90byBkbyB1c3XDoXJpbyBlIGVzdGF0w61zdGljYXNcclxuICBjb25zdCBsb2FkRGF0YSA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIHNldExvYWRpbmcodHJ1ZSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBCdXNjYXIgZm90byBkbyB1c3XDoXJpb1xyXG4gICAgICBjb25zdCBwaG90byA9IGF3YWl0IEV2ZW50UGhvdG9zU2VydmljZS5nZXRVc2VyUGhvdG9Gb3JFdmVudChldmVudElkLCB1c2VySWQpO1xyXG4gICAgICBzZXRVc2VyUGhvdG8ocGhvdG8pO1xyXG5cclxuICAgICAgLy8gQnVzY2FyIHRvZGFzIGFzIGZvdG9zIGRvIGV2ZW50b1xyXG4gICAgICBjb25zdCBwaG90b3MgPSBhd2FpdCBFdmVudFBob3Rvc1NlcnZpY2UuZ2V0RXZlbnRQaG90b3MoZXZlbnRJZCk7XHJcbiAgICAgIHNldEFsbFBob3RvcyhwaG90b3MgfHwgW10pO1xyXG5cclxuICAgICAgLy8gQnVzY2FyIGVzdGF0w61zdGljYXNcclxuICAgICAgY29uc3QgcGhvdG9TdGF0cyA9IGF3YWl0IEV2ZW50UGhvdG9zU2VydmljZS5nZXRQaG90b1N0YXRzKGV2ZW50SWQpO1xyXG4gICAgICBzZXRTdGF0cyhwaG90b1N0YXRzKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gYW8gY2FycmVnYXIgZGFkb3M6JywgZXJyb3IpO1xyXG4gICAgICAvLyBOw6NvIG1vc3RyYXIgdG9hc3QgZGUgZXJybyBubyBjYXJyZWdhbWVudG8gaW5pY2lhbCBwYXJhIG7Do28gaW5jb21vZGFyIG8gdXN1w6FyaW9cclxuICAgICAgc2V0QWxsUGhvdG9zKFtdKTtcclxuICAgICAgc2V0U3RhdHMobnVsbCk7XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICBzZXRMb2FkaW5nKGZhbHNlKTtcclxuICAgIH1cclxuICB9LCBbZXZlbnRJZCwgdXNlcklkXSk7XHJcblxyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBpZiAoZXZlbnRJZCAmJiB1c2VySWQpIHtcclxuICAgICAgbG9hZERhdGEoKTtcclxuICAgIH1cclxuICB9LCBbZXZlbnRJZCwgdXNlcklkLCBsb2FkRGF0YV0pO1xyXG5cclxuICBjb25zdCBoYW5kbGVGaWxlU2VsZWN0ID0gYXN5bmMgKGUpID0+IHtcclxuICAgIGNvbnN0IGZpbGUgPSBlLnRhcmdldC5maWxlcz8uWzBdO1xyXG4gICAgaWYgKCFmaWxlKSByZXR1cm47XHJcblxyXG4gICAgLy8gVmFsaWRhw6fDo28gZGUgdGlwb1xyXG4gICAgaWYgKCFmaWxlLnR5cGUuc3RhcnRzV2l0aCgnaW1hZ2UvJykpIHtcclxuICAgICAgdG9hc3Qoe1xyXG4gICAgICAgIHZhcmlhbnQ6ICdkZXN0cnVjdGl2ZScsXHJcbiAgICAgICAgdGl0bGU6ICdBcnF1aXZvIGludsOhbGlkbycsXHJcbiAgICAgICAgZGVzY3JpcHRpb246ICdQb3IgZmF2b3IsIHNlbGVjaW9uZSB1bWEgaW1hZ2VtIChKUEcsIFBORyBvdSBXRUJQKSdcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBWYWxpZGHDp8OjbyBkZSB0YW1hbmhvICgxME1CIGFudGVzIGRvIHJlZGltZW5zaW9uYW1lbnRvKVxyXG4gICAgaWYgKGZpbGUuc2l6ZSA+IDEwICogMTAyNCAqIDEwMjQpIHtcclxuICAgICAgdG9hc3Qoe1xyXG4gICAgICAgIHZhcmlhbnQ6ICdkZXN0cnVjdGl2ZScsXHJcbiAgICAgICAgdGl0bGU6ICdBcnF1aXZvIG11aXRvIGdyYW5kZScsXHJcbiAgICAgICAgZGVzY3JpcHRpb246ICdPIGFycXVpdm8gZGV2ZSB0ZXIgbm8gbcOheGltbyAxME1CJ1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFVwbG9hZGluZyh0cnVlKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBFdmVudFBob3Rvc1NlcnZpY2UudXBsb2FkRXZlbnRQaG90byhldmVudElkLCB1c2VySWQsIGZpbGUpO1xyXG5cclxuICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgICAgdG9hc3Qoe1xyXG4gICAgICAgICAgdGl0bGU6ICfwn5O4IEZvdG8gZW52aWFkYSEnLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdTdWEgZm90byBmb2kgYWRpY2lvbmFkYSBhbyBldmVudG8gY29tIHN1Y2Vzc28nXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgYXdhaXQgbG9hZERhdGEoKTsgLy8gUmVjYXJyZWdhciBkYWRvc1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRvYXN0KHtcclxuICAgICAgICAgIHZhcmlhbnQ6ICdkZXN0cnVjdGl2ZScsXHJcbiAgICAgICAgICB0aXRsZTogJ0Vycm8gYW8gZW52aWFyIGZvdG8nLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IHJlc3VsdC5lcnJvciB8fCAnVGVudGUgbm92YW1lbnRlJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvIGFvIGZhemVyIHVwbG9hZDonLCBlcnJvcik7XHJcbiAgICAgIHRvYXN0KHtcclxuICAgICAgICB2YXJpYW50OiAnZGVzdHJ1Y3RpdmUnLFxyXG4gICAgICAgIHRpdGxlOiAnRXJybyBhbyBlbnZpYXIgZm90bycsXHJcbiAgICAgICAgZGVzY3JpcHRpb246IGVycm9yLm1lc3NhZ2UgfHwgJ09jb3JyZXUgdW0gZXJybyBpbmVzcGVyYWRvJ1xyXG4gICAgICB9KTtcclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgIHNldFVwbG9hZGluZyhmYWxzZSk7XHJcbiAgICAgIC8vIExpbXBhciBpbnB1dFxyXG4gICAgICBpZiAoZmlsZUlucHV0UmVmLmN1cnJlbnQpIHtcclxuICAgICAgICBmaWxlSW5wdXRSZWYuY3VycmVudC52YWx1ZSA9ICcnO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlRGVsZXRlUGhvdG8gPSBhc3luYyAoKSA9PiB7XHJcbiAgICBpZiAoIXVzZXJQaG90bykgcmV0dXJuO1xyXG5cclxuICAgIHNldERlbGV0aW5nKHRydWUpO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHN1Y2Nlc3MgPSBhd2FpdCBFdmVudFBob3Rvc1NlcnZpY2UuZGVsZXRlRXZlbnRQaG90byh1c2VyUGhvdG8uaWQsIHVzZXJJZCk7XHJcblxyXG4gICAgICBpZiAoc3VjY2Vzcykge1xyXG4gICAgICAgIHRvYXN0KHtcclxuICAgICAgICAgIHRpdGxlOiAn8J+Xke+4jyBGb3RvIHJlbW92aWRhJyxcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnVm9jw6ogcG9kZSBlbnZpYXIgb3V0cmEgZm90byBzZSBkZXNlamFyJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGF3YWl0IGxvYWREYXRhKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdG9hc3Qoe1xyXG4gICAgICAgICAgdmFyaWFudDogJ2Rlc3RydWN0aXZlJyxcclxuICAgICAgICAgIHRpdGxlOiAnRXJybyBhbyByZW1vdmVyIGZvdG8nLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdUZW50ZSBub3ZhbWVudGUnXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gYW8gZGVsZXRhcjonLCBlcnJvcik7XHJcbiAgICAgIHRvYXN0KHtcclxuICAgICAgICB2YXJpYW50OiAnZGVzdHJ1Y3RpdmUnLFxyXG4gICAgICAgIHRpdGxlOiAnRXJybyBhbyByZW1vdmVyIGZvdG8nLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiBlcnJvci5tZXNzYWdlIHx8ICdPY29ycmV1IHVtIGVycm8gaW5lc3BlcmFkbydcclxuICAgICAgfSk7XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICBzZXREZWxldGluZyhmYWxzZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgLy8gTsOjbyBtb3N0cmFyIG5hZGEgc2UgbsOjbyBmb3IgcGFydGljaXBhbnRlIG91IHNlIG8gZXZlbnRvIG7Do28gZXN0aXZlciBmaW5hbGl6YWRvXHJcbiAgaWYgKCFpc1BhcnRpY2lwYW50IHx8IGV2ZW50U3RhdHVzICE9PSAnRmluYWxpemFkbycpIHtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgLy8gTW9zdHJhciBsb2FkaW5nIGVucXVhbnRvIGNhcnJlZ2FcclxuICBpZiAobG9hZGluZykge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJnbGFzcy1lZmZlY3Qgcm91bmRlZC0yeGwgcC02IGJvcmRlciBib3JkZXItd2hpdGUvMTBcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHB5LTEyXCI+XHJcbiAgICAgICAgICA8TG9hZGVyIGNsYXNzTmFtZT1cInctOCBoLTggdGV4dC1wdXJwbGUtNTAwIGFuaW1hdGUtc3BpblwiIC8+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHJldHVybiAoXHJcbiAgICA8ZGl2IGNsYXNzTmFtZT1cImdsYXNzLWVmZmVjdCByb3VuZGVkLTJ4bCBwLTYgYm9yZGVyIGJvcmRlci13aGl0ZS8xMFwiPlxyXG4gICAgICA8aDIgY2xhc3NOYW1lPVwidGV4dC14bCBmb250LXNlbWlib2xkIHRleHQtd2hpdGUgbWItNCBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMlwiPlxyXG4gICAgICAgIDxJbWFnZUljb24gY2xhc3NOYW1lPVwidy01IGgtNVwiIC8+XHJcbiAgICAgICAg8J+TuCBGb3RvcyBkbyBFdmVudG9cclxuICAgICAgPC9oMj5cclxuXHJcbiAgICAgIHsvKiBFc3RhdMOtc3RpY2FzICovfVxyXG4gICAgICB7c3RhdHMgJiYgKFxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWItNiBwLTQgYmctcHVycGxlLTUwMC8xMCBib3JkZXIgYm9yZGVyLXB1cnBsZS01MDAvMjAgcm91bmRlZC1sZ1wiPlxyXG4gICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LXB1cnBsZS0zMDBcIj5cclxuICAgICAgICAgICAge3N0YXRzLnRvdGFsUGhvdG9zfSBkZSB7c3RhdHMudG90YWxQYXJ0aWNpcGFudHN9IHBhcnRpY2lwYW50ZXMgZW52aWFyYW0gZm90b3NcclxuICAgICAgICAgICAge3N0YXRzLnBlcmNlbnRhZ2VXaXRoUGhvdG9zICE9PSB1bmRlZmluZWQgJiYgYCAoJHtzdGF0cy5wZXJjZW50YWdlV2l0aFBob3Rvc30lKWB9XHJcbiAgICAgICAgICA8L3A+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICl9XHJcblxyXG4gICAgICB7Lyogw4FyZWEgZGUgVXBsb2FkIC8gRm90byBkbyBVc3XDoXJpbyAqL31cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJtYi02XCI+XHJcbiAgICAgICAge3VzZXJQaG90byA/IChcclxuICAgICAgICAgIC8vIE1vc3RyYXIgZm90byBlbnZpYWRhXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJlbGF0aXZlXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicmVsYXRpdmUgcm91bmRlZC1sZyBvdmVyZmxvdy1oaWRkZW4gYm9yZGVyLTIgYm9yZGVyLWdyZWVuLTUwMC8zMFwiPlxyXG4gICAgICAgICAgICAgIDxpbWdcclxuICAgICAgICAgICAgICAgIHNyYz17dXNlclBob3RvLnBob3RvX3VybH1cclxuICAgICAgICAgICAgICAgIGFsdD1cIlN1YSBmb3RvIGRvIGV2ZW50b1wiXHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LWZ1bGwgaC02NCBvYmplY3QtY292ZXJcIlxyXG4gICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhYnNvbHV0ZSB0b3AtMiByaWdodC0yIGJnLWdyZWVuLTUwMCB0ZXh0LXdoaXRlIHB4LTMgcHktMSByb3VuZGVkLWZ1bGwgdGV4dC14cyBmb250LW1lZGl1bSBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMVwiPlxyXG4gICAgICAgICAgICAgICAgPENoZWNrQ2lyY2xlIGNsYXNzTmFtZT1cInctMyBoLTNcIiAvPlxyXG4gICAgICAgICAgICAgICAgRW52aWFkYVxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIDxCdXR0b25cclxuICAgICAgICAgICAgICB2YXJpYW50PVwiZGVzdHJ1Y3RpdmVcIlxyXG4gICAgICAgICAgICAgIHNpemU9XCJzbVwiXHJcbiAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlRGVsZXRlUGhvdG99XHJcbiAgICAgICAgICAgICAgZGlzYWJsZWQ9e2RlbGV0aW5nfVxyXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm10LTMgdy1mdWxsXCJcclxuICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgIHtkZWxldGluZyA/IChcclxuICAgICAgICAgICAgICAgIDw+XHJcbiAgICAgICAgICAgICAgICAgIDxMb2FkZXIgY2xhc3NOYW1lPVwidy00IGgtNCBtci0yIGFuaW1hdGUtc3BpblwiIC8+XHJcbiAgICAgICAgICAgICAgICAgIFJlbW92ZW5kby4uLlxyXG4gICAgICAgICAgICAgICAgPC8+XHJcbiAgICAgICAgICAgICAgKSA6IChcclxuICAgICAgICAgICAgICAgIDw+XHJcbiAgICAgICAgICAgICAgICAgIDxUcmFzaDIgY2xhc3NOYW1lPVwidy00IGgtNCBtci0yXCIgLz5cclxuICAgICAgICAgICAgICAgICAgUmVtb3ZlciBGb3RvXHJcbiAgICAgICAgICAgICAgICA8Lz5cclxuICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICkgOiAoXHJcbiAgICAgICAgICAvLyBNb3N0cmFyIMOhcmVhIGRlIHVwbG9hZFxyXG4gICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgPGlucHV0XHJcbiAgICAgICAgICAgICAgcmVmPXtmaWxlSW5wdXRSZWZ9XHJcbiAgICAgICAgICAgICAgdHlwZT1cImZpbGVcIlxyXG4gICAgICAgICAgICAgIGFjY2VwdD1cImltYWdlL2pwZWcsaW1hZ2UvcG5nLGltYWdlL3dlYnBcIlxyXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtoYW5kbGVGaWxlU2VsZWN0fVxyXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cImhpZGRlblwiXHJcbiAgICAgICAgICAgICAgZGlzYWJsZWQ9e3VwbG9hZGluZ31cclxuICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIDxidXR0b25cclxuICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBmaWxlSW5wdXRSZWYuY3VycmVudD8uY2xpY2soKX1cclxuICAgICAgICAgICAgICBkaXNhYmxlZD17dXBsb2FkaW5nfVxyXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctZnVsbCBib3JkZXItMiBib3JkZXItZGFzaGVkIGJvcmRlci13aGl0ZS8yMCBob3Zlcjpib3JkZXItcHVycGxlLTUwMC81MCByb3VuZGVkLWxnIHAtOCB0cmFuc2l0aW9uLWFsbCBkdXJhdGlvbi0zMDAgaG92ZXI6YmctcHVycGxlLTUwMC81IGRpc2FibGVkOm9wYWNpdHktNTAgZGlzYWJsZWQ6Y3Vyc29yLW5vdC1hbGxvd2VkXCJcclxuICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgIHt1cGxvYWRpbmcgPyAoXHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZmxleC1jb2wgaXRlbXMtY2VudGVyIGdhcC0zXCI+XHJcbiAgICAgICAgICAgICAgICAgIDxMb2FkZXIgY2xhc3NOYW1lPVwidy0xMCBoLTEwIHRleHQtcHVycGxlLTUwMCBhbmltYXRlLXNwaW5cIiAvPlxyXG4gICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtd2hpdGUvNzBcIj5cclxuICAgICAgICAgICAgICAgICAgICBQcm9jZXNzYW5kbyBlIGVudmlhbmRvIGZvdG8uLi5cclxuICAgICAgICAgICAgICAgICAgPC9wPlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgKSA6IChcclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBmbGV4LWNvbCBpdGVtcy1jZW50ZXIgZ2FwLTNcIj5cclxuICAgICAgICAgICAgICAgICAgPFVwbG9hZCBjbGFzc05hbWU9XCJ3LTEwIGgtMTAgdGV4dC13aGl0ZS80MFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC13aGl0ZSBmb250LW1lZGl1bSBtYi0xXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICBDbGlxdWUgcGFyYSBlbnZpYXIgc3VhIGZvdG9cclxuICAgICAgICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LXdoaXRlLzYwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICBKUEcsIFBORyBvdSBXRUJQIChtw6F4LiAyTUIgYXDDs3MgcmVkaW1lbnNpb25hbWVudG8pXHJcbiAgICAgICAgICAgICAgICAgICAgPC9wPlxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgIDwvYnV0dG9uPlxyXG5cclxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC14cyB0ZXh0LXdoaXRlLzUwIG10LTMgdGV4dC1jZW50ZXJcIj5cclxuICAgICAgICAgICAgICDwn5KhIEltYWdlbnMgZ3JhbmRlcyBzZXLDo28gcmVkaW1lbnNpb25hZGFzIGF1dG9tYXRpY2FtZW50ZVxyXG4gICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICApfVxyXG4gICAgICA8L2Rpdj5cclxuXHJcbiAgICAgIHsvKiBHYWxlcmlhIGRlIEZvdG9zIGRlIFRvZG9zIG9zIFBhcnRpY2lwYW50ZXMgKi99XHJcbiAgICAgIHthbGxQaG90b3MubGVuZ3RoID4gMCAmJiAoXHJcbiAgICAgICAgPGRpdj5cclxuICAgICAgICAgIDxoMyBjbGFzc05hbWU9XCJ0ZXh0LWxnIGZvbnQtc2VtaWJvbGQgdGV4dC13aGl0ZSBtYi00XCI+XHJcbiAgICAgICAgICAgIEdhbGVyaWEgZG8gRXZlbnRvICh7YWxsUGhvdG9zLmxlbmd0aH0pXHJcbiAgICAgICAgICA8L2gzPlxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdyaWQgZ3JpZC1jb2xzLTIgbWQ6Z3JpZC1jb2xzLTMgbGc6Z3JpZC1jb2xzLTQgZ2FwLTNcIj5cclxuICAgICAgICAgICAge2FsbFBob3Rvcy5tYXAoKHBob3RvKSA9PiAoXHJcbiAgICAgICAgICAgICAgPGRpdiBrZXk9e3Bob3RvLmlkfSBjbGFzc05hbWU9XCJyZWxhdGl2ZSBncm91cFwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhc3BlY3Qtc3F1YXJlIHJvdW5kZWQtbGcgb3ZlcmZsb3ctaGlkZGVuIGJvcmRlciBib3JkZXItd2hpdGUvMTBcIj5cclxuICAgICAgICAgICAgICAgICAgPGltZ1xyXG4gICAgICAgICAgICAgICAgICAgIHNyYz17cGhvdG8ucGhvdG9fdXJsfVxyXG4gICAgICAgICAgICAgICAgICAgIGFsdD17YEZvdG8gZGUgJHtwaG90by51c2VyPy51c2VybmFtZSB8fCAnUGFydGljaXBhbnRlJ31gfVxyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctZnVsbCBoLWZ1bGwgb2JqZWN0LWNvdmVyIGdyb3VwLWhvdmVyOnNjYWxlLTExMCB0cmFuc2l0aW9uLXRyYW5zZm9ybSBkdXJhdGlvbi0zMDBcIlxyXG4gICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHsvKiBPdmVybGF5IGNvbSBub21lIGRvIHVzdcOhcmlvICovfVxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhYnNvbHV0ZSBpbnNldC0wIGJnLWJsYWNrLzYwIG9wYWNpdHktMCBncm91cC1ob3ZlcjpvcGFjaXR5LTEwMCB0cmFuc2l0aW9uLW9wYWNpdHkgZmxleCBpdGVtcy1lbmQgcC0yIHJvdW5kZWQtbGdcIj5cclxuICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC13aGl0ZSB0ZXh0LXhzIGZvbnQtbWVkaXVtIHRydW5jYXRlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAge3Bob3RvLnVzZXI/LnVzZXJuYW1lIHx8IHBob3RvLnVzZXI/LmZ1bGxfbmFtZSB8fCAnUGFydGljaXBhbnRlJ31cclxuICAgICAgICAgICAgICAgICAgPC9wPlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICkpfVxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICl9XHJcblxyXG4gICAgICB7LyogTWVuc2FnZW0gcXVhbmRvIG5pbmd1w6ltIGVudmlvdSBmb3RvcyBhaW5kYSAqL31cclxuICAgICAge2FsbFBob3Rvcy5sZW5ndGggPT09IDAgJiYgIXVzZXJQaG90byAmJiAoXHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LWNlbnRlciBweS04IHRleHQtd2hpdGUvNTBcIj5cclxuICAgICAgICAgIDxJbWFnZUljb24gY2xhc3NOYW1lPVwidy0xMiBoLTEyIG14LWF1dG8gbWItMyBvcGFjaXR5LTMwXCIgLz5cclxuICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc21cIj5cclxuICAgICAgICAgICAgU2VqYSBvIHByaW1laXJvIGEgY29tcGFydGlsaGFyIHVtYSBmb3RvIGRlc3RlIGV2ZW50byFcclxuICAgICAgICAgIDwvcD5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgKX1cclxuICAgIDwvZGl2PlxyXG4gICk7XHJcbn07XHJcblxyXG5FdmVudFBob3Rvc1VwbG9hZC5wcm9wVHlwZXMgPSB7XHJcbiAgZXZlbnRJZDogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxyXG4gIHVzZXJJZDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxyXG4gIGlzUGFydGljaXBhbnQ6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXHJcbiAgZXZlbnRTdGF0dXM6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZFxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgRXZlbnRQaG90b3NVcGxvYWQ7Il0sInZlcnNpb24iOjN9