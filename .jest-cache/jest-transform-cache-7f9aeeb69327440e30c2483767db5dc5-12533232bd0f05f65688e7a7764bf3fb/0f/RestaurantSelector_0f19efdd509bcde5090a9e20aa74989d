c622125389ea9054ac67382ee6236670
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = tslib_1.__importStar(require("react"));
const lucide_react_1 = require("lucide-react");
const supabaseClient_1 = require("@/lib/supabaseClient");
const label_1 = require("@/features/shared/components/ui/label");
const input_1 = require("@/features/shared/components/ui/input");
const RestaurantSelector = ({ value, onChange, eventType }) => {
    const [partners, setPartners] = (0, react_1.useState)([]);
    const [loading, setLoading] = (0, react_1.useState)(true);
    const [searchTerm, setSearchTerm] = (0, react_1.useState)('');
    const [selectedPartner, setSelectedPartner] = (0, react_1.useState)(null);
    (0, react_1.useEffect)(() => {
        loadPartners();
    }, []);
    (0, react_1.useEffect)(() => {
        if (value && partners.length > 0) {
            const partner = partners.find(p => p.id === value);
            setSelectedPartner(partner);
        }
    }, [value, partners]);
    const loadPartners = async () => {
        setLoading(true);
        try {
            // âœ… BUSCA TODOS OS RESTAURANTES ATIVOS
            const { data, error } = await supabaseClient_1.supabase
                .from('partners')
                .select('*')
                .order('name', { ascending: true });
            if (error) {
                console.error('âŒ Erro SQL:', error);
                throw error;
            }
            console.log('âœ… Total de restaurantes no banco:', data?.length || 0);
            console.log('ðŸ“‹ Restaurantes:', data);
            // Filtra apenas os ativos no frontend (mais seguro)
            const activePartners = data?.filter(p => {
                // Aceita diferentes variaÃ§Ãµes de campos de status
                return p.status === 'ativo' ||
                    p.status === 'active' ||
                    p.is_active === true ||
                    p.active === true ||
                    !p.status; // Se nÃ£o tiver campo status, inclui
            }) || [];
            console.log('âœ… Restaurantes ativos:', activePartners.length);
            setPartners(activePartners);
        }
        catch (error) {
            console.error('âŒ Erro ao carregar restaurantes:', error);
            setPartners([]); // Garante array vazio em caso de erro
        }
        finally {
            setLoading(false);
        }
    };
    const handleSelect = (partner) => {
        setSelectedPartner(partner);
        onChange(partner.id);
    };
    const handleClear = () => {
        setSelectedPartner(null);
        onChange(null);
    };
    const getAddress = (partner) => {
        if (!partner.address)
            return null;
        if (typeof partner.address === 'string') {
            return partner.address;
        }
        if (typeof partner.address === 'object') {
            if (partner.address.text)
                return partner.address.text;
            const parts = [
                partner.address.street || partner.address.rua,
                partner.address.number || partner.address.numero,
                partner.address.city || partner.address.cidade,
            ].filter(Boolean);
            return parts.length > 0 ? parts.join(', ') : null;
        }
        return null;
    };
    const filteredPartners = partners.filter(partner => {
        const searchLower = searchTerm.toLowerCase();
        const address = getAddress(partner);
        return (partner.name?.toLowerCase().includes(searchLower) ||
            partner.contact_name?.toLowerCase().includes(searchLower) ||
            partner.description?.toLowerCase().includes(searchLower) ||
            address?.toLowerCase().includes(searchLower));
    });
    if (eventType === 'institucional') {
        return null;
    }
    return ((0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsxs)(label_1.Label, { htmlFor: "partner", children: ["Restaurante ", eventType === 'padrao' && (0, jsx_runtime_1.jsx)("span", { className: "text-red-400", children: "*" })] }), (0, jsx_runtime_1.jsxs)("button", { type: "button", onClick: loadPartners, disabled: loading, className: "text-purple-400 hover:text-purple-300 text-sm flex items-center gap-1 disabled:opacity-50", title: "Recarregar restaurantes", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.RefreshCw, { className: `w-4 h-4 ${loading ? 'animate-spin' : ''}` }), "Atualizar"] })] }), selectedPartner ? ((0, jsx_runtime_1.jsx)("div", { className: "glass-effect rounded-lg p-4 border border-white/10", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-start justify-between", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex-1", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2 mb-1", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Store, { className: "w-4 h-4 text-purple-400" }), (0, jsx_runtime_1.jsx)("h4", { className: "text-white font-semibold", children: selectedPartner.name }), selectedPartner.type === 'premium' && ((0, jsx_runtime_1.jsx)("span", { className: "text-xs bg-gradient-to-r from-purple-500 to-pink-500 px-2 py-0.5 rounded-full", children: "Premium" }))] }), selectedPartner.contact_name && ((0, jsx_runtime_1.jsx)("p", { className: "text-white/50 text-xs mb-2", children: selectedPartner.contact_name })), selectedPartner.description && ((0, jsx_runtime_1.jsx)("p", { className: "text-white/60 text-sm mb-2 line-clamp-2", children: selectedPartner.description })), getAddress(selectedPartner) && ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-start gap-2 text-white/60 text-sm", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.MapPin, { className: "w-3 h-3 mt-1 flex-shrink-0" }), (0, jsx_runtime_1.jsx)("p", { children: getAddress(selectedPartner) })] })), selectedPartner.phone && ((0, jsx_runtime_1.jsxs)("p", { className: "text-white/40 text-xs mt-1", children: ["Tel: ", selectedPartner.phone] }))] }), (0, jsx_runtime_1.jsx)("button", { type: "button", onClick: handleClear, className: "text-red-400 hover:text-red-300 text-sm", children: "Alterar" })] }) })) : ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsxs)("div", { className: "relative", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Search, { className: "absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-white/40" }), (0, jsx_runtime_1.jsx)(input_1.Input, { type: "text", placeholder: "Buscar restaurante...", value: searchTerm, onChange: (e) => setSearchTerm(e.target.value), className: "pl-10 glass-effect border-white/10" })] }), (0, jsx_runtime_1.jsx)("div", { className: "glass-effect rounded-lg border border-white/10 max-h-64 overflow-y-auto", children: loading ? ((0, jsx_runtime_1.jsx)("div", { className: "flex items-center justify-center p-8", children: (0, jsx_runtime_1.jsx)(lucide_react_1.Loader, { className: "w-6 h-6 text-white/40 animate-spin" }) })) : filteredPartners.length === 0 ? ((0, jsx_runtime_1.jsxs)("div", { className: "flex flex-col items-center justify-center p-8 text-center", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.AlertCircle, { className: "w-12 h-12 text-white/20 mb-2" }), (0, jsx_runtime_1.jsx)("p", { className: "text-white/60 text-sm", children: searchTerm ? 'Nenhum restaurante encontrado' : 'Nenhum restaurante disponÃ­vel' }), !searchTerm && partners.length === 0 && ((0, jsx_runtime_1.jsxs)("p", { className: "text-white/40 text-xs mt-2", children: ["Total no banco: ", partners.length, " restaurantes"] }))] })) : ((0, jsx_runtime_1.jsx)("div", { className: "divide-y divide-white/10", children: filteredPartners.map((partner) => {
                                const address = getAddress(partner);
                                return ((0, jsx_runtime_1.jsx)("button", { type: "button", onClick: () => handleSelect(partner), className: "w-full text-left p-4 hover:bg-white/5 transition-colors", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-start gap-3", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Store, { className: "w-5 h-5 text-purple-400 mt-1 flex-shrink-0" }), (0, jsx_runtime_1.jsxs)("div", { className: "flex-1 min-w-0", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2 mb-1", children: [(0, jsx_runtime_1.jsx)("h4", { className: "text-white font-medium", children: partner.name }), partner.type === 'premium' && ((0, jsx_runtime_1.jsx)("span", { className: "text-xs bg-gradient-to-r from-purple-500 to-pink-500 px-2 py-0.5 rounded-full", children: "Premium" }))] }), partner.contact_name && ((0, jsx_runtime_1.jsx)("p", { className: "text-white/50 text-xs mb-1", children: partner.contact_name })), partner.description && ((0, jsx_runtime_1.jsx)("p", { className: "text-white/60 text-sm mb-1 line-clamp-1", children: partner.description })), address && ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-start gap-1 text-white/60 text-sm mb-1", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.MapPin, { className: "w-3 h-3 mt-1 flex-shrink-0" }), (0, jsx_runtime_1.jsx)("p", { className: "truncate", children: address })] })), partner.phone && ((0, jsx_runtime_1.jsxs)("p", { className: "text-white/40 text-xs", children: ["Tel: ", partner.phone] }))] })] }) }, partner.id));
                            }) })) }), eventType === 'particular' && ((0, jsx_runtime_1.jsx)("p", { className: "text-white/40 text-xs", children: "Dica: Voc\u00EA pode criar o evento sem selecionar um restaurante e informar o local manualmente." })), eventType === 'padrao' && ((0, jsx_runtime_1.jsxs)("p", { className: "text-yellow-300 text-xs flex items-center gap-1", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.AlertCircle, { className: "w-3 h-3" }), "Eventos padr\u00E3o devem ser realizados em restaurantes credenciados"] }))] }))] }));
};
exports.default = RestaurantSelector;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxmZWF0dXJlc1xcc2hhcmVkXFxjb21wb25lbnRzXFx1aVxcUmVzdGF1cmFudFNlbGVjdG9yLmpzeCIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsdURBQW1EO0FBQ25ELCtDQUFxRjtBQUNyRix5REFBZ0Q7QUFDaEQsaUVBQThEO0FBQzlELGlFQUE4RDtBQUU5RCxNQUFNLGtCQUFrQixHQUFHLENBQUMsRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxFQUFFLEVBQUU7SUFDNUQsTUFBTSxDQUFDLFFBQVEsRUFBRSxXQUFXLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsRUFBRSxDQUFDLENBQUM7SUFDN0MsTUFBTSxDQUFDLE9BQU8sRUFBRSxVQUFVLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsSUFBSSxDQUFDLENBQUM7SUFDN0MsTUFBTSxDQUFDLFVBQVUsRUFBRSxhQUFhLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsRUFBRSxDQUFDLENBQUM7SUFDakQsTUFBTSxDQUFDLGVBQWUsRUFBRSxrQkFBa0IsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxJQUFJLENBQUMsQ0FBQztJQUU3RCxJQUFBLGlCQUFTLEVBQUMsR0FBRyxFQUFFO1FBQ2IsWUFBWSxFQUFFLENBQUM7SUFDakIsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBRVAsSUFBQSxpQkFBUyxFQUFDLEdBQUcsRUFBRTtRQUNiLElBQUksS0FBSyxJQUFJLFFBQVEsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7WUFDakMsTUFBTSxPQUFPLEdBQUcsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssS0FBSyxDQUFDLENBQUM7WUFDbkQsa0JBQWtCLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDOUIsQ0FBQztJQUNILENBQUMsRUFBRSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQyxD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QUssSUFBSyxDQUM5RCxJQUNHLElBQ0YsSUFsQ0QsT0FBTyxDQUFDLEVBQUUsQ0FtQ1IsQ0FDVixDQUFDOzRCQUNKLENBQUMsQ0FBQyxHQUNFLENBQ1AsR0FDRyxFQUVMLFNBQVMsS0FBSyxZQUFZLElBQUksQ0FDN0IsOEJBQUcsU0FBUyxFQUFDLHVCQUF1QixrSEFFaEMsQ0FDTCxFQUVBLFNBQVMsS0FBSyxRQUFRLElBQUksQ0FDekIsK0JBQUcsU0FBUyxFQUFDLGlEQUFpRCxhQUM1RCx1QkFBQywwQkFBVyxJQUFDLFNBQVMsRUFBQyxTQUFTLEdBQUcsNkVBRWpDLENBQ0wsSUFDQSxDQUNKLElBQ0csQ0FDUCxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBRUYsa0JBQWUsa0JBQWtCLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxmZWF0dXJlc1xcc2hhcmVkXFxjb21wb25lbnRzXFx1aVxcUmVzdGF1cmFudFNlbGVjdG9yLmpzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgTWFwUGluLCBTZWFyY2gsIFN0b3JlLCBMb2FkZXIsIEFsZXJ0Q2lyY2xlLCBSZWZyZXNoQ3cgfSBmcm9tICdsdWNpZGUtcmVhY3QnO1xyXG5pbXBvcnQgeyBzdXBhYmFzZSB9IGZyb20gJ0AvbGliL3N1cGFiYXNlQ2xpZW50JztcclxuaW1wb3J0IHsgTGFiZWwgfSBmcm9tICdAL2ZlYXR1cmVzL3NoYXJlZC9jb21wb25lbnRzL3VpL2xhYmVsJztcclxuaW1wb3J0IHsgSW5wdXQgfSBmcm9tICdAL2ZlYXR1cmVzL3NoYXJlZC9jb21wb25lbnRzL3VpL2lucHV0JztcclxuXHJcbmNvbnN0IFJlc3RhdXJhbnRTZWxlY3RvciA9ICh7IHZhbHVlLCBvbkNoYW5nZSwgZXZlbnRUeXBlIH0pID0+IHtcclxuICBjb25zdCBbcGFydG5lcnMsIHNldFBhcnRuZXJzXSA9IHVzZVN0YXRlKFtdKTtcclxuICBjb25zdCBbbG9hZGluZywgc2V0TG9hZGluZ10gPSB1c2VTdGF0ZSh0cnVlKTtcclxuICBjb25zdCBbc2VhcmNoVGVybSwgc2V0U2VhcmNoVGVybV0gPSB1c2VTdGF0ZSgnJyk7XHJcbiAgY29uc3QgW3NlbGVjdGVkUGFydG5lciwgc2V0U2VsZWN0ZWRQYXJ0bmVyXSA9IHVzZVN0YXRlKG51bGwpO1xyXG5cclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgbG9hZFBhcnRuZXJzKCk7XHJcbiAgfSwgW10pO1xyXG5cclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgaWYgKHZhbHVlICYmIHBhcnRuZXJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgY29uc3QgcGFydG5lciA9IHBhcnRuZXJzLmZpbmQocCA9PiBwLmlkID09PSB2YWx1ZSk7XHJcbiAgICAgIHNldFNlbGVjdGVkUGFydG5lcihwYXJ0bmVyKTtcclxuICAgIH1cclxuICB9LCBbdmFsdWUsIHBhcnRuZXJzXSk7XHJcblxyXG4gIGNvbnN0IGxvYWRQYXJ0bmVycyA9IGFzeW5jICgpID0+IHtcclxuICAgIHNldExvYWRpbmcodHJ1ZSk7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyDinIUgQlVTQ0EgVE9ET1MgT1MgUkVTVEFVUkFOVEVTIEFUSVZPU1xyXG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAgIC5mcm9tKCdwYXJ0bmVycycpXHJcbiAgICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgICAgLm9yZGVyKCduYW1lJywgeyBhc2NlbmRpbmc6IHRydWUgfSk7XHJcblxyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJybyBTUUw6JywgZXJyb3IpO1xyXG4gICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBjb25zb2xlLmxvZygn4pyFIFRvdGFsIGRlIHJlc3RhdXJhbnRlcyBubyBiYW5jbzonLCBkYXRhPy5sZW5ndGggfHwgMCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfwn5OLIFJlc3RhdXJhbnRlczonLCBkYXRhKTtcclxuICAgICAgXHJcbiAgICAgIC8vIEZpbHRyYSBhcGVuYXMgb3MgYXRpdm9zIG5vIGZyb250ZW5kIChtYWlzIHNlZ3VybylcclxuICAgICAgY29uc3QgYWN0aXZlUGFydG5lcnMgPSBkYXRhPy5maWx0ZXIocCA9PiB7XHJcbiAgICAgICAgLy8gQWNlaXRhIGRpZmVyZW50ZXMgdmFyaWHDp8O1ZXMgZGUgY2FtcG9zIGRlIHN0YXR1c1xyXG4gICAgICAgIHJldHVybiBwLnN0YXR1cyA9PT0gJ2F0aXZvJyB8fCBcclxuICAgICAgICAgICAgICAgcC5zdGF0dXMgPT09ICdhY3RpdmUnIHx8IFxyXG4gICAgICAgICAgICAgICBwLmlzX2FjdGl2ZSA9PT0gdHJ1ZSB8fCBcclxuICAgICAgICAgICAgICAgcC5hY3RpdmUgPT09IHRydWUgfHxcclxuICAgICAgICAgICAgICAgIXAuc3RhdHVzOyAvLyBTZSBuw6NvIHRpdmVyIGNhbXBvIHN0YXR1cywgaW5jbHVpXHJcbiAgICAgIH0pIHx8IFtdO1xyXG4gICAgICBcclxuICAgICAgY29uc29sZS5sb2coJ+KchSBSZXN0YXVyYW50ZXMgYXRpdm9zOicsIGFjdGl2ZVBhcnRuZXJzLmxlbmd0aCk7XHJcbiAgICAgIHNldFBhcnRuZXJzKGFjdGl2ZVBhcnRuZXJzKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvIGFvIGNhcnJlZ2FyIHJlc3RhdXJhbnRlczonLCBlcnJvcik7XHJcbiAgICAgIHNldFBhcnRuZXJzKFtdKTsgLy8gR2FyYW50ZSBhcnJheSB2YXppbyBlbSBjYXNvIGRlIGVycm9cclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgIHNldExvYWRpbmcoZmFsc2UpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZVNlbGVjdCA9IChwYXJ0bmVyKSA9PiB7XHJcbiAgICBzZXRTZWxlY3RlZFBhcnRuZXIocGFydG5lcik7XHJcbiAgICBvbkNoYW5nZShwYXJ0bmVyLmlkKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVDbGVhciA9ICgpID0+IHtcclxuICAgIHNldFNlbGVjdGVkUGFydG5lcihudWxsKTtcclxuICAgIG9uQ2hhbmdlKG51bGwpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGdldEFkZHJlc3MgPSAocGFydG5lcikgPT4ge1xyXG4gICAgaWYgKCFwYXJ0bmVyLmFkZHJlc3MpIHJldHVybiBudWxsO1xyXG4gICAgXHJcbiAgICBpZiAodHlwZW9mIHBhcnRuZXIuYWRkcmVzcyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgcmV0dXJuIHBhcnRuZXIuYWRkcmVzcztcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKHR5cGVvZiBwYXJ0bmVyLmFkZHJlc3MgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgIGlmIChwYXJ0bmVyLmFkZHJlc3MudGV4dCkgcmV0dXJuIHBhcnRuZXIuYWRkcmVzcy50ZXh0O1xyXG4gICAgICBcclxuICAgICAgY29uc3QgcGFydHMgPSBbXHJcbiAgICAgICAgcGFydG5lci5hZGRyZXNzLnN0cmVldCB8fCBwYXJ0bmVyLmFkZHJlc3MucnVhLFxyXG4gICAgICAgIHBhcnRuZXIuYWRkcmVzcy5udW1iZXIgfHwgcGFydG5lci5hZGRyZXNzLm51bWVybyxcclxuICAgICAgICBwYXJ0bmVyLmFkZHJlc3MuY2l0eSB8fCBwYXJ0bmVyLmFkZHJlc3MuY2lkYWRlLFxyXG4gICAgICBdLmZpbHRlcihCb29sZWFuKTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiBwYXJ0cy5sZW5ndGggPiAwID8gcGFydHMuam9pbignLCAnKSA6IG51bGw7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGZpbHRlcmVkUGFydG5lcnMgPSBwYXJ0bmVycy5maWx0ZXIocGFydG5lciA9PiB7XHJcbiAgICBjb25zdCBzZWFyY2hMb3dlciA9IHNlYXJjaFRlcm0udG9Mb3dlckNhc2UoKTtcclxuICAgIGNvbnN0IGFkZHJlc3MgPSBnZXRBZGRyZXNzKHBhcnRuZXIpO1xyXG4gICAgXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICBwYXJ0bmVyLm5hbWU/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoTG93ZXIpIHx8XHJcbiAgICAgIHBhcnRuZXIuY29udGFjdF9uYW1lPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaExvd2VyKSB8fFxyXG4gICAgICBwYXJ0bmVyLmRlc2NyaXB0aW9uPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaExvd2VyKSB8fFxyXG4gICAgICBhZGRyZXNzPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaExvd2VyKVxyXG4gICAgKTtcclxuICB9KTtcclxuXHJcbiAgaWYgKGV2ZW50VHlwZSA9PT0gJ2luc3RpdHVjaW9uYWwnKSB7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIHJldHVybiAoXHJcbiAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktMlwiPlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlblwiPlxyXG4gICAgICAgIDxMYWJlbCBodG1sRm9yPVwicGFydG5lclwiPlxyXG4gICAgICAgICAgUmVzdGF1cmFudGUge2V2ZW50VHlwZSA9PT0gJ3BhZHJhbycgJiYgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC1yZWQtNDAwXCI+Kjwvc3Bhbj59XHJcbiAgICAgICAgPC9MYWJlbD5cclxuICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcclxuICAgICAgICAgIG9uQ2xpY2s9e2xvYWRQYXJ0bmVyc31cclxuICAgICAgICAgIGRpc2FibGVkPXtsb2FkaW5nfVxyXG4gICAgICAgICAgY2xhc3NOYW1lPVwidGV4dC1wdXJwbGUtNDAwIGhvdmVyOnRleHQtcHVycGxlLTMwMCB0ZXh0LXNtIGZsZXggaXRlbXMtY2VudGVyIGdhcC0xIGRpc2FibGVkOm9wYWNpdHktNTBcIlxyXG4gICAgICAgICAgdGl0bGU9XCJSZWNhcnJlZ2FyIHJlc3RhdXJhbnRlc1wiXHJcbiAgICAgICAgPlxyXG4gICAgICAgICAgPFJlZnJlc2hDdyBjbGFzc05hbWU9e2B3LTQgaC00ICR7bG9hZGluZyA/ICdhbmltYXRlLXNwaW4nIDogJyd9YH0gLz5cclxuICAgICAgICAgIEF0dWFsaXphclxyXG4gICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICA8L2Rpdj5cclxuXHJcbiAgICAgIHtzZWxlY3RlZFBhcnRuZXIgPyAoXHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJnbGFzcy1lZmZlY3Qgcm91bmRlZC1sZyBwLTQgYm9yZGVyIGJvcmRlci13aGl0ZS8xMFwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLXN0YXJ0IGp1c3RpZnktYmV0d2VlblwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMVwiPlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgbWItMVwiPlxyXG4gICAgICAgICAgICAgICAgPFN0b3JlIGNsYXNzTmFtZT1cInctNCBoLTQgdGV4dC1wdXJwbGUtNDAwXCIgLz5cclxuICAgICAgICAgICAgICAgIDxoNCBjbGFzc05hbWU9XCJ0ZXh0LXdoaXRlIGZvbnQtc2VtaWJvbGRcIj57c2VsZWN0ZWRQYXJ0bmVyLm5hbWV9PC9oND5cclxuICAgICAgICAgICAgICAgIHtzZWxlY3RlZFBhcnRuZXIudHlwZSA9PT0gJ3ByZW1pdW0nICYmIChcclxuICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC14cyBiZy1ncmFkaWVudC10by1yIGZyb20tcHVycGxlLTUwMCB0by1waW5rLTUwMCBweC0yIHB5LTAuNSByb3VuZGVkLWZ1bGxcIj5cclxuICAgICAgICAgICAgICAgICAgICBQcmVtaXVtXHJcbiAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAge3NlbGVjdGVkUGFydG5lci5jb250YWN0X25hbWUgJiYgKFxyXG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC13aGl0ZS81MCB0ZXh0LXhzIG1iLTJcIj57c2VsZWN0ZWRQYXJ0bmVyLmNvbnRhY3RfbmFtZX08L3A+XHJcbiAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICB7c2VsZWN0ZWRQYXJ0bmVyLmRlc2NyaXB0aW9uICYmIChcclxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtd2hpdGUvNjAgdGV4dC1zbSBtYi0yIGxpbmUtY2xhbXAtMlwiPntzZWxlY3RlZFBhcnRuZXIuZGVzY3JpcHRpb259PC9wPlxyXG4gICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAge2dldEFkZHJlc3Moc2VsZWN0ZWRQYXJ0bmVyKSAmJiAoXHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtc3RhcnQgZ2FwLTIgdGV4dC13aGl0ZS82MCB0ZXh0LXNtXCI+XHJcbiAgICAgICAgICAgICAgICAgIDxNYXBQaW4gY2xhc3NOYW1lPVwidy0zIGgtMyBtdC0xIGZsZXgtc2hyaW5rLTBcIiAvPlxyXG4gICAgICAgICAgICAgICAgICA8cD57Z2V0QWRkcmVzcyhzZWxlY3RlZFBhcnRuZXIpfTwvcD5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAge3NlbGVjdGVkUGFydG5lci5waG9uZSAmJiAoXHJcbiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXdoaXRlLzQwIHRleHQteHMgbXQtMVwiPlRlbDoge3NlbGVjdGVkUGFydG5lci5waG9uZX08L3A+XHJcbiAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIG9uQ2xpY2s9e2hhbmRsZUNsZWFyfSBjbGFzc05hbWU9XCJ0ZXh0LXJlZC00MDAgaG92ZXI6dGV4dC1yZWQtMzAwIHRleHQtc21cIj5cclxuICAgICAgICAgICAgICBBbHRlcmFyXHJcbiAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICkgOiAoXHJcbiAgICAgICAgPD5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicmVsYXRpdmVcIj5cclxuICAgICAgICAgICAgPFNlYXJjaCBjbGFzc05hbWU9XCJhYnNvbHV0ZSBsZWZ0LTMgdG9wLTEvMiAtdHJhbnNsYXRlLXktMS8yIHctNSBoLTUgdGV4dC13aGl0ZS80MFwiIC8+XHJcbiAgICAgICAgICAgIDxJbnB1dFxyXG4gICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcclxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkJ1c2NhciByZXN0YXVyYW50ZS4uLlwiXHJcbiAgICAgICAgICAgICAgdmFsdWU9e3NlYXJjaFRlcm19XHJcbiAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRTZWFyY2hUZXJtKGUudGFyZ2V0LnZhbHVlKX1cclxuICAgICAgICAgICAgICBjbGFzc05hbWU9XCJwbC0xMCBnbGFzcy1lZmZlY3QgYm9yZGVyLXdoaXRlLzEwXCJcclxuICAgICAgICAgICAgLz5cclxuICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ2xhc3MtZWZmZWN0IHJvdW5kZWQtbGcgYm9yZGVyIGJvcmRlci13aGl0ZS8xMCBtYXgtaC02NCBvdmVyZmxvdy15LWF1dG9cIj5cclxuICAgICAgICAgICAge2xvYWRpbmcgPyAoXHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBwLThcIj5cclxuICAgICAgICAgICAgICAgIDxMb2FkZXIgY2xhc3NOYW1lPVwidy02IGgtNiB0ZXh0LXdoaXRlLzQwIGFuaW1hdGUtc3BpblwiIC8+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICkgOiBmaWx0ZXJlZFBhcnRuZXJzLmxlbmd0aCA9PT0gMCA/IChcclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZmxleC1jb2wgaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHAtOCB0ZXh0LWNlbnRlclwiPlxyXG4gICAgICAgICAgICAgICAgPEFsZXJ0Q2lyY2xlIGNsYXNzTmFtZT1cInctMTIgaC0xMiB0ZXh0LXdoaXRlLzIwIG1iLTJcIiAvPlxyXG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC13aGl0ZS82MCB0ZXh0LXNtXCI+XHJcbiAgICAgICAgICAgICAgICAgIHtzZWFyY2hUZXJtID8gJ05lbmh1bSByZXN0YXVyYW50ZSBlbmNvbnRyYWRvJyA6ICdOZW5odW0gcmVzdGF1cmFudGUgZGlzcG9uw612ZWwnfVxyXG4gICAgICAgICAgICAgICAgPC9wPlxyXG4gICAgICAgICAgICAgICAgeyFzZWFyY2hUZXJtICYmIHBhcnRuZXJzLmxlbmd0aCA9PT0gMCAmJiAoXHJcbiAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtd2hpdGUvNDAgdGV4dC14cyBtdC0yXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgVG90YWwgbm8gYmFuY286IHtwYXJ0bmVycy5sZW5ndGh9IHJlc3RhdXJhbnRlc1xyXG4gICAgICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICApIDogKFxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZGl2aWRlLXkgZGl2aWRlLXdoaXRlLzEwXCI+XHJcbiAgICAgICAgICAgICAgICB7ZmlsdGVyZWRQYXJ0bmVycy5tYXAoKHBhcnRuZXIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgY29uc3QgYWRkcmVzcyA9IGdldEFkZHJlc3MocGFydG5lcik7XHJcbiAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b25cclxuICAgICAgICAgICAgICAgICAgICAgIGtleT17cGFydG5lci5pZH1cclxuICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gaGFuZGxlU2VsZWN0KHBhcnRuZXIpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsIHRleHQtbGVmdCBwLTQgaG92ZXI6Ymctd2hpdGUvNSB0cmFuc2l0aW9uLWNvbG9yc1wiXHJcbiAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLXN0YXJ0IGdhcC0zXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxTdG9yZSBjbGFzc05hbWU9XCJ3LTUgaC01IHRleHQtcHVycGxlLTQwMCBtdC0xIGZsZXgtc2hyaW5rLTBcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBtaW4tdy0wXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBtYi0xXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDQgY2xhc3NOYW1lPVwidGV4dC13aGl0ZSBmb250LW1lZGl1bVwiPntwYXJ0bmVyLm5hbWV9PC9oND5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtwYXJ0bmVyLnR5cGUgPT09ICdwcmVtaXVtJyAmJiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRleHQteHMgYmctZ3JhZGllbnQtdG8tciBmcm9tLXB1cnBsZS01MDAgdG8tcGluay01MDAgcHgtMiBweS0wLjUgcm91bmRlZC1mdWxsXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHJlbWl1bVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHtwYXJ0bmVyLmNvbnRhY3RfbmFtZSAmJiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXdoaXRlLzUwIHRleHQteHMgbWItMVwiPntwYXJ0bmVyLmNvbnRhY3RfbmFtZX08L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICB7cGFydG5lci5kZXNjcmlwdGlvbiAmJiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXdoaXRlLzYwIHRleHQtc20gbWItMSBsaW5lLWNsYW1wLTFcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3BhcnRuZXIuZGVzY3JpcHRpb259XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICB7YWRkcmVzcyAmJiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtc3RhcnQgZ2FwLTEgdGV4dC13aGl0ZS82MCB0ZXh0LXNtIG1iLTFcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPE1hcFBpbiBjbGFzc05hbWU9XCJ3LTMgaC0zIG10LTEgZmxleC1zaHJpbmstMFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRydW5jYXRlXCI+e2FkZHJlc3N9PC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICB7cGFydG5lci5waG9uZSAmJiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXdoaXRlLzQwIHRleHQteHNcIj5UZWw6IHtwYXJ0bmVyLnBob25lfTwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfSl9XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICl9XHJcbiAgICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgICB7ZXZlbnRUeXBlID09PSAncGFydGljdWxhcicgJiYgKFxyXG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXdoaXRlLzQwIHRleHQteHNcIj5cclxuICAgICAgICAgICAgICBEaWNhOiBWb2PDqiBwb2RlIGNyaWFyIG8gZXZlbnRvIHNlbSBzZWxlY2lvbmFyIHVtIHJlc3RhdXJhbnRlIGUgaW5mb3JtYXIgbyBsb2NhbCBtYW51YWxtZW50ZS5cclxuICAgICAgICAgICAgPC9wPlxyXG4gICAgICAgICAgKX1cclxuXHJcbiAgICAgICAgICB7ZXZlbnRUeXBlID09PSAncGFkcmFvJyAmJiAoXHJcbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQteWVsbG93LTMwMCB0ZXh0LXhzIGZsZXggaXRlbXMtY2VudGVyIGdhcC0xXCI+XHJcbiAgICAgICAgICAgICAgPEFsZXJ0Q2lyY2xlIGNsYXNzTmFtZT1cInctMyBoLTNcIiAvPlxyXG4gICAgICAgICAgICAgIEV2ZW50b3MgcGFkcsOjbyBkZXZlbSBzZXIgcmVhbGl6YWRvcyBlbSByZXN0YXVyYW50ZXMgY3JlZGVuY2lhZG9zXHJcbiAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICl9XHJcbiAgICAgICAgPC8+XHJcbiAgICAgICl9XHJcbiAgICA8L2Rpdj5cclxuICApO1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgUmVzdGF1cmFudFNlbGVjdG9yOyJdLCJ2ZXJzaW9uIjozfQ==