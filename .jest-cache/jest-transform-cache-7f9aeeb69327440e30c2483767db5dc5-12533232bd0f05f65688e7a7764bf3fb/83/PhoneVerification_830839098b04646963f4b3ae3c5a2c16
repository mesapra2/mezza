222701eabb37206f097d7511be9052f2
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const jsx_runtime_1 = require("react/jsx-runtime");
// src/features/shared/components/auth/PhoneVerification.jsx
const react_1 = tslib_1.__importStar(require("react"));
const prop_types_1 = tslib_1.__importDefault(require("prop-types"));
const framer_motion_1 = require("framer-motion");
const lucide_react_1 = require("lucide-react");
const button_1 = require("@/features/shared/components/ui/button");
const input_1 = require("@/features/shared/components/ui/input");
const use_toast_1 = require("@/features/shared/components/ui/use-toast");
const authService = tslib_1.__importStar(require("@/services/authService")); // <-- CORREÇÃO AQUI
const PhoneVerification = ({ userId, phone, onVerified, onBack }) => {
    const [code, setCode] = (0, react_1.useState)(['', '', '', '', '', '']);
    const [isLoading, setIsLoading] = (0, react_1.useState)(false);
    const [canResend, setCanResend] = (0, react_1.useState)(false);
    const [countdown, setCountdown] = (0, react_1.useState)(60);
    const { toast } = (0, use_toast_1.useToast)();
    (0, react_1.useEffect)(() => {
        if (countdown > 0) {
            const timer = setTimeout(() => setCountdown(countdown - 1), 1000);
            return () => clearTimeout(timer);
        }
        else {
            setCanResend(true);
        }
    }, [countdown]);
    const handleCodeChange = (index, value) => {
        if (value.length > 1) {
            value = value.slice(-1);
        }
        const newCode = [...code];
        newCode[index] = value;
        setCode(newCode);
        // Move para o próximo input automaticamente
        if (value && index < 5) {
            const nextInput = document.getElementById(`code-${index + 1}`);
            if (nextInput)
                nextInput.focus();
        }
    };
    const handleKeyDown = (index, e) => {
        if (e.key === 'Backspace' && !code[index] && index > 0) {
            const prevInput = document.getElementById(`code-${index - 1}`);
            if (prevInput)
                prevInput.focus();
        }
    };
    const handlePaste = (e) => {
        e.preventDefault();
        const pastedData = e.clipboardData.getData('text').slice(0, 6);
        const newCode = [...code];
        for (let i = 0; i < pastedData.length; i++) {
            if (i < 6) {
                newCode[i] = pastedData[i];
            }
        }
        setCode(newCode);
        // Foca no próximo input vazio ou no último
        const nextEmptyIndex = newCode.findIndex(c => !c);
        const focusIndex = nextEmptyIndex === -1 ? 5 : nextEmptyIndex;
        const input = document.getElementById(`code-${focusIndex}`);
        if (input)
            input.focus();
    };
    const handleVerify = async () => {
        const verificationCode = code.join('');
        if (verificationCode.length !== 6) {
            toast({
                variant: "destructive",
                title: "Código incompleto",
                description: "Por favor, digite o código de 6 dígitos.",
            });
            return;
        }
        setIsLoading(true);
        try {
            await authService.verifyPhone({ userId, code: verificationCode });
            toast({
                title: "Telefone verificado!",
                description: "Seu cadastro foi concluído com sucesso.",
            });
            onVerified();
        }
        catch (error) {
            toast({
                variant: "destructive",
                title: "Código inválido",
                description: error.message || "Tente novamente.",
            });
            setCode(['', '', '', '', '', '']);
            document.getElementById('code-0')?.focus();
        }
        finally {
            setIsLoading(false);
        }
    };
    const handleResend = async () => {
        if (!canResend)
            return;
        setIsLoading(true);
        try {
            // O teste que você enviou mostra que seu serviço usa "resendVerificationCode"
            // Se essa função não existir, mude para "authService.resendCode"
            await authService.resendVerificationCode({ userId, phone });
            toast({
                title: "Código reenviado",
                description: "Um novo código foi enviado para seu telefone.",
            });
            setCanResend(false);
            setCountdown(60);
            setCode(['', '', '', '', '', '']);
            document.getElementById('code-0')?.focus();
        }
        catch (error) {
            toast({
                variant: "destructive",
                title: "Erro ao reenviar",
                description: error.message || "Tente novamente.",
            });
        }
        finally {
            setIsLoading(false);
        }
    };
    const formatPhone = (phoneNumber) => {
        if (!phoneNumber)
            return '';
        // Remove tudo que não é número
        const cleaned = phoneNumber.replace(/\D/g, '');
        // Formata (55) 99999-9999
        if (cleaned.length === 13) {
            return `(${cleaned.slice(2, 4)}) ${cleaned.slice(4, 9)}-${cleaned.slice(9)}`;
        }
        return phoneNumber;
    };
    return ((0, jsx_runtime_1.jsx)(framer_motion_1.motion.div, { initial: { opacity: 0, x: 20 }, animate: { opacity: 1, x: 0 }, className: "w-full", children: (0, jsx_runtime_1.jsxs)("div", { className: "glass-effect rounded-2xl p-8 border border-white/10", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex items-center mb-6", children: (0, jsx_runtime_1.jsx)("button", { onClick: onBack || (() => window.history.back()), className: "text-white/60 hover:text-white transition-colors", disabled: isLoading, children: (0, jsx_runtime_1.jsx)(lucide_react_1.ArrowLeft, { className: "w-5 h-5" }) }) }), (0, jsx_runtime_1.jsx)("div", { className: "flex justify-center mb-8", children: (0, jsx_runtime_1.jsx)("div", { className: "w-16 h-16 rounded-2xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center", children: (0, jsx_runtime_1.jsx)(lucide_react_1.Smartphone, { className: "w-8 h-8 text-white" }) }) }), (0, jsx_runtime_1.jsx)("h1", { className: "text-3xl font-bold text-center mb-2 gradient-text", children: "Verifica\u00E7\u00E3o de Telefone" }), (0, jsx_runtime_1.jsx)("p", { className: "text-center text-white/60 mb-2", children: "Digite o c\u00F3digo de 6 d\u00EDgitos enviado para" }), (0, jsx_runtime_1.jsx)("p", { className: "text-center text-purple-400 font-semibold mb-8", children: formatPhone(phone) }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-6", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex justify-center gap-2 mb-8", children: code.map((digit, index) => ((0, jsx_runtime_1.jsx)(input_1.Input, { id: `code-${index}`, type: "text", inputMode: "numeric", maxLength: 1, value: digit, onChange: (e) => handleCodeChange(index, e.target.value), onKeyDown: (e) => handleKeyDown(index, e), onPaste: index === 0 ? handlePaste : undefined, className: "w-12 h-14 text-center text-2xl font-bold glass-effect border-white/10", disabled: isLoading }, index))) }), (0, jsx_runtime_1.jsx)(button_1.Button, { onClick: handleVerify, className: "w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 h-12 text-base font-semibold", disabled: isLoading || code.some(c => !c), children: isLoading ? 'Verificando...' : 'Verificar' }), (0, jsx_runtime_1.jsx)("div", { className: "text-center", children: canResend ? ((0, jsx_runtime_1.jsx)("button", { onClick: handleResend, className: "text-purple-400 hover:text-purple-300 font-semibold text-sm", disabled: isLoading, children: "Reenviar c\u00F3digo" })) : ((0, jsx_runtime_1.jsxs)("p", { className: "text-white/60 text-sm", children: ["Reenviar c\u00F3digo em ", countdown, "s"] })) }), (0, jsx_runtime_1.jsx)("div", { className: "mt-6 p-4 rounded-lg bg-white/5 border border-white/10", children: (0, jsx_runtime_1.jsx)("p", { className: "text-white/60 text-sm text-center", children: "N\u00E3o recebeu o c\u00F3digo? Verifique se o n\u00FAmero est\u00E1 correto ou tente reenviar." }) })] })] }) }));
};
PhoneVerification.propTypes = {
    userId: prop_types_1.default.string.isRequired,
    phone: prop_types_1.default.string.isRequired,
    onVerified: prop_types_1.default.func.isRequired,
    onBack: prop_types_1.default.func, // ✅ Agora é opcional
};
PhoneVerification.defaultProps = {
    onBack: () => window.history.back(), // ✅ Valor padrão
};
exports.default = PhoneVerification;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxmZWF0dXJlc1xcc2hhcmVkXFxjb21wb25lbnRzXFxhdXRoXFxQaG9uZVZlcmlmaWNhdGlvbi5qc3giLCJtYXBwaW5ncyI6Ijs7OztBQUFBLDREQUE0RDtBQUM1RCx1REFBbUQ7QUFDbkQsb0VBQW1DO0FBQ25DLGlEQUF1QztBQUN2QywrQ0FBcUQ7QUFDckQsbUVBQWdFO0FBQ2hFLGlFQUE4RDtBQUM5RCx5RUFBcUU7QUFDckUsNEVBQXNELENBQUMsb0JBQW9CO0FBRTNFLE1BQU0saUJBQWlCLEdBQUcsQ0FBQyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUU7SUFDbEUsTUFBTSxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDM0QsTUFBTSxDQUFDLFNBQVMsRUFBRSxZQUFZLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsS0FBSyxDQUFDLENBQUM7SUFDbEQsTUFBTSxDQUFDLFNBQVMsRUFBRSxZQUFZLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsS0FBSyxDQUFDLENBQUM7SUFDbEQsTUFBTSxDQUFDLFNBQVMsRUFBRSxZQUFZLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsRUFBRSxDQUFDLENBQUM7SUFDL0MsTUFBTSxFQUFFLEtBQUssRUFBRSxHQUFHLElBQUEsb0JBQVEsR0FBRSxDQUFDO0lBRTdCLElBQUEsaUJBQVMsRUFBQyxHQUFHLEVBQUU7UUFDYixJQUFJLFNBQVMsR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUNsQixNQUFNLEtBQUssR0FBRyxVQUFVLENBQUMsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDLFNBQVMsR0FBRyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztZQUNsRSxP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QztBQUNKLENBQUMsQ0FBQztBQUVGLGlCQUFpQixDQUFDLFNBQVMsR0FBRztJQUM1QixNQUFNLEVBQUUsb0JBQVMsQ0FBQyxNQUFNLENBQUMsVUFBVTtJQUNuQyxLQUFLLEVBQUUsb0JBQVMsQ0FBQyxNQUFNLENBQUMsVUFBVTtJQUNsQyxVQUFVLEVBQUUsb0JBQVMsQ0FBQyxJQUFJLENBQUMsVUFBVTtJQUNyQyxNQUFNLEVBQUUsb0JBQVMsQ0FBQyxJQUFJLEVBQUUscUJBQXFCO0NBQzlDLENBQUM7QUFFRixpQkFBaUIsQ0FBQyxZQUFZLEdBQUc7SUFDL0IsTUFBTSxFQUFFLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLEVBQUUsaUJBQWlCO0NBQ3ZELENBQUM7QUFFRixrQkFBZSxpQkFBaUIsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcREVWTWl4XFxBcHAuTWVzYXByYTIuY29tXFxzcmNcXGZlYXR1cmVzXFxzaGFyZWRcXGNvbXBvbmVudHNcXGF1dGhcXFBob25lVmVyaWZpY2F0aW9uLmpzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvZmVhdHVyZXMvc2hhcmVkL2NvbXBvbmVudHMvYXV0aC9QaG9uZVZlcmlmaWNhdGlvbi5qc3hcclxuaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XHJcbmltcG9ydCB7IG1vdGlvbiB9IGZyb20gJ2ZyYW1lci1tb3Rpb24nO1xyXG5pbXBvcnQgeyBTbWFydHBob25lLCBBcnJvd0xlZnQgfSBmcm9tICdsdWNpZGUtcmVhY3QnO1xyXG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tICdAL2ZlYXR1cmVzL3NoYXJlZC9jb21wb25lbnRzL3VpL2J1dHRvbic7XHJcbmltcG9ydCB7IElucHV0IH0gZnJvbSAnQC9mZWF0dXJlcy9zaGFyZWQvY29tcG9uZW50cy91aS9pbnB1dCc7XHJcbmltcG9ydCB7IHVzZVRvYXN0IH0gZnJvbSAnQC9mZWF0dXJlcy9zaGFyZWQvY29tcG9uZW50cy91aS91c2UtdG9hc3QnO1xyXG5pbXBvcnQgKiBhcyBhdXRoU2VydmljZSBmcm9tICdAL3NlcnZpY2VzL2F1dGhTZXJ2aWNlJzsgLy8gPC0tIENPUlJFw4fDg08gQVFVSVxyXG5cclxuY29uc3QgUGhvbmVWZXJpZmljYXRpb24gPSAoeyB1c2VySWQsIHBob25lLCBvblZlcmlmaWVkLCBvbkJhY2sgfSkgPT4ge1xyXG4gIGNvbnN0IFtjb2RlLCBzZXRDb2RlXSA9IHVzZVN0YXRlKFsnJywgJycsICcnLCAnJywgJycsICcnXSk7XHJcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICBjb25zdCBbY2FuUmVzZW5kLCBzZXRDYW5SZXNlbmRdID0gdXNlU3RhdGUoZmFsc2UpO1xyXG4gIGNvbnN0IFtjb3VudGRvd24sIHNldENvdW50ZG93bl0gPSB1c2VTdGF0ZSg2MCk7XHJcbiAgY29uc3QgeyB0b2FzdCB9ID0gdXNlVG9hc3QoKTtcclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGlmIChjb3VudGRvd24gPiAwKSB7XHJcbiAgICAgIGNvbnN0IHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiBzZXRDb3VudGRvd24oY291bnRkb3duIC0gMSksIDEwMDApO1xyXG4gICAgICByZXR1cm4gKCkgPT4gY2xlYXJUaW1lb3V0KHRpbWVyKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNldENhblJlc2VuZCh0cnVlKTtcclxuICAgIH1cclxuICB9LCBbY291bnRkb3duXSk7XHJcblxyXG4gIGNvbnN0IGhhbmRsZUNvZGVDaGFuZ2UgPSAoaW5kZXgsIHZhbHVlKSA9PiB7XHJcbiAgICBpZiAodmFsdWUubGVuZ3RoID4gMSkge1xyXG4gICAgICB2YWx1ZSA9IHZhbHVlLnNsaWNlKC0xKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBuZXdDb2RlID0gWy4uLmNvZGVdO1xyXG4gICAgbmV3Q29kZVtpbmRleF0gPSB2YWx1ZTtcclxuICAgIHNldENvZGUobmV3Q29kZSk7XHJcblxyXG4gICAgLy8gTW92ZSBwYXJhIG8gcHLDs3hpbW8gaW5wdXQgYXV0b21hdGljYW1lbnRlXHJcbiAgICBpZiAodmFsdWUgJiYgaW5kZXggPCA1KSB7XHJcbiAgICAgIGNvbnN0IG5leHRJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBjb2RlLSR7aW5kZXggKyAxfWApO1xyXG4gICAgICBpZiAobmV4dElucHV0KSBuZXh0SW5wdXQuZm9jdXMoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVLZXlEb3duID0gKGluZGV4LCBlKSA9PiB7XHJcbiAgICBpZiAoZS5rZXkgPT09ICdCYWNrc3BhY2UnICYmICFjb2RlW2luZGV4XSAmJiBpbmRleCA+IDApIHtcclxuICAgICAgY29uc3QgcHJldklucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGNvZGUtJHtpbmRleCAtIDF9YCk7XHJcbiAgICAgIGlmIChwcmV2SW5wdXQpIHByZXZJbnB1dC5mb2N1cygpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZVBhc3RlID0gKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnN0IHBhc3RlZERhdGEgPSBlLmNsaXBib2FyZERhdGEuZ2V0RGF0YSgndGV4dCcpLnNsaWNlKDAsIDYpO1xyXG4gICAgY29uc3QgbmV3Q29kZSA9IFsuLi5jb2RlXTtcclxuICAgIFxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXN0ZWREYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGlmIChpIDwgNikge1xyXG4gICAgICAgIG5ld0NvZGVbaV0gPSBwYXN0ZWREYXRhW2ldO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHNldENvZGUobmV3Q29kZSk7XHJcbiAgICBcclxuICAgIC8vIEZvY2Egbm8gcHLDs3hpbW8gaW5wdXQgdmF6aW8gb3Ugbm8gw7psdGltb1xyXG4gICAgY29uc3QgbmV4dEVtcHR5SW5kZXggPSBuZXdDb2RlLmZpbmRJbmRleChjID0+ICFjKTtcclxuICAgIGNvbnN0IGZvY3VzSW5kZXggPSBuZXh0RW1wdHlJbmRleCA9PT0gLTEgPyA1IDogbmV4dEVtcHR5SW5kZXg7XHJcbiAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBjb2RlLSR7Zm9jdXNJbmRleH1gKTtcclxuICAgIGlmIChpbnB1dCkgaW5wdXQuZm9jdXMoKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVWZXJpZnkgPSBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCB2ZXJpZmljYXRpb25Db2RlID0gY29kZS5qb2luKCcnKTtcclxuICAgIFxyXG4gICAgaWYgKHZlcmlmaWNhdGlvbkNvZGUubGVuZ3RoICE9PSA2KSB7XHJcbiAgICAgIHRvYXN0KHtcclxuICAgICAgICB2YXJpYW50OiBcImRlc3RydWN0aXZlXCIsXHJcbiAgICAgICAgdGl0bGU6IFwiQ8OzZGlnbyBpbmNvbXBsZXRvXCIsXHJcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUG9yIGZhdm9yLCBkaWdpdGUgbyBjw7NkaWdvIGRlIDYgZMOtZ2l0b3MuXCIsXHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgc2V0SXNMb2FkaW5nKHRydWUpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgYXdhaXQgYXV0aFNlcnZpY2UudmVyaWZ5UGhvbmUoeyB1c2VySWQsIGNvZGU6IHZlcmlmaWNhdGlvbkNvZGUgfSk7XHJcbiAgICAgIHRvYXN0KHtcclxuICAgICAgICB0aXRsZTogXCJUZWxlZm9uZSB2ZXJpZmljYWRvIVwiLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlNldSBjYWRhc3RybyBmb2kgY29uY2x1w61kbyBjb20gc3VjZXNzby5cIixcclxuICAgICAgfSk7XHJcbiAgICAgIG9uVmVyaWZpZWQoKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRvYXN0KHtcclxuICAgICAgICB2YXJpYW50OiBcImRlc3RydWN0aXZlXCIsXHJcbiAgICAgICAgdGl0bGU6IFwiQ8OzZGlnbyBpbnbDoWxpZG9cIixcclxuICAgICAgICBkZXNjcmlwdGlvbjogZXJyb3IubWVzc2FnZSB8fCBcIlRlbnRlIG5vdmFtZW50ZS5cIixcclxuICAgICAgfSk7XHJcbiAgICAgIHNldENvZGUoWycnLCAnJywgJycsICcnLCAnJywgJyddKTtcclxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvZGUtMCcpPy5mb2N1cygpO1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVSZXNlbmQgPSBhc3luYyAoKSA9PiB7XHJcbiAgICBpZiAoIWNhblJlc2VuZCkgcmV0dXJuO1xyXG5cclxuICAgIHNldElzTG9hZGluZyh0cnVlKTtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIE8gdGVzdGUgcXVlIHZvY8OqIGVudmlvdSBtb3N0cmEgcXVlIHNldSBzZXJ2acOnbyB1c2EgXCJyZXNlbmRWZXJpZmljYXRpb25Db2RlXCJcclxuICAgICAgLy8gU2UgZXNzYSBmdW7Dp8OjbyBuw6NvIGV4aXN0aXIsIG11ZGUgcGFyYSBcImF1dGhTZXJ2aWNlLnJlc2VuZENvZGVcIlxyXG4gICAgICBhd2FpdCBhdXRoU2VydmljZS5yZXNlbmRWZXJpZmljYXRpb25Db2RlKHsgdXNlcklkLCBwaG9uZSB9KTtcclxuICAgICAgdG9hc3Qoe1xyXG4gICAgICAgIHRpdGxlOiBcIkPDs2RpZ28gcmVlbnZpYWRvXCIsXHJcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVW0gbm92byBjw7NkaWdvIGZvaSBlbnZpYWRvIHBhcmEgc2V1IHRlbGVmb25lLlwiLFxyXG4gICAgICB9KTtcclxuICAgICAgc2V0Q2FuUmVzZW5kKGZhbHNlKTtcclxuICAgICAgc2V0Q291bnRkb3duKDYwKTtcclxuICAgICAgc2V0Q29kZShbJycsICcnLCAnJywgJycsICcnLCAnJ10pO1xyXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29kZS0wJyk/LmZvY3VzKCk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0b2FzdCh7XHJcbiAgICAgICAgdmFyaWFudDogXCJkZXN0cnVjdGl2ZVwiLFxyXG4gICAgICAgIHRpdGxlOiBcIkVycm8gYW8gcmVlbnZpYXJcIixcclxuICAgICAgICBkZXNjcmlwdGlvbjogZXJyb3IubWVzc2FnZSB8fCBcIlRlbnRlIG5vdmFtZW50ZS5cIixcclxuICAgICAgfSk7XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGZvcm1hdFBob25lID0gKHBob25lTnVtYmVyKSA9PiB7XHJcbiAgICBpZiAoIXBob25lTnVtYmVyKSByZXR1cm4gJyc7XHJcbiAgICBcclxuICAgIC8vIFJlbW92ZSB0dWRvIHF1ZSBuw6NvIMOpIG7Dum1lcm9cclxuICAgIGNvbnN0IGNsZWFuZWQgPSBwaG9uZU51bWJlci5yZXBsYWNlKC9cXEQvZywgJycpO1xyXG4gICAgXHJcbiAgICAvLyBGb3JtYXRhICg1NSkgOTk5OTktOTk5OVxyXG4gICAgaWYgKGNsZWFuZWQubGVuZ3RoID09PSAxMykge1xyXG4gICAgICByZXR1cm4gYCgke2NsZWFuZWQuc2xpY2UoMiwgNCl9KSAke2NsZWFuZWQuc2xpY2UoNCwgOSl9LSR7Y2xlYW5lZC5zbGljZSg5KX1gO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHBob25lTnVtYmVyO1xyXG4gIH07XHJcblxyXG4gIHJldHVybiAoXHJcbiAgICA8bW90aW9uLmRpdlxyXG4gICAgICBpbml0aWFsPXt7IG9wYWNpdHk6IDAsIHg6IDIwIH19XHJcbiAgICAgIGFuaW1hdGU9e3sgb3BhY2l0eTogMSwgeDogMCB9fVxyXG4gICAgICBjbGFzc05hbWU9XCJ3LWZ1bGxcIlxyXG4gICAgPlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImdsYXNzLWVmZmVjdCByb3VuZGVkLTJ4bCBwLTggYm9yZGVyIGJvcmRlci13aGl0ZS8xMFwiPlxyXG4gICAgICAgIHsvKiBIZWFkZXIgKi99XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBtYi02XCI+XHJcbiAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgIG9uQ2xpY2s9e29uQmFjayB8fCAoKCkgPT4gd2luZG93Lmhpc3RvcnkuYmFjaygpKX1cclxuICAgICAgICAgICAgY2xhc3NOYW1lPVwidGV4dC13aGl0ZS82MCBob3Zlcjp0ZXh0LXdoaXRlIHRyYW5zaXRpb24tY29sb3JzXCJcclxuICAgICAgICAgICAgZGlzYWJsZWQ9e2lzTG9hZGluZ31cclxuICAgICAgICAgID5cclxuICAgICAgICAgICAgPEFycm93TGVmdCBjbGFzc05hbWU9XCJ3LTUgaC01XCIgLz5cclxuICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICB7Lyogw41jb25lICovfVxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBqdXN0aWZ5LWNlbnRlciBtYi04XCI+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctMTYgaC0xNiByb3VuZGVkLTJ4bCBiZy1ncmFkaWVudC10by1iciBmcm9tLXB1cnBsZS01MDAgdG8tcGluay01MDAgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXJcIj5cclxuICAgICAgICAgICAgPFNtYXJ0cGhvbmUgY2xhc3NOYW1lPVwidy04IGgtOCB0ZXh0LXdoaXRlXCIgLz5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICB7LyogVMOtdHVsbyAqL31cclxuICAgICAgICA8aDEgY2xhc3NOYW1lPVwidGV4dC0zeGwgZm9udC1ib2xkIHRleHQtY2VudGVyIG1iLTIgZ3JhZGllbnQtdGV4dFwiPlxyXG4gICAgICAgICAgVmVyaWZpY2HDp8OjbyBkZSBUZWxlZm9uZVxyXG4gICAgICAgIDwvaDE+XHJcbiAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXIgdGV4dC13aGl0ZS82MCBtYi0yXCI+XHJcbiAgICAgICAgICBEaWdpdGUgbyBjw7NkaWdvIGRlIDYgZMOtZ2l0b3MgZW52aWFkbyBwYXJhXHJcbiAgICAgICAgPC9wPlxyXG4gICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtY2VudGVyIHRleHQtcHVycGxlLTQwMCBmb250LXNlbWlib2xkIG1iLThcIj5cclxuICAgICAgICAgIHtmb3JtYXRQaG9uZShwaG9uZSl9XHJcbiAgICAgICAgPC9wPlxyXG5cclxuICAgICAgICB7LyogSW5wdXQgZG8gY8OzZGlnbyAqL31cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktNlwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGp1c3RpZnktY2VudGVyIGdhcC0yIG1iLThcIj5cclxuICAgICAgICAgICAge2NvZGUubWFwKChkaWdpdCwgaW5kZXgpID0+IChcclxuICAgICAgICAgICAgICA8SW5wdXRcclxuICAgICAgICAgICAgICAgIGtleT17aW5kZXh9XHJcbiAgICAgICAgICAgICAgICBpZD17YGNvZGUtJHtpbmRleH1gfVxyXG4gICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxyXG4gICAgICAgICAgICAgICAgaW5wdXRNb2RlPVwibnVtZXJpY1wiXHJcbiAgICAgICAgICAgICAgICBtYXhMZW5ndGg9ezF9XHJcbiAgICAgICAgICAgICAgICB2YWx1ZT17ZGlnaXR9XHJcbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IGhhbmRsZUNvZGVDaGFuZ2UoaW5kZXgsIGUudGFyZ2V0LnZhbHVlKX1cclxuICAgICAgICAgICAgICAgIG9uS2V5RG93bj17KGUpID0+IGhhbmRsZUtleURvd24oaW5kZXgsIGUpfVxyXG4gICAgICAgICAgICAgICAgb25QYXN0ZT17aW5kZXggPT09IDAgPyBoYW5kbGVQYXN0ZSA6IHVuZGVmaW5lZH1cclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctMTIgaC0xNCB0ZXh0LWNlbnRlciB0ZXh0LTJ4bCBmb250LWJvbGQgZ2xhc3MtZWZmZWN0IGJvcmRlci13aGl0ZS8xMFwiXHJcbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17aXNMb2FkaW5nfVxyXG4gICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICkpfVxyXG4gICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgPEJ1dHRvblxyXG4gICAgICAgICAgICBvbkNsaWNrPXtoYW5kbGVWZXJpZnl9XHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cInctZnVsbCBiZy1ncmFkaWVudC10by1yIGZyb20tcHVycGxlLTUwMCB0by1waW5rLTUwMCBob3Zlcjpmcm9tLXB1cnBsZS02MDAgaG92ZXI6dG8tcGluay02MDAgaC0xMiB0ZXh0LWJhc2UgZm9udC1zZW1pYm9sZFwiXHJcbiAgICAgICAgICAgIGRpc2FibGVkPXtpc0xvYWRpbmcgfHwgY29kZS5zb21lKGMgPT4gIWMpfVxyXG4gICAgICAgICAgPlxyXG4gICAgICAgICAgICB7aXNMb2FkaW5nID8gJ1ZlcmlmaWNhbmRvLi4uJyA6ICdWZXJpZmljYXInfVxyXG4gICAgICAgICAgPC9CdXR0b24+XHJcblxyXG4gICAgICAgICAgey8qIFJlZW52aWFyIGPDs2RpZ28gKi99XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtY2VudGVyXCI+XHJcbiAgICAgICAgICAgIHtjYW5SZXNlbmQgPyAoXHJcbiAgICAgICAgICAgICAgPGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlUmVzZW5kfVxyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidGV4dC1wdXJwbGUtNDAwIGhvdmVyOnRleHQtcHVycGxlLTMwMCBmb250LXNlbWlib2xkIHRleHQtc21cIlxyXG4gICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2lzTG9hZGluZ31cclxuICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICBSZWVudmlhciBjw7NkaWdvXHJcbiAgICAgICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC13aGl0ZS82MCB0ZXh0LXNtXCI+XHJcbiAgICAgICAgICAgICAgICBSZWVudmlhciBjw7NkaWdvIGVtIHtjb3VudGRvd259c1xyXG4gICAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICAgKX1cclxuICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgIHsvKiBJbmZvcm1hw6fDo28gYWRpY2lvbmFsICovfVxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtdC02IHAtNCByb3VuZGVkLWxnIGJnLXdoaXRlLzUgYm9yZGVyIGJvcmRlci13aGl0ZS8xMFwiPlxyXG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXdoaXRlLzYwIHRleHQtc20gdGV4dC1jZW50ZXJcIj5cclxuICAgICAgICAgICAgICBOw6NvIHJlY2ViZXUgbyBjw7NkaWdvPyBWZXJpZmlxdWUgc2UgbyBuw7ptZXJvIGVzdMOhIGNvcnJldG8gb3UgdGVudGUgcmVlbnZpYXIuXHJcbiAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvbW90aW9uLmRpdj5cclxuICApO1xyXG59O1xyXG5cclxuUGhvbmVWZXJpZmljYXRpb24ucHJvcFR5cGVzID0ge1xyXG4gIHVzZXJJZDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxyXG4gIHBob25lOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXHJcbiAgb25WZXJpZmllZDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcclxuICBvbkJhY2s6IFByb3BUeXBlcy5mdW5jLCAvLyDinIUgQWdvcmEgw6kgb3BjaW9uYWxcclxufTtcclxuXHJcblBob25lVmVyaWZpY2F0aW9uLmRlZmF1bHRQcm9wcyA9IHtcclxuICBvbkJhY2s6ICgpID0+IHdpbmRvdy5oaXN0b3J5LmJhY2soKSwgLy8g4pyFIFZhbG9yIHBhZHLDo29cclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBob25lVmVyaWZpY2F0aW9uOyJdLCJ2ZXJzaW9uIjozfQ==