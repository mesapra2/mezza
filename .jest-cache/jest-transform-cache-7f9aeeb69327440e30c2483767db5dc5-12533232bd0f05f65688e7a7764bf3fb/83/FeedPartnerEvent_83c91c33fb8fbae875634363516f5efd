38d5a42e5041fd22c2cccd64b73b5e66
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const jsx_runtime_1 = require("react/jsx-runtime");
// src/pages/FeedPartnerEvent.jsx
const react_1 = require("react");
const react_helmet_async_1 = require("react-helmet-async");
const framer_motion_1 = require("framer-motion");
const react_router_dom_1 = require("react-router-dom");
const lucide_react_1 = require("lucide-react");
const input_1 = require("@/features/shared/components/ui/input");
const button_1 = require("@/features/shared/components/ui/button");
const supabaseClient_1 = require("@/lib/supabaseClient");
const date_fns_1 = require("date-fns");
const locale_1 = require("date-fns/locale");
const Avatar_1 = tslib_1.__importDefault(require("@/features/shared/components/profile/Avatar"));
const FeedPartnerEvent = () => {
    const [events, setEvents] = (0, react_1.useState)([]);
    const [filteredEvents, setFilteredEvents] = (0, react_1.useState)([]);
    const [eventParticipantsMap, setEventParticipantsMap] = (0, react_1.useState)({});
    const [searchTerm, setSearchTerm] = (0, react_1.useState)('');
    const [loading, setLoading] = (0, react_1.useState)(true);
    const [error, setError] = (0, react_1.useState)(null);
    // Helper para Avatar
    const getAvatarUrl = (profile, nameFallback = 'U') => {
        if (profile?.avatar_url)
            return profile.avatar_url;
        return `https://ui-avatars.com/api/?name=${encodeURIComponent(profile?.username || profile?.full_name || nameFallback)}&background=8b5cf6&color=fff&size=40`;
    };
    const loadEvents = (0, react_1.useCallback)(async () => {
        setLoading(true);
        setError(null);
        try {
            let { data, error: fetchError } = await supabaseClient_1.supabase
                .from('events')
                .select(`
          *,
          partner:partners(id, name, address),
          creator:profiles!events_creator_id_fkey(
            id,
            username,
            avatar_url,
            full_name,
            public_profile
          )
        `)
                .eq('event_type', 'institucional') // <-- FILTRO PRINCIPAL
                .order('start_time', { ascending: true });
            // Fallbacks (mantidos por segurança)
            if (fetchError && !data) {
                const fallback = await supabaseClient_1.supabase.from('events').select(`*, partner:partners(id, name, address)`).eq('event_type', 'institucional').order('start_time', { ascending: true });
                data = fallback.data;
                fetchError = fallback.error;
            }
            if (fetchError && !data) {
                const simple = await supabaseClient_1.supabase.from('events').select('*').eq('event_type', 'institucional').order('start_time', { ascending: true });
                data = simple.data;
                fetchError = simple.error;
            }
            if (fetchError)
                throw fetchError;
            if (!data)
                data = [];
            const now = new Date();
            const validEvents = data.filter(event => {
                try {
                    const eventDate = new Date(event.start_time);
                    if (isNaN(eventDate.getTime()))
                        return false;
                    const isFuture = eventDate >= now;
                    const statusLower = typeof event.status === 'string' ? event.status.toLowerCase() : '';
                    const hasValidStatus = ['aberto', 'confirmado'].includes(statusLower);
                    return isFuture && hasValidStatus;
                }
                catch (e) {
                    return false;
                }
            });
            setEvents(validEvents);
            // Busca participantes em lote
            if (validEvents.length > 0) {
                const eventIds = validEvents.map(e => e.id);
                const { data: participationsData, error: participantsError } = await supabaseClient_1.supabase
                    .from('event_participants')
                    .select('event_id, profile:profiles(id, username, avatar_url, full_name, public_profile)')
                    .in('event_id', eventIds)
                    .eq('status', 'aprovado');
                if (participantsError) {
                    console.error("Erro ao buscar participantes:", participantsError);
                }
                else if (participationsData) {
                    const participantsMap = participationsData.reduce((acc, participation) => {
                        if (!participation.profile)
                            return acc;
                        const eventId = participation.event_id;
                        if (!acc[eventId])
                            acc[eventId] = [];
                        acc[eventId].push(participation.profile);
                        return acc;
                    }, {});
                    setEventParticipantsMap(participantsMap);
                }
            }
            else {
                setEventParticipantsMap({});
            }
        }
        catch (error) {
            console.error('Erro ao carregar eventos:', error);
            setError('Erro ao carregar eventos. Tente novamente.');
        }
        finally {
            setLoading(false);
        }
    }, []); // Roda só uma vez
    (0, react_1.useEffect)(() => {
        loadEvents();
    }, [loadEvents]);
    const filterEvents = (0, react_1.useCallback)(() => {
        let filtered = events;
        if (searchTerm) {
            const lowerSearch = searchTerm.toLowerCase();
            filtered = filtered.filter(e => e.title?.toLowerCase().includes(lowerSearch) ||
                e.description?.toLowerCase().includes(lowerSearch) ||
                e.hashtags?.some(tag => tag.toLowerCase().includes(lowerSearch)) ||
                e.creator?.username?.toLowerCase().includes(lowerSearch) ||
                e.partner?.name?.toLowerCase().includes(lowerSearch));
        }
        setFilteredEvents(filtered);
    }, [events, searchTerm]);
    (0, react_1.useEffect)(() => {
        filterEvents();
    }, [filterEvents]);
    const getPartnerAddress = (partner) => {
        if (!partner)
            return 'Local não informado';
        if (!partner.address)
            return partner.name;
        if (typeof partner.address === 'string') {
            try {
                const parsed = JSON.parse(partner.address);
                if (parsed.city || parsed.cidade)
                    return `${partner.name} - ${parsed.city || parsed.cidade}`;
            }
            catch (e) { /* ignora erro de parse */ }
            return `${partner.name} - ${partner.address}`;
        }
        if (typeof partner.address === 'object') {
            const parts = [
                partner.address.street || partner.address.rua,
                partner.address.city || partner.address.cidade,
            ].filter(Boolean);
            return parts.length > 0 ? `${partner.name} - ${parts.join(', ')}` : partner.name;
        }
        return partner.name;
    };
    if (loading) {
        return ((0, jsx_runtime_1.jsx)("div", { className: "flex items-center justify-center min-h-[calc(100vh-200px)]", children: (0, jsx_runtime_1.jsx)(lucide_react_1.Calendar, { className: "w-16 h-16 text-white/40 animate-spin" }) }));
    }
    if (error) {
        return ((0, jsx_runtime_1.jsxs)("div", { className: "flex flex-col items-center justify-center min-h-[calc(100vh-200px)]", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Calendar, { className: "w-16 h-16 text-red-400 mb-4" }), (0, jsx_runtime_1.jsx)("p", { className: "text-white/60 text-lg mb-4", children: error }), (0, jsx_runtime_1.jsx)(button_1.Button, { onClick: loadEvents, className: "bg-purple-600 hover:bg-purple-700", children: "Tentar Novamente" })] }));
    }
    return ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsxs)(react_helmet_async_1.Helmet, { children: [(0, jsx_runtime_1.jsx)("title", { children: "Eventos Institucionais - Mesapra2" }), (0, jsx_runtime_1.jsx)("meta", { name: "description", content: "Descubra eventos institucionais de parceiros." })] }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-8 py-6 px-4", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex flex-col md:flex-row md:items-center md:justify-between gap-4", children: (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("h1", { className: "text-4xl font-bold gradient-text mb-2", children: "Eventos Institucionais" }), (0, jsx_runtime_1.jsx)("p", { className: "text-white/60 text-lg", children: "Veja os eventos criados por outros parceiros" }), filteredEvents.length > 0 && ((0, jsx_runtime_1.jsxs)("p", { className: "text-white/40 text-sm mt-2", children: [filteredEvents.length, " ", filteredEvents.length === 1 ? 'evento encontrado' : 'eventos encontrados'] }))] }) }), (0, jsx_runtime_1.jsx)("div", { className: "glass-effect rounded-2xl p-6 border border-white/10", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex-1 relative", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Search, { className: "absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-white/40" }), (0, jsx_runtime_1.jsx)(input_1.Input, { placeholder: "Buscar eventos, hashtags, local, criador...", value: searchTerm, onChange: (e) => setSearchTerm(e.target.value), className: "pl-10 glass-effect border-white/10" })] }) }), (0, jsx_runtime_1.jsx)("div", { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6", children: filteredEvents.map((event, index) => {
                            const participantsForEvent = eventParticipantsMap[event.id] || [];
                            return ((0, jsx_runtime_1.jsx)(framer_motion_1.motion.div, { initial: { opacity: 0, y: 20 }, animate: { opacity: 1, y: 0 }, transition: { delay: index * 0.05 }, children: (0, jsx_runtime_1.jsx)(react_router_dom_1.Link, { to: `/event/${event.id}`, children: (0, jsx_runtime_1.jsxs)("div", { className: "glass-effect rounded-2xl p-6 border border-white/10 hover:bg-white/5 transition-colors cursor-pointer h-full flex flex-col justify-between", children: [(0, jsx_runtime_1.jsxs)("div", { children: [event.creator && ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2 mb-4", children: [(0, jsx_runtime_1.jsx)(Avatar_1.default, { url: getAvatarUrl(event.creator), name: event.creator.username || event.creator.full_name, size: "sm", isPublic: event.creator.public_profile }), (0, jsx_runtime_1.jsxs)("div", { className: 'min-w-0', children: [(0, jsx_runtime_1.jsx)("p", { className: "text-white/80 text-sm font-medium truncate", children: event.creator.username || event.creator.full_name || 'Anfitrião' }), (0, jsx_runtime_1.jsx)("p", { className: "text-white/50 text-xs", children: "Organizador" })] })] })), (0, jsx_runtime_1.jsx)("div", { className: "flex items-start justify-between mb-4", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex-1", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2 mb-2 flex-wrap", children: [(0, jsx_runtime_1.jsx)("span", { className: "px-2 py-1 rounded-full text-xs font-medium bg-blue-500/20 text-blue-300", children: "Institucional" }), (0, jsx_runtime_1.jsx)("span", { className: "px-2 py-1 rounded-full text-xs font-medium bg-green-500/20 text-green-300", children: event.status })] }), (0, jsx_runtime_1.jsx)("h3", { className: "text-lg font-semibold text-white mb-2 line-clamp-2", children: event.title }), (0, jsx_runtime_1.jsx)("p", { className: "text-white/60 text-sm line-clamp-2 mb-3", children: event.description })] }) }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-2", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center text-white/60 text-sm", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Calendar, { className: "w-4 h-4 mr-2 flex-shrink-0" }), (0, jsx_runtime_1.jsx)("span", { className: "truncate", children: (0, date_fns_1.format)(new Date(event.start_time), "dd/MM 'às' HH:mm", { locale: locale_1.ptBR }) })] }), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center text-white/60 text-sm", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Clock, { className: "w-4 h-4 mr-2 flex-shrink-0" }), (0, jsx_runtime_1.jsxs)("span", { className: "truncate", children: ["at\u00E9 ", (0, date_fns_1.format)(new Date(event.end_time), "HH:mm", { locale: locale_1.ptBR })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center text-white/60 text-sm", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.MapPin, { className: "w-4 h-4 mr-2 flex-shrink-0" }), (0, jsx_runtime_1.jsx)("span", { className: "truncate", children: getPartnerAddress(event.partner) })] }), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center text-white/60 text-sm", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Users, { className: "w-4 h-4 mr-2 flex-shrink-0" }), event.vagas, " ", event.vagas === 1 ? 'vaga disponível' : 'vagas disponíveis'] })] }), event.hashtags && event.hashtags.length > 0 && ((0, jsx_runtime_1.jsx)("div", { className: "flex flex-wrap gap-2 mt-4", children: event.hashtags.slice(0, 3).map((tag, i) => ((0, jsx_runtime_1.jsxs)("span", { className: "px-2 py-1 rounded-full bg-purple-500/20 text-purple-300 text-xs flex items-center", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Tag, { className: "w-3 h-3 mr-1" }), "#", tag] }, i))) }))] }), (0, jsx_runtime_1.jsx)("div", { className: "mt-4 pt-4 border-t border-white/10", children: participantsForEvent.length > 0 ? ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsxs)("h4", { className: "text-sm font-medium text-white/80 mb-2", children: ["Participantes (", participantsForEvent.length, ")"] }), (0, jsx_runtime_1.jsx)("div", { className: "flex flex-wrap gap-2", children: participantsForEvent.slice(0, 5).map(participant => ((0, jsx_runtime_1.jsx)(Avatar_1.default, { url: getAvatarUrl(participant), name: participant.username || participant.full_name, size: "xs", isPublic: participant.public_profile }, participant.id))) })] })) : ((0, jsx_runtime_1.jsx)("p", { className: "text-xs text-white/50", children: "Seja o primeiro a participar!" })) })] }) }) }, event.id));
                        }) }), filteredEvents.length === 0 && !loading && ((0, jsx_runtime_1.jsxs)("div", { className: "glass-effect rounded-2xl p-12 border border-white/10 text-center mt-8", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Calendar, { className: "w-16 h-16 text-white/20 mx-auto mb-4" }), (0, jsx_runtime_1.jsx)("p", { className: "text-white/60 text-lg mb-4", children: "Nenhum evento institucional encontrado" })] }))] })] }));
};
exports.default = FeedPartnerEvent;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxmZWF0dXJlc1xccGFydG5lclxccGFnZXNcXEZlZWRQYXJ0bmVyRXZlbnQuanN4IiwibWFwcGluZ3MiOiI7Ozs7QUFBQSxpQ0FBaUM7QUFDakMsaUNBQXlEO0FBQ3pELDJEQUE0QztBQUM1QyxpREFBdUM7QUFDdkMsdURBQXdDO0FBQ3hDLCtDQUEyRTtBQUMzRSxpRUFBOEQ7QUFDOUQsbUVBQWdFO0FBQ2hFLHlEQUFnRDtBQUNoRCx1Q0FBa0M7QUFDbEMsNENBQXVDO0FBQ3ZDLGlHQUFpRTtBQUVqRSxNQUFNLGdCQUFnQixHQUFHLEdBQUcsRUFBRTtJQUM1QixNQUFNLENBQUMsTUFBTSxFQUFFLFNBQVMsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxFQUFFLENBQUMsQ0FBQztJQUN6QyxNQUFNLENBQUMsY0FBYyxFQUFFLGlCQUFpQixDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ3pELE1BQU0sQ0FBQyxvQkFBb0IsRUFBRSx1QkFBdUIsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxFQUFFLENBQUMsQ0FBQztJQUNyRSxNQUFNLENBQUMsVUFBVSxFQUFFLGFBQWEsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxFQUFFLENBQUMsQ0FBQztJQUNqRCxNQUFNLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxJQUFJLENBQUMsQ0FBQztJQUM3QyxNQUFNLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxJQUFJLENBQUMsQ0FBQztJQUV6QyxxQkFBcUI7SUFDckIsTUFBTSxZQUFZLEdBQUcsQ0FBQyxPQUFPLEVBQUUsWUFBWSxHQUFHLEdBQUcsRUFBRSxFQUFFO1FBQ25ELElBQUksT0FBTyxFQUFFLFVBQVU7WUFBRSxPQUFPLE9BQU8sQ0FBQyxVQUFVLENBQUM7UUFDbkQsT0FBTyxvQ0FBb0Msa0JBQWtCLENBQzNELE9BQU8s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ZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxERVZNaXhcXEFwcC5NZXNhcHJhMi5jb21cXHNyY1xcZmVhdHVyZXNcXHBhcnRuZXJcXHBhZ2VzXFxGZWVkUGFydG5lckV2ZW50LmpzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvcGFnZXMvRmVlZFBhcnRuZXJFdmVudC5qc3hcclxuaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IEhlbG1ldCB9IGZyb20gXCJyZWFjdC1oZWxtZXQtYXN5bmNcIjtcclxuaW1wb3J0IHsgbW90aW9uIH0gZnJvbSAnZnJhbWVyLW1vdGlvbic7XHJcbmltcG9ydCB7IExpbmsgfSBmcm9tICdyZWFjdC1yb3V0ZXItZG9tJztcclxuaW1wb3J0IHsgU2VhcmNoLCBDYWxlbmRhciwgVXNlcnMsIE1hcFBpbiwgVGFnLCBDbG9jayB9IGZyb20gJ2x1Y2lkZS1yZWFjdCc7XHJcbmltcG9ydCB7IElucHV0IH0gZnJvbSAnQC9mZWF0dXJlcy9zaGFyZWQvY29tcG9uZW50cy91aS9pbnB1dCc7XHJcbmltcG9ydCB7IEJ1dHRvbiB9IGZyb20gJ0AvZmVhdHVyZXMvc2hhcmVkL2NvbXBvbmVudHMvdWkvYnV0dG9uJztcclxuaW1wb3J0IHsgc3VwYWJhc2UgfSBmcm9tICdAL2xpYi9zdXBhYmFzZUNsaWVudCc7XHJcbmltcG9ydCB7IGZvcm1hdCB9IGZyb20gJ2RhdGUtZm5zJztcclxuaW1wb3J0IHsgcHRCUiB9IGZyb20gJ2RhdGUtZm5zL2xvY2FsZSc7XHJcbmltcG9ydCBBdmF0YXIgZnJvbSAnQC9mZWF0dXJlcy9zaGFyZWQvY29tcG9uZW50cy9wcm9maWxlL0F2YXRhcic7XHJcblxyXG5jb25zdCBGZWVkUGFydG5lckV2ZW50ID0gKCkgPT4ge1xyXG4gIGNvbnN0IFtldmVudHMsIHNldEV2ZW50c10gPSB1c2VTdGF0ZShbXSk7XHJcbiAgY29uc3QgW2ZpbHRlcmVkRXZlbnRzLCBzZXRGaWx0ZXJlZEV2ZW50c10gPSB1c2VTdGF0ZShbXSk7XHJcbiAgY29uc3QgW2V2ZW50UGFydGljaXBhbnRzTWFwLCBzZXRFdmVudFBhcnRpY2lwYW50c01hcF0gPSB1c2VTdGF0ZSh7fSk7XHJcbiAgY29uc3QgW3NlYXJjaFRlcm0sIHNldFNlYXJjaFRlcm1dID0gdXNlU3RhdGUoJycpO1xyXG4gIGNvbnN0IFtsb2FkaW5nLCBzZXRMb2FkaW5nXSA9IHVzZVN0YXRlKHRydWUpO1xyXG4gIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gdXNlU3RhdGUobnVsbCk7XHJcblxyXG4gIC8vIEhlbHBlciBwYXJhIEF2YXRhclxyXG4gIGNvbnN0IGdldEF2YXRhclVybCA9IChwcm9maWxlLCBuYW1lRmFsbGJhY2sgPSAnVScpID0+IHtcclxuICAgIGlmIChwcm9maWxlPy5hdmF0YXJfdXJsKSByZXR1cm4gcHJvZmlsZS5hdmF0YXJfdXJsO1xyXG4gICAgcmV0dXJuIGBodHRwczovL3VpLWF2YXRhcnMuY29tL2FwaS8/bmFtZT0ke2VuY29kZVVSSUNvbXBvbmVudChcclxuICAgICAgcHJvZmlsZT8udXNlcm5hbWUgfHwgcHJvZmlsZT8uZnVsbF9uYW1lIHx8IG5hbWVGYWxsYmFja1xyXG4gICAgKX0mYmFja2dyb3VuZD04YjVjZjYmY29sb3I9ZmZmJnNpemU9NDBgO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGxvYWRFdmVudHMgPSB1c2VDYWxsYmFjayhhc3luYyAoKSA9PiB7XHJcbiAgICBzZXRMb2FkaW5nKHRydWUpO1xyXG4gICAgc2V0RXJyb3IobnVsbCk7XHJcbiAgICB0cnkge1xyXG4gICAgICBsZXQgeyBkYXRhLCBlcnJvcjogZmV0Y2hFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgnZXZlbnRzJylcclxuICAgICAgICAuc2VsZWN0KGBcclxuICAgICAgICAgICosXHJcbiAgICAgICAgICBwYXJ0bmVyOnBhcnRuZXJzKGlkLCBuYW1lLCBhZGRyZXNzKSxcclxuICAgICAgICAgIGNyZWF0b3I6cHJvZmlsZXMhZXZlbnRzX2NyZWF0b3JfaWRfZmtleShcclxuICAgICAgICAgICAgaWQsXHJcbiAgICAgICAgICAgIHVzZXJuYW1lLFxyXG4gICAgICAgICAgICBhdmF0YXJfdXJsLFxyXG4gICAgICAgICAgICBmdWxsX25hbWUsXHJcbiAgICAgICAgICAgIHB1YmxpY19wcm9maWxlXHJcbiAgICAgICAgICApXHJcbiAgICAgICAgYClcclxuICAgICAgICAuZXEoJ2V2ZW50X3R5cGUnLCAnaW5zdGl0dWNpb25hbCcpIC8vIDwtLSBGSUxUUk8gUFJJTkNJUEFMXHJcbiAgICAgICAgLm9yZGVyKCdzdGFydF90aW1lJywgeyBhc2NlbmRpbmc6IHRydWUgfSk7XHJcblxyXG4gICAgICAvLyBGYWxsYmFja3MgKG1hbnRpZG9zIHBvciBzZWd1cmFuw6dhKVxyXG4gICAgICBpZiAoZmV0Y2hFcnJvciAmJiAhZGF0YSkge1xyXG4gICAgICAgIGNvbnN0IGZhbGxiYWNrID0gYXdhaXQgc3VwYWJhc2UuZnJvbSgnZXZlbnRzJykuc2VsZWN0KGAqLCBwYXJ0bmVyOnBhcnRuZXJzKGlkLCBuYW1lLCBhZGRyZXNzKWApLmVxKCdldmVudF90eXBlJywgJ2luc3RpdHVjaW9uYWwnKS5vcmRlcignc3RhcnRfdGltZScsIHsgYXNjZW5kaW5nOiB0cnVlIH0pO1xyXG4gICAgICAgIGRhdGEgPSBmYWxsYmFjay5kYXRhO1xyXG4gICAgICAgIGZldGNoRXJyb3IgPSBmYWxsYmFjay5lcnJvcjtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZmV0Y2hFcnJvciAmJiAhZGF0YSkge1xyXG4gICAgICAgIGNvbnN0IHNpbXBsZSA9IGF3YWl0IHN1cGFiYXNlLmZyb20oJ2V2ZW50cycpLnNlbGVjdCgnKicpLmVxKCdldmVudF90eXBlJywgJ2luc3RpdHVjaW9uYWwnKS5vcmRlcignc3RhcnRfdGltZScsIHsgYXNjZW5kaW5nOiB0cnVlIH0pO1xyXG4gICAgICAgIGRhdGEgPSBzaW1wbGUuZGF0YTtcclxuICAgICAgICBmZXRjaEVycm9yID0gc2ltcGxlLmVycm9yO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChmZXRjaEVycm9yKSB0aHJvdyBmZXRjaEVycm9yO1xyXG4gICAgICBpZiAoIWRhdGEpIGRhdGEgPSBbXTtcclxuXHJcbiAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XHJcbiAgICAgIGNvbnN0IHZhbGlkRXZlbnRzID0gZGF0YS5maWx0ZXIoZXZlbnQgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50RGF0ZSA9IG5ldyBEYXRlKGV2ZW50LnN0YXJ0X3RpbWUpO1xyXG4gICAgICAgICAgICBpZiAoaXNOYU4oZXZlbnREYXRlLmdldFRpbWUoKSkpIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgY29uc3QgaXNGdXR1cmUgPSBldmVudERhdGUgPj0gbm93O1xyXG4gICAgICAgICAgICBjb25zdCBzdGF0dXNMb3dlciA9IHR5cGVvZiBldmVudC5zdGF0dXMgPT09ICdzdHJpbmcnID8gZXZlbnQuc3RhdHVzLnRvTG93ZXJDYXNlKCkgOiAnJztcclxuICAgICAgICAgICAgY29uc3QgaGFzVmFsaWRTdGF0dXMgPSBbJ2FiZXJ0bycsICdjb25maXJtYWRvJ10uaW5jbHVkZXMoc3RhdHVzTG93ZXIpO1xyXG4gICAgICAgICAgICByZXR1cm4gaXNGdXR1cmUgJiYgaGFzVmFsaWRTdGF0dXM7XHJcbiAgICAgICAgfSBjYXRjaChlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgc2V0RXZlbnRzKHZhbGlkRXZlbnRzKTtcclxuXHJcbiAgICAgIC8vIEJ1c2NhIHBhcnRpY2lwYW50ZXMgZW0gbG90ZVxyXG4gICAgICBpZiAodmFsaWRFdmVudHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGNvbnN0IGV2ZW50SWRzID0gdmFsaWRFdmVudHMubWFwKGUgPT4gZS5pZCk7XHJcbiAgICAgICAgY29uc3QgeyBkYXRhOiBwYXJ0aWNpcGF0aW9uc0RhdGEsIGVycm9yOiBwYXJ0aWNpcGFudHNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAgIC5mcm9tKCdldmVudF9wYXJ0aWNpcGFudHMnKVxyXG4gICAgICAgICAgLnNlbGVjdCgnZXZlbnRfaWQsIHByb2ZpbGU6cHJvZmlsZXMoaWQsIHVzZXJuYW1lLCBhdmF0YXJfdXJsLCBmdWxsX25hbWUsIHB1YmxpY19wcm9maWxlKScpXHJcbiAgICAgICAgICAuaW4oJ2V2ZW50X2lkJywgZXZlbnRJZHMpXHJcbiAgICAgICAgICAuZXEoJ3N0YXR1cycsICdhcHJvdmFkbycpO1xyXG5cclxuICAgICAgICBpZiAocGFydGljaXBhbnRzRXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvIGFvIGJ1c2NhciBwYXJ0aWNpcGFudGVzOlwiLCBwYXJ0aWNpcGFudHNFcnJvcik7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXJ0aWNpcGF0aW9uc0RhdGEpIHtcclxuICAgICAgICAgIGNvbnN0IHBhcnRpY2lwYW50c01hcCA9IHBhcnRpY2lwYXRpb25zRGF0YS5yZWR1Y2UoKGFjYywgcGFydGljaXBhdGlvbikgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXBhcnRpY2lwYXRpb24ucHJvZmlsZSkgcmV0dXJuIGFjYztcclxuICAgICAgICAgICAgY29uc3QgZXZlbnRJZCA9IHBhcnRpY2lwYXRpb24uZXZlbnRfaWQ7XHJcbiAgICAgICAgICAgIGlmICghYWNjW2V2ZW50SWRdKSBhY2NbZXZlbnRJZF0gPSBbXTtcclxuICAgICAgICAgICAgYWNjW2V2ZW50SWRdLnB1c2gocGFydGljaXBhdGlvbi5wcm9maWxlKTtcclxuICAgICAgICAgICAgcmV0dXJuIGFjYztcclxuICAgICAgICAgIH0sIHt9KTtcclxuICAgICAgICAgIHNldEV2ZW50UGFydGljaXBhbnRzTWFwKHBhcnRpY2lwYW50c01hcCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHNldEV2ZW50UGFydGljaXBhbnRzTWFwKHt9KTtcclxuICAgICAgfVxyXG5cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gYW8gY2FycmVnYXIgZXZlbnRvczonLCBlcnJvcik7XHJcbiAgICAgIHNldEVycm9yKCdFcnJvIGFvIGNhcnJlZ2FyIGV2ZW50b3MuIFRlbnRlIG5vdmFtZW50ZS4nKTtcclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgIHNldExvYWRpbmcoZmFsc2UpO1xyXG4gICAgfVxyXG4gIH0sIFtdKTsgLy8gUm9kYSBzw7MgdW1hIHZlelxyXG5cclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgbG9hZEV2ZW50cygpO1xyXG4gIH0sIFtsb2FkRXZlbnRzXSk7XHJcblxyXG4gIGNvbnN0IGZpbHRlckV2ZW50cyA9IHVzZUNhbGxiYWNrKCgpID0+IHtcclxuICAgIGxldCBmaWx0ZXJlZCA9IGV2ZW50cztcclxuICAgIGlmIChzZWFyY2hUZXJtKSB7XHJcbiAgICAgIGNvbnN0IGxvd2VyU2VhcmNoID0gc2VhcmNoVGVybS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICBmaWx0ZXJlZCA9IGZpbHRlcmVkLmZpbHRlcihlID0+XHJcbiAgICAgICAgZS50aXRsZT8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhsb3dlclNlYXJjaCkgfHxcclxuICAgICAgICBlLmRlc2NyaXB0aW9uPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyU2VhcmNoKSB8fFxyXG4gICAgICAgIGUuaGFzaHRhZ3M/LnNvbWUodGFnID0+IHRhZy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyU2VhcmNoKSkgfHxcclxuICAgICAgICBlLmNyZWF0b3I/LnVzZXJuYW1lPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyU2VhcmNoKSB8fFxyXG4gICAgICAgIGUucGFydG5lcj8ubmFtZT8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhsb3dlclNlYXJjaClcclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIHNldEZpbHRlcmVkRXZlbnRzKGZpbHRlcmVkKTtcclxuICB9LCBbZXZlbnRzLCBzZWFyY2hUZXJtXSk7XHJcblxyXG5cclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgZmlsdGVyRXZlbnRzKCk7XHJcbiAgfSwgW2ZpbHRlckV2ZW50c10pO1xyXG5cclxuXHJcbiAgY29uc3QgZ2V0UGFydG5lckFkZHJlc3MgPSAocGFydG5lcikgPT4ge1xyXG4gICAgaWYgKCFwYXJ0bmVyKSByZXR1cm4gJ0xvY2FsIG7Do28gaW5mb3JtYWRvJztcclxuICAgIGlmICghcGFydG5lci5hZGRyZXNzKSByZXR1cm4gcGFydG5lci5uYW1lO1xyXG4gICAgaWYgKHR5cGVvZiBwYXJ0bmVyLmFkZHJlc3MgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShwYXJ0bmVyLmFkZHJlc3MpO1xyXG4gICAgICAgICAgICBpZiAocGFyc2VkLmNpdHkgfHwgcGFyc2VkLmNpZGFkZSkgcmV0dXJuIGAke3BhcnRuZXIubmFtZX0gLSAke3BhcnNlZC5jaXR5IHx8IHBhcnNlZC5jaWRhZGV9YDtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IC8qIGlnbm9yYSBlcnJvIGRlIHBhcnNlICovIH1cclxuICAgICAgICByZXR1cm4gYCR7cGFydG5lci5uYW1lfSAtICR7cGFydG5lci5hZGRyZXNzfWA7XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIHBhcnRuZXIuYWRkcmVzcyA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgY29uc3QgcGFydHMgPSBbXHJcbiAgICAgICAgcGFydG5lci5hZGRyZXNzLnN0cmVldCB8fCBwYXJ0bmVyLmFkZHJlc3MucnVhLFxyXG4gICAgICAgIHBhcnRuZXIuYWRkcmVzcy5jaXR5IHx8IHBhcnRuZXIuYWRkcmVzcy5jaWRhZGUsXHJcbiAgICAgIF0uZmlsdGVyKEJvb2xlYW4pO1xyXG4gICAgICByZXR1cm4gcGFydHMubGVuZ3RoID4gMCA/IGAke3BhcnRuZXIubmFtZX0gLSAke3BhcnRzLmpvaW4oJywgJyl9YCA6IHBhcnRuZXIubmFtZTtcclxuICAgIH1cclxuICAgIHJldHVybiBwYXJ0bmVyLm5hbWU7XHJcbiAgfTtcclxuXHJcblxyXG4gIGlmIChsb2FkaW5nKSB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIG1pbi1oLVtjYWxjKDEwMHZoLTIwMHB4KV1cIj5cclxuICAgICAgICA8Q2FsZW5kYXIgY2xhc3NOYW1lPVwidy0xNiBoLTE2IHRleHQtd2hpdGUvNDAgYW5pbWF0ZS1zcGluXCIgLz5cclxuICAgICAgPC9kaXY+XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgaWYgKGVycm9yKSB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZmxleC1jb2wgaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIG1pbi1oLVtjYWxjKDEwMHZoLTIwMHB4KV1cIj5cclxuICAgICAgICA8Q2FsZW5kYXIgY2xhc3NOYW1lPVwidy0xNiBoLTE2IHRleHQtcmVkLTQwMCBtYi00XCIgLz5cclxuICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXdoaXRlLzYwIHRleHQtbGcgbWItNFwiPntlcnJvcn08L3A+XHJcbiAgICAgICAgPEJ1dHRvbiBvbkNsaWNrPXtsb2FkRXZlbnRzfSBjbGFzc05hbWU9XCJiZy1wdXJwbGUtNjAwIGhvdmVyOmJnLXB1cnBsZS03MDBcIj5cclxuICAgICAgICAgIFRlbnRhciBOb3ZhbWVudGVcclxuICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgPC9kaXY+XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIChcclxuICAgIDw+XHJcbiAgICAgIDxIZWxtZXQ+XHJcbiAgICAgICAgPHRpdGxlPkV2ZW50b3MgSW5zdGl0dWNpb25haXMgLSBNZXNhcHJhMjwvdGl0bGU+XHJcbiAgICAgICAgPG1ldGEgbmFtZT1cImRlc2NyaXB0aW9uXCIgY29udGVudD1cIkRlc2N1YnJhIGV2ZW50b3MgaW5zdGl0dWNpb25haXMgZGUgcGFyY2Vpcm9zLlwiIC8+XHJcbiAgICAgIDwvSGVsbWV0PlxyXG5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTggcHktNiBweC00XCI+XHJcbiAgICAgICAgey8qIEhFQURFUiAqL31cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZmxleC1jb2wgbWQ6ZmxleC1yb3cgbWQ6aXRlbXMtY2VudGVyIG1kOmp1c3RpZnktYmV0d2VlbiBnYXAtNFwiPlxyXG4gICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgPGgxIGNsYXNzTmFtZT1cInRleHQtNHhsIGZvbnQtYm9sZCBncmFkaWVudC10ZXh0IG1iLTJcIj5cclxuICAgICAgICAgICAgICBFdmVudG9zIEluc3RpdHVjaW9uYWlzXHJcbiAgICAgICAgICAgIDwvaDE+XHJcbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtd2hpdGUvNjAgdGV4dC1sZ1wiPlxyXG4gICAgICAgICAgICAgIFZlamEgb3MgZXZlbnRvcyBjcmlhZG9zIHBvciBvdXRyb3MgcGFyY2Vpcm9zXHJcbiAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICAge2ZpbHRlcmVkRXZlbnRzLmxlbmd0aCA+IDAgJiYgKFxyXG4gICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtd2hpdGUvNDAgdGV4dC1zbSBtdC0yXCI+XHJcbiAgICAgICAgICAgICAgICB7ZmlsdGVyZWRFdmVudHMubGVuZ3RofSB7ZmlsdGVyZWRFdmVudHMubGVuZ3RoID09PSAxID8gJ2V2ZW50byBlbmNvbnRyYWRvJyA6ICdldmVudG9zIGVuY29udHJhZG9zJ31cclxuICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgICl9XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIHsvKiBCb3TDo28gZGUgQ3JpYXIgcmVtb3ZpZG8gZGFxdWkgKi99XHJcbiAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgIHsvKiBTZWFyY2ggKi99XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJnbGFzcy1lZmZlY3Qgcm91bmRlZC0yeGwgcC02IGJvcmRlciBib3JkZXItd2hpdGUvMTBcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xIHJlbGF0aXZlXCI+XHJcbiAgICAgICAgICAgIDxTZWFyY2ggY2xhc3NOYW1lPVwiYWJzb2x1dGUgbGVmdC0zIHRvcC0xLzIgLXRyYW5zbGF0ZS15LTEvMiB3LTUgaC01IHRleHQtd2hpdGUvNDBcIiAvPlxyXG4gICAgICAgICAgICA8SW5wdXRcclxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkJ1c2NhciBldmVudG9zLCBoYXNodGFncywgbG9jYWwsIGNyaWFkb3IuLi5cIlxyXG4gICAgICAgICAgICAgIHZhbHVlPXtzZWFyY2hUZXJtfVxyXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0U2VhcmNoVGVybShlLnRhcmdldC52YWx1ZSl9XHJcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwicGwtMTAgZ2xhc3MtZWZmZWN0IGJvcmRlci13aGl0ZS8xMFwiXHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIHsvKiBGaWx0cm9zIGRlIHRpcG8gcmVtb3ZpZG9zICovfVxyXG4gICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICB7LyogRXZlbnRzIEdyaWQgKi99XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkIGdyaWQtY29scy0xIG1kOmdyaWQtY29scy0yIGxnOmdyaWQtY29scy0zIGdhcC02XCI+XHJcbiAgICAgICAgICB7ZmlsdGVyZWRFdmVudHMubWFwKChldmVudCwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcGFydGljaXBhbnRzRm9yRXZlbnQgPSBldmVudFBhcnRpY2lwYW50c01hcFtldmVudC5pZF0gfHwgW107XHJcbiAgICAgICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICAgPG1vdGlvbi5kaXZcclxuICAgICAgICAgICAgICAgIGtleT17ZXZlbnQuaWR9XHJcbiAgICAgICAgICAgICAgICBpbml0aWFsPXt7IG9wYWNpdHk6IDAsIHk6IDIwIH19XHJcbiAgICAgICAgICAgICAgICBhbmltYXRlPXt7IG9wYWNpdHk6IDEsIHk6IDAgfX1cclxuICAgICAgICAgICAgICAgIHRyYW5zaXRpb249e3sgZGVsYXk6IGluZGV4ICogMC4wNSB9fVxyXG4gICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDxMaW5rIHRvPXtgL2V2ZW50LyR7ZXZlbnQuaWR9YH0+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ2xhc3MtZWZmZWN0IHJvdW5kZWQtMnhsIHAtNiBib3JkZXIgYm9yZGVyLXdoaXRlLzEwIGhvdmVyOmJnLXdoaXRlLzUgdHJhbnNpdGlvbi1jb2xvcnMgY3Vyc29yLXBvaW50ZXIgaC1mdWxsIGZsZXggZmxleC1jb2wganVzdGlmeS1iZXR3ZWVuXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICAgICAgICAgIHtldmVudC5jcmVhdG9yICYmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBtYi00XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBdmF0YXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsPXtnZXRBdmF0YXJVcmwoZXZlbnQuY3JlYXRvcil9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e2V2ZW50LmNyZWF0b3IudXNlcm5hbWUgfHwgZXZlbnQuY3JlYXRvci5mdWxsX25hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9XCJzbVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUHVibGljPXtldmVudC5jcmVhdG9yLnB1YmxpY19wcm9maWxlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdtaW4tdy0wJz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtd2hpdGUvODAgdGV4dC1zbSBmb250LW1lZGl1bSB0cnVuY2F0ZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZXZlbnQuY3JlYXRvci51c2VybmFtZSB8fCBldmVudC5jcmVhdG9yLmZ1bGxfbmFtZSB8fCAnQW5maXRyacOjbyd9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXdoaXRlLzUwIHRleHQteHNcIj5Pcmdhbml6YWRvcjwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICApfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1zdGFydCBqdXN0aWZ5LWJldHdlZW4gbWItNFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgbWItMiBmbGV4LXdyYXBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJweC0yIHB5LTEgcm91bmRlZC1mdWxsIHRleHQteHMgZm9udC1tZWRpdW0gYmctYmx1ZS01MDAvMjAgdGV4dC1ibHVlLTMwMFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW5zdGl0dWNpb25hbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInB4LTIgcHktMSByb3VuZGVkLWZ1bGwgdGV4dC14cyBmb250LW1lZGl1bSBiZy1ncmVlbi01MDAvMjAgdGV4dC1ncmVlbi0zMDBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2V2ZW50LnN0YXR1c31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8aDMgY2xhc3NOYW1lPVwidGV4dC1sZyBmb250LXNlbWlib2xkIHRleHQtd2hpdGUgbWItMiBsaW5lLWNsYW1wLTJcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtldmVudC50aXRsZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L2gzPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtd2hpdGUvNjAgdGV4dC1zbSBsaW5lLWNsYW1wLTIgbWItM1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge2V2ZW50LmRlc2NyaXB0aW9ufVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktMlwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIHRleHQtd2hpdGUvNjAgdGV4dC1zbVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxDYWxlbmRhciBjbGFzc05hbWU9XCJ3LTQgaC00IG1yLTIgZmxleC1zaHJpbmstMFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidHJ1bmNhdGVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtmb3JtYXQobmV3IERhdGUoZXZlbnQuc3RhcnRfdGltZSksIFwiZGQvTU0gJ8OgcycgSEg6bW1cIiwgeyBsb2NhbGU6IHB0QlIgfSl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciB0ZXh0LXdoaXRlLzYwIHRleHQtc21cIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8Q2xvY2sgY2xhc3NOYW1lPVwidy00IGgtNCBtci0yIGZsZXgtc2hyaW5rLTBcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRydW5jYXRlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdMOpIHtmb3JtYXQobmV3IERhdGUoZXZlbnQuZW5kX3RpbWUpLCBcIkhIOm1tXCIsIHsgbG9jYWxlOiBwdEJSIH0pfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgdGV4dC13aGl0ZS82MCB0ZXh0LXNtXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPE1hcFBpbiBjbGFzc05hbWU9XCJ3LTQgaC00IG1yLTIgZmxleC1zaHJpbmstMFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidHJ1bmNhdGVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtnZXRQYXJ0bmVyQWRkcmVzcyhldmVudC5wYXJ0bmVyKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIHRleHQtd2hpdGUvNjAgdGV4dC1zbVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxVc2VycyBjbGFzc05hbWU9XCJ3LTQgaC00IG1yLTIgZmxleC1zaHJpbmstMFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAge2V2ZW50LnZhZ2FzfSB7ZXZlbnQudmFnYXMgPT09IDEgPyAndmFnYSBkaXNwb27DrXZlbCcgOiAndmFnYXMgZGlzcG9uw612ZWlzJ31cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICB7ZXZlbnQuaGFzaHRhZ3MgJiYgZXZlbnQuaGFzaHRhZ3MubGVuZ3RoID4gMCAmJiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGZsZXgtd3JhcCBnYXAtMiBtdC00XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZXZlbnQuaGFzaHRhZ3Muc2xpY2UoMCwgMykubWFwKCh0YWcsIGkpID0+IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk9e2l9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwicHgtMiBweS0xIHJvdW5kZWQtZnVsbCBiZy1wdXJwbGUtNTAwLzIwIHRleHQtcHVycGxlLTMwMCB0ZXh0LXhzIGZsZXggaXRlbXMtY2VudGVyXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUYWcgY2xhc3NOYW1lPVwidy0zIGgtMyBtci0xXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAje3RhZ31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXQtNCBwdC00IGJvcmRlci10IGJvcmRlci13aGl0ZS8xMFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAge3BhcnRpY2lwYW50c0ZvckV2ZW50Lmxlbmd0aCA+IDAgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDw+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGg0IGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW0gdGV4dC13aGl0ZS84MCBtYi0yXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBhcnRpY2lwYW50ZXMgKHtwYXJ0aWNpcGFudHNGb3JFdmVudC5sZW5ndGh9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvaDQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGZsZXgtd3JhcCBnYXAtMlwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7cGFydGljaXBhbnRzRm9yRXZlbnQuc2xpY2UoMCwgNSkubWFwKHBhcnRpY2lwYW50ID0+IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QXZhdGFyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17cGFydGljaXBhbnQuaWR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybD17Z2V0QXZhdGFyVXJsKHBhcnRpY2lwYW50KX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT17cGFydGljaXBhbnQudXNlcm5hbWUgfHwgcGFydGljaXBhbnQuZnVsbF9uYW1lfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplPVwieHNcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1B1YmxpYz17cGFydGljaXBhbnQucHVibGljX3Byb2ZpbGV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgKSA6IChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC14cyB0ZXh0LXdoaXRlLzUwXCI+U2VqYSBvIHByaW1laXJvIGEgcGFydGljaXBhciE8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvTGluaz5cclxuICAgICAgICAgICAgICA8L21vdGlvbi5kaXY+XHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgIH0pfVxyXG4gICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICB7ZmlsdGVyZWRFdmVudHMubGVuZ3RoID09PSAwICYmICFsb2FkaW5nICYmIChcclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ2xhc3MtZWZmZWN0IHJvdW5kZWQtMnhsIHAtMTIgYm9yZGVyIGJvcmRlci13aGl0ZS8xMCB0ZXh0LWNlbnRlciBtdC04XCI+XHJcbiAgICAgICAgICAgIDxDYWxlbmRhciBjbGFzc05hbWU9XCJ3LTE2IGgtMTYgdGV4dC13aGl0ZS8yMCBteC1hdXRvIG1iLTRcIiAvPlxyXG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXdoaXRlLzYwIHRleHQtbGcgbWItNFwiPlxyXG4gICAgICAgICAgICAgIE5lbmh1bSBldmVudG8gaW5zdGl0dWNpb25hbCBlbmNvbnRyYWRvXHJcbiAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICl9XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC8+XHJcbiAgKTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZlZWRQYXJ0bmVyRXZlbnQ7Il0sInZlcnNpb24iOjN9