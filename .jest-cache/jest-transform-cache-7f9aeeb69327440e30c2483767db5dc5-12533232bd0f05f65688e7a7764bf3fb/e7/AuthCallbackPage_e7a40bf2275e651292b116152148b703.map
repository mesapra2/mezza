{"file":"C:\\DEVMix\\App.Mesapra2.com\\src\\features\\shared\\pages\\AuthCallbackPage.jsx","mappings":"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","names":[],"sources":["C:\\DEVMix\\App.Mesapra2.com\\src\\features\\shared\\pages\\AuthCallbackPage.jsx"],"sourcesContent":["// src/features/auth/pages/AuthCallbackPage.jsx\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useNavigate, useSearchParams } from 'react-router-dom';\r\nimport { Helmet } from 'react-helmet-async';\r\nimport { motion } from 'framer-motion';\r\nimport { CheckCircle, XCircle, Loader2 } from 'lucide-react';\r\nimport { supabase } from '@/lib/supabaseClient';\r\nimport { Button } from '@/features/shared/components/ui/button';\r\n\r\n/**\r\n * Página de callback para processar confirmação de email\r\n * Esta página é chamada quando o usuário clica no link de confirmação enviado por email\r\n */\r\nconst AuthCallbackPage = () => {\r\n  const [searchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  const [status, setStatus] = useState('loading'); // 'loading', 'success', 'error'\r\n  const [message, setMessage] = useState('');\r\n\r\n  useEffect(() => {\r\n    const handleEmailConfirmation = async () => {\r\n      try {\r\n        // Pega os parâmetros da URL\r\n        const token_hash = searchParams.get('token_hash');\r\n        const type = searchParams.get('type');\r\n        \r\n        if (!token_hash || type !== 'email') {\r\n          throw new Error('Link de confirmação inválido');\r\n        }\r\n\r\n        // Verifica o token de email\r\n        const { data, error } = await supabase.auth.verifyOtp({\r\n          token_hash,\r\n          type: 'email'\r\n        });\r\n\r\n        if (error) {\r\n          throw error;\r\n        }\r\n\r\n        // Email confirmado com sucesso!\r\n        setStatus('success');\r\n        setMessage('Email confirmado com sucesso! Agora você pode fazer login.');\r\n\r\n        // Aguarda 2 segundos e redireciona para o login\r\n        setTimeout(() => {\r\n          navigate('/login', { \r\n            state: { \r\n              emailConfirmed: true,\r\n              email: data.user?.email \r\n            } \r\n          });\r\n        }, 2000);\r\n\r\n      } catch (error) {\r\n        console.error('Erro na confirmação:', error);\r\n        setStatus('error');\r\n        \r\n        if (error.message.includes('already confirmed')) {\r\n          setMessage('Este email já foi confirmado anteriormente. Você pode fazer login normalmente.');\r\n        } else if (error.message.includes('expired')) {\r\n          setMessage('Este link de confirmação expirou. Solicite um novo link de confirmação.');\r\n        } else {\r\n          setMessage(error.message || 'Erro ao confirmar email. Tente novamente.');\r\n        }\r\n      }\r\n    };\r\n\r\n    handleEmailConfirmation();\r\n  }, [searchParams, navigate]);\r\n\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>Confirmação de Email - Mesa Pra 2</title>\r\n      </Helmet>\r\n\r\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4\">\r\n        <motion.div\r\n          initial={{ opacity: 0, scale: 0.95 }}\r\n          animate={{ opacity: 1, scale: 1 }}\r\n          className=\"w-full max-w-md\"\r\n        >\r\n          <div className=\"bg-white/10 backdrop-blur-md rounded-2xl shadow-2xl p-8 border border-white/20\">\r\n            {status === 'loading' && (\r\n              <div className=\"text-center space-y-4\">\r\n                <div className=\"flex justify-center\">\r\n                  <Loader2 className=\"w-16 h-16 text-purple-400 animate-spin\" />\r\n                </div>\r\n                <h2 className=\"text-2xl font-bold text-white\">\r\n                  Confirmando seu email...\r\n                </h2>\r\n                <p className=\"text-white/60\">\r\n                  Aguarde enquanto validamos seu cadastro\r\n                </p>\r\n              </div>\r\n            )}\r\n\r\n            {status === 'success' && (\r\n              <div className=\"text-center space-y-4\">\r\n                <div className=\"flex justify-center\">\r\n                  <div className=\"w-16 h-16 rounded-full bg-green-500/20 flex items-center justify-center\">\r\n                    <CheckCircle className=\"w-10 h-10 text-green-500\" />\r\n                  </div>\r\n                </div>\r\n                <h2 className=\"text-2xl font-bold text-white\">\r\n                  Email Confirmado!\r\n                </h2>\r\n                <p className=\"text-white/60\">{message}</p>\r\n                <p className=\"text-sm text-white/40\">\r\n                  Redirecionando para o login...\r\n                </p>\r\n              </div>\r\n            )}\r\n\r\n            {status === 'error' && (\r\n              <div className=\"text-center space-y-6\">\r\n                <div className=\"flex justify-center\">\r\n                  <div className=\"w-16 h-16 rounded-full bg-red-500/20 flex items-center justify-center\">\r\n                    <XCircle className=\"w-10 h-10 text-red-500\" />\r\n                  </div>\r\n                </div>\r\n                <h2 className=\"text-2xl font-bold text-white\">\r\n                  Erro na Confirmação\r\n                </h2>\r\n                <p className=\"text-white/60\">{message}</p>\r\n                \r\n                <div className=\"space-y-3\">\r\n                  <Button\r\n                    onClick={() => navigate('/login')}\r\n                    className=\"w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600\"\r\n                  >\r\n                    Ir para Login\r\n                  </Button>\r\n                  \r\n                  <Button\r\n                    onClick={() => navigate('/partner/register')}\r\n                    variant=\"outline\"\r\n                    className=\"w-full\"\r\n                  >\r\n                    Tentar Novamente\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </motion.div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default AuthCallbackPage;"],"version":3}