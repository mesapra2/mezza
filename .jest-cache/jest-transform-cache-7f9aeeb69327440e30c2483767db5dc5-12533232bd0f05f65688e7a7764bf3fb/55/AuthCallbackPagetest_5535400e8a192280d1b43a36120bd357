b47270e4f09794e57ba307d24d57696c
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const jsx_runtime_1 = require("react/jsx-runtime");
// src/features/auth/pages/AuthCallbackPage.test.jsx
/* eslint-disable react/prop-types */
const globals_1 = require("@jest/globals");
// Mock do react-router-dom
globals_1.jest.mock('react-router-dom', () => ({
    ...globals_1.jest.requireActual('react-router-dom'),
    useNavigate: () => mockNavigate,
    useSearchParams: () => [{ get: mockGet }],
}));
// Mock do Supabase - ABORDAGEM CORRETA
globals_1.jest.mock('@/lib/supabaseClient', () => ({
    supabase: {
        auth: {
            verifyOtp: (...args) => mockVerifyOtp(...args),
        },
    },
}));
// Mock do Helmet
globals_1.jest.mock('react-helmet-async', () => ({
    Helmet: ({ children }) => (0, jsx_runtime_1.jsx)("div", { "data-testid": "helmet", children: children }),
}));
// Mock do Framer Motion
globals_1.jest.mock('framer-motion', () => ({
    motion: {
        div: ({ children, ...props }) => (0, jsx_runtime_1.jsx)("div", { ...props, children: children }),
    },
}));
// Mock dos componentes Lucide
globals_1.jest.mock('lucide-react', () => ({
    CheckCircle: () => (0, jsx_runtime_1.jsx)("div", { "data-testid": "check-icon", children: "\u2713" }),
    XCircle: () => (0, jsx_runtime_1.jsx)("div", { "data-testid": "x-icon", children: "\u2717" }),
    Loader2: () => (0, jsx_runtime_1.jsx)("div", { "data-testid": "loader-icon", children: "Loading..." }),
}));
// Mock do Button
globals_1.jest.mock('@/features/shared/components/ui/button', () => ({
    Button: ({ children, onClick, ...props }) => ((0, jsx_runtime_1.jsx)("button", { onClick: onClick, "data-testid": props['data-testid'], ...props, children: children })),
}));
const react_1 = require("@testing-library/react");
const react_router_dom_1 = require("react-router-dom");
const user_event_1 = tslib_1.__importDefault(require("@testing-library/user-event"));
// --- 1. CRIAR MOCKS ANTES DE IMPORTAR ---
const mockNavigate = globals_1.jest.fn();
const mockGet = globals_1.jest.fn();
const mockVerifyOtp = globals_1.jest.fn();
// Importar APÓS os mocks
const AuthCallbackPage_1 = tslib_1.__importDefault(require("./AuthCallbackPage"));
// --- 2. HELPER ---
const renderWithRouter = (component) => {
    return (0, react_1.render)((0, jsx_runtime_1.jsx)(react_router_dom_1.BrowserRouter, { children: component }));
};
// --- 3. TESTES ---
(0, globals_1.describe)('AuthCallbackPage', () => {
    (0, globals_1.beforeEach)(() => {
        globals_1.jest.clearAllMocks();
        globals_1.jest.useFakeTimers();
        mockGet.mockReset();
        mockVerifyOtp.mockReset();
        mockNavigate.mockReset();
        // Configurar comportamento padrão do mockVerifyOtp
        mockVerifyOtp.mockResolvedValue({
            data: { user: { email: 'default@example.com' } },
            error: null,
        });
    });
    (0, globals_1.afterEach)(() => {
        globals_1.jest.runOnlyPendingTimers();
        globals_1.jest.useRealTimers();
    });
    (0, globals_1.describe)('Estado de loading', () => {
        (0, globals_1.it)('deve mostrar loader enquanto processa a confirmação', () => {
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'test-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            mockVerifyOtp.mockImplementation(() => new Promise(() => { })); // Never resolves
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            (0, globals_1.expect)(react_1.screen.getByTestId('loader-icon')).toBeInTheDocument();
            (0, globals_1.expect)(react_1.screen.getByText('Confirmando seu email...')).toBeInTheDocument();
            (0, globals_1.expect)(react_1.screen.getByText('Aguarde enquanto validamos seu cadastro')).toBeInTheDocument();
        });
    });
    (0, globals_1.describe)('Confirmação bem-sucedida', () => {
        (0, globals_1.it)('deve mostrar mensagem de sucesso e redirecionar após confirmar email', async () => {
            const mockUser = { email: 'test@example.com' };
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'valid-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            mockVerifyOtp.mockResolvedValue({
                data: { user: mockUser },
                error: null,
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            // Aguarda processamento
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByTestId('check-icon')).toBeInTheDocument();
            }, { timeout: 3000 });
            (0, globals_1.expect)(react_1.screen.getByText('Email Confirmado!')).toBeInTheDocument();
            (0, globals_1.expect)(react_1.screen.getByText(/confirmado com sucesso/i)).toBeInTheDocument();
            // Verifica se verifyOtp foi chamado
            (0, globals_1.expect)(mockVerifyOtp).toHaveBeenCalledWith({
                token_hash: 'valid-token',
                type: 'email',
            });
            // Avança o timer
            globals_1.jest.advanceTimersByTime(2000);
            // Verifica redirecionamento
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(mockNavigate).toHaveBeenCalledWith('/login', {
                    state: {
                        emailConfirmed: true,
                        email: 'test@example.com',
                    },
                });
            });
        });
        (0, globals_1.it)('deve funcionar mesmo sem email do usuário', async () => {
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'valid-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            mockVerifyOtp.mockResolvedValue({
                data: { user: null },
                error: null,
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByTestId('check-icon')).toBeInTheDocument();
            }, { timeout: 3000 });
            globals_1.jest.advanceTimersByTime(2000);
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(mockNavigate).toHaveBeenCalledWith('/login', {
                    state: {
                        emailConfirmed: true,
                        email: undefined,
                    },
                });
            });
        });
    });
    (0, globals_1.describe)('Erros de validação', () => {
        (0, globals_1.it)('deve mostrar erro quando token_hash estiver ausente', async () => {
            mockGet.mockImplementation((param) => {
                if (param === 'type')
                    return 'email';
                return null;
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByTestId('x-icon')).toBeInTheDocument();
            });
            (0, globals_1.expect)(react_1.screen.getByText('Erro na Confirmação')).toBeInTheDocument();
            (0, globals_1.expect)(react_1.screen.getByText(/Link de confirmação inválido/i)).toBeInTheDocument();
            (0, globals_1.expect)(mockVerifyOtp).not.toHaveBeenCalled();
        });
        (0, globals_1.it)('deve mostrar erro quando type não for "email"', async () => {
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'test-token';
                if (param === 'type')
                    return 'recovery';
                return null;
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByTestId('x-icon')).toBeInTheDocument();
            });
            (0, globals_1.expect)(react_1.screen.getByText(/Link de confirmação inválido/i)).toBeInTheDocument();
            (0, globals_1.expect)(mockVerifyOtp).not.toHaveBeenCalled();
        });
        (0, globals_1.it)('deve mostrar erro quando verifyOtp falhar', async () => {
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'invalid-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            mockVerifyOtp.mockResolvedValue({
                data: null,
                error: { message: 'Token inválido' },
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByTestId('x-icon')).toBeInTheDocument();
                (0, globals_1.expect)(react_1.screen.getByText(/Token inválido/i)).toBeInTheDocument();
            });
        });
        (0, globals_1.it)('deve mostrar mensagem específica para email já confirmado', async () => {
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'already-used-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            mockVerifyOtp.mockResolvedValue({
                data: null,
                error: { message: 'Email already confirmed' },
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByText(/já foi confirmado anteriormente/i)).toBeInTheDocument();
            });
        });
        (0, globals_1.it)('deve mostrar mensagem específica para link expirado', async () => {
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'expired-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            mockVerifyOtp.mockResolvedValue({
                data: null,
                error: { message: 'Token expired' },
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByText(/link de confirmação expirou/i)).toBeInTheDocument();
            });
        });
    });
    (0, globals_1.describe)('Interações do usuário no estado de erro', () => {
        (0, globals_1.beforeEach)(async () => {
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'error-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            mockVerifyOtp.mockResolvedValue({
                data: null,
                error: { message: 'Erro genérico' },
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByTestId('x-icon')).toBeInTheDocument();
            });
        });
        (0, globals_1.it)('deve navegar para login ao clicar em "Ir para Login"', async () => {
            const user = user_event_1.default.setup({ delay: null });
            const loginButton = react_1.screen.getByText('Ir para Login');
            await user.click(loginButton);
            (0, globals_1.expect)(mockNavigate).toHaveBeenCalledWith('/login');
        });
        (0, globals_1.it)('deve navegar para registro ao clicar em "Tentar Novamente"', async () => {
            const user = user_event_1.default.setup({ delay: null });
            const retryButton = react_1.screen.getByText('Tentar Novamente');
            await user.click(retryButton);
            (0, globals_1.expect)(mockNavigate).toHaveBeenCalledWith('/partner/register');
        });
    });
    (0, globals_1.describe)('Metadados e SEO', () => {
        (0, globals_1.it)('deve renderizar o Helmet com título correto', () => {
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'test-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            mockVerifyOtp.mockImplementation(() => new Promise(() => { }));
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            const helmet = react_1.screen.getByTestId('helmet');
            (0, globals_1.expect)(helmet).toBeInTheDocument();
            (0, globals_1.expect)(react_1.screen.getByText('Confirmação de Email - Mesa Pra 2')).toBeInTheDocument();
        });
    });
    (0, globals_1.describe)('Console errors', () => {
        (0, globals_1.it)('deve logar erro no console quando verificação falhar', async () => {
            const consoleErrorSpy = globals_1.jest.spyOn(console, 'error').mockImplementation(() => { });
            mockGet.mockImplementation((param) => {
                if (param === 'token_hash')
                    return 'error-token';
                if (param === 'type')
                    return 'email';
                return null;
            });
            const errorObj = { message: 'Test error' };
            mockVerifyOtp.mockResolvedValue({
                data: null,
                error: errorObj,
            });
            renderWithRouter((0, jsx_runtime_1.jsx)(AuthCallbackPage_1.default, {}));
            await (0, react_1.waitFor)(() => {
                (0, globals_1.expect)(react_1.screen.getByTestId('x-icon')).toBeInTheDocument();
            });
            (0, globals_1.expect)(consoleErrorSpy).toHaveBeenCalled();
            (0, globals_1.expect)(consoleErrorSpy.mock.calls[0][0]).toBe('Erro na confirmação:');
            consoleErrorSpy.mockRestore();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxmZWF0dXJlc1xcc2hhcmVkXFxwYWdlc1xcQXV0aENhbGxiYWNrUGFnZS50ZXN0LmpzeCIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsb0RBQW9EO0FBQ3BELHFDQUFxQztBQUVyQywyQ0FBa0Y7QUFXbEYsMkJBQTJCO0FBQzNCLGNBQUksQ0FBQyxJQUFJLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNuQyxHQUFHLGNBQUksQ0FBQyxhQUFhLENBQUMsa0JBQWtCLENBQUM7SUFDekMsV0FBVyxFQUFFLEdBQUcsRUFBRSxDQUFDLFlBQVk7SUFDL0IsZUFBZSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUMsRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLENBQUM7Q0FDMUMsQ0FBQyxDQUFDLENBQUM7QUFFSix1Q0FBdUM7QUFDdkMsY0FBSSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ3ZDLFFBQVEsRUFBRTtRQUNSLElBQUksRUFBRTtZQUNKLFNBQVMsRUFBRSxDQUFDLEdBQUcsSUFBSSxFQUFFLEVBQUUsQ0FBQyxhQUFhLENBQUMsR0FBRyxJQUFJLENBQUM7U0FDL0M7S0FDRjtDQUNGLENBQUMsQ0FBQyxDQUFDO0FBRUosaUJBQWlCO0FBQ2pCLGNBQUksQ0FBQyxJQUFJLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNyQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxFQUFFLEVBQUUsQ0FBQywrQ0FBaUIsUUFBUSxZQUFFLFFBQVEsR0FBTztDQUNyRSxDQUFDLENBQUMsQ0FBQztBQUVKLHdCQUF3QjtBQUN4QixjQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ2hDLE1BQU0sRUFBRTtRQUNOLEdBQUcsRUFBRSxDQUFDLEVBQUUsUUFBUSxFQUFFLEdBQUcsS0FBSyxFQUFFLEVBQUUsRUFB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LENBQUMsV0FBVyxFQUFFLENBQUM7UUFDaEMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxERVZNaXhcXEFwcC5NZXNhcHJhMi5jb21cXHNyY1xcZmVhdHVyZXNcXHNoYXJlZFxccGFnZXNcXEF1dGhDYWxsYmFja1BhZ2UudGVzdC5qc3giXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL2ZlYXR1cmVzL2F1dGgvcGFnZXMvQXV0aENhbGxiYWNrUGFnZS50ZXN0LmpzeFxyXG4vKiBlc2xpbnQtZGlzYWJsZSByZWFjdC9wcm9wLXR5cGVzICovXHJcblxyXG5pbXBvcnQgeyBkZXNjcmliZSwgaXQsIGV4cGVjdCwgamVzdCwgYmVmb3JlRWFjaCwgYWZ0ZXJFYWNoIH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XHJcbmltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCB3YWl0Rm9yIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XHJcbmltcG9ydCB7IEJyb3dzZXJSb3V0ZXIgfSBmcm9tICdyZWFjdC1yb3V0ZXItZG9tJztcclxuaW1wb3J0IHVzZXJFdmVudCBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3VzZXItZXZlbnQnO1xyXG5cclxuLy8gLS0tIDEuIENSSUFSIE1PQ0tTIEFOVEVTIERFIElNUE9SVEFSIC0tLVxyXG5cclxuY29uc3QgbW9ja05hdmlnYXRlID0gamVzdC5mbigpO1xyXG5jb25zdCBtb2NrR2V0ID0gamVzdC5mbigpO1xyXG5jb25zdCBtb2NrVmVyaWZ5T3RwID0gamVzdC5mbigpO1xyXG5cclxuLy8gTW9jayBkbyByZWFjdC1yb3V0ZXItZG9tXHJcbmplc3QubW9jaygncmVhY3Qtcm91dGVyLWRvbScsICgpID0+ICh7XHJcbiAgLi4uamVzdC5yZXF1aXJlQWN0dWFsKCdyZWFjdC1yb3V0ZXItZG9tJyksXHJcbiAgdXNlTmF2aWdhdGU6ICgpID0+IG1vY2tOYXZpZ2F0ZSxcclxuICB1c2VTZWFyY2hQYXJhbXM6ICgpID0+IFt7IGdldDogbW9ja0dldCB9XSxcclxufSkpO1xyXG5cclxuLy8gTW9jayBkbyBTdXBhYmFzZSAtIEFCT1JEQUdFTSBDT1JSRVRBXHJcbmplc3QubW9jaygnQC9saWIvc3VwYWJhc2VDbGllbnQnLCAoKSA9PiAoe1xyXG4gIHN1cGFiYXNlOiB7XHJcbiAgICBhdXRoOiB7XHJcbiAgICAgIHZlcmlmeU90cDogKC4uLmFyZ3MpID0+IG1vY2tWZXJpZnlPdHAoLi4uYXJncyksXHJcbiAgICB9LFxyXG4gIH0sXHJcbn0pKTtcclxuXHJcbi8vIE1vY2sgZG8gSGVsbWV0XHJcbmplc3QubW9jaygncmVhY3QtaGVsbWV0LWFzeW5jJywgKCkgPT4gKHtcclxuICBIZWxtZXQ6ICh7IGNoaWxkcmVuIH0pID0+IDxkaXYgZGF0YS10ZXN0aWQ9XCJoZWxtZXRcIj57Y2hpbGRyZW59PC9kaXY+LFxyXG59KSk7XHJcblxyXG4vLyBNb2NrIGRvIEZyYW1lciBNb3Rpb25cclxuamVzdC5tb2NrKCdmcmFtZXItbW90aW9uJywgKCkgPT4gKHtcclxuICBtb3Rpb246IHtcclxuICAgIGRpdjogKHsgY2hpbGRyZW4sIC4uLnByb3BzIH0pID0+IDxkaXYgey4uLnByb3BzfT57Y2hpbGRyZW59PC9kaXY+LFxyXG4gIH0sXHJcbn0pKTtcclxuXHJcbi8vIE1vY2sgZG9zIGNvbXBvbmVudGVzIEx1Y2lkZVxyXG5qZXN0Lm1vY2soJ2x1Y2lkZS1yZWFjdCcsICgpID0+ICh7XHJcbiAgQ2hlY2tDaXJjbGU6ICgpID0+IDxkaXYgZGF0YS10ZXN0aWQ9XCJjaGVjay1pY29uXCI+4pyTPC9kaXY+LFxyXG4gIFhDaXJjbGU6ICgpID0+IDxkaXYgZGF0YS10ZXN0aWQ9XCJ4LWljb25cIj7inJc8L2Rpdj4sXHJcbiAgTG9hZGVyMjogKCkgPT4gPGRpdiBkYXRhLXRlc3RpZD1cImxvYWRlci1pY29uXCI+TG9hZGluZy4uLjwvZGl2PixcclxufSkpO1xyXG5cclxuLy8gTW9jayBkbyBCdXR0b25cclxuamVzdC5tb2NrKCdAL2ZlYXR1cmVzL3NoYXJlZC9jb21wb25lbnRzL3VpL2J1dHRvbicsICgpID0+ICh7XHJcbiAgQnV0dG9uOiAoeyBjaGlsZHJlbiwgb25DbGljaywgLi4ucHJvcHMgfSkgPT4gKFxyXG4gICAgPGJ1dHRvbiBvbkNsaWNrPXtvbkNsaWNrfSBkYXRhLXRlc3RpZD17cHJvcHNbJ2RhdGEtdGVzdGlkJ119IHsuLi5wcm9wc30+XHJcbiAgICAgIHtjaGlsZHJlbn1cclxuICAgIDwvYnV0dG9uPlxyXG4gICksXHJcbn0pKTtcclxuXHJcbi8vIEltcG9ydGFyIEFQw5NTIG9zIG1vY2tzXHJcbmltcG9ydCBBdXRoQ2FsbGJhY2tQYWdlIGZyb20gJy4vQXV0aENhbGxiYWNrUGFnZSc7XHJcblxyXG4vLyAtLS0gMi4gSEVMUEVSIC0tLVxyXG5cclxuY29uc3QgcmVuZGVyV2l0aFJvdXRlciA9IChjb21wb25lbnQpID0+IHtcclxuICByZXR1cm4gcmVuZGVyKFxyXG4gICAgPEJyb3dzZXJSb3V0ZXI+XHJcbiAgICAgIHtjb21wb25lbnR9XHJcbiAgICA8L0Jyb3dzZXJSb3V0ZXI+XHJcbiAgKTtcclxufTtcclxuXHJcbi8vIC0tLSAzLiBURVNURVMgLS0tXHJcblxyXG5kZXNjcmliZSgnQXV0aENhbGxiYWNrUGFnZScsICgpID0+IHtcclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gICAgamVzdC51c2VGYWtlVGltZXJzKCk7XHJcbiAgICBtb2NrR2V0Lm1vY2tSZXNldCgpO1xyXG4gICAgbW9ja1ZlcmlmeU90cC5tb2NrUmVzZXQoKTtcclxuICAgIG1vY2tOYXZpZ2F0ZS5tb2NrUmVzZXQoKTtcclxuICAgIFxyXG4gICAgLy8gQ29uZmlndXJhciBjb21wb3J0YW1lbnRvIHBhZHLDo28gZG8gbW9ja1ZlcmlmeU90cFxyXG4gICAgbW9ja1ZlcmlmeU90cC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XHJcbiAgICAgIGRhdGE6IHsgdXNlcjogeyBlbWFpbDogJ2RlZmF1bHRAZXhhbXBsZS5jb20nIH0gfSxcclxuICAgICAgZXJyb3I6IG51bGwsXHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgYWZ0ZXJFYWNoKCgpID0+IHtcclxuICAgIGplc3QucnVuT25seVBlbmRpbmdUaW1lcnMoKTtcclxuICAgIGplc3QudXNlUmVhbFRpbWVycygpO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnRXN0YWRvIGRlIGxvYWRpbmcnLCAoKSA9PiB7XHJcbiAgICBpdCgnZGV2ZSBtb3N0cmFyIGxvYWRlciBlbnF1YW50byBwcm9jZXNzYSBhIGNvbmZpcm1hw6fDo28nLCAoKSA9PiB7XHJcbiAgICAgIG1vY2tHZXQubW9ja0ltcGxlbWVudGF0aW9uKChwYXJhbSkgPT4ge1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3Rva2VuX2hhc2gnKSByZXR1cm4gJ3Rlc3QtdG9rZW4nO1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3R5cGUnKSByZXR1cm4gJ2VtYWlsJztcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBtb2NrVmVyaWZ5T3RwLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBuZXcgUHJvbWlzZSgoKSA9PiB7fSkpOyAvLyBOZXZlciByZXNvbHZlc1xyXG5cclxuICAgICAgcmVuZGVyV2l0aFJvdXRlcig8QXV0aENhbGxiYWNrUGFnZSAvPik7XHJcblxyXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdsb2FkZXItaWNvbicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQ29uZmlybWFuZG8gc2V1IGVtYWlsLi4uJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdBZ3VhcmRlIGVucXVhbnRvIHZhbGlkYW1vcyBzZXUgY2FkYXN0cm8nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnQ29uZmlybWHDp8OjbyBiZW0tc3VjZWRpZGEnLCAoKSA9PiB7XHJcbiAgICBpdCgnZGV2ZSBtb3N0cmFyIG1lbnNhZ2VtIGRlIHN1Y2Vzc28gZSByZWRpcmVjaW9uYXIgYXDDs3MgY29uZmlybWFyIGVtYWlsJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBtb2NrVXNlciA9IHsgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyB9O1xyXG4gICAgICBcclxuICAgICAgbW9ja0dldC5tb2NrSW1wbGVtZW50YXRpb24oKHBhcmFtKSA9PiB7XHJcbiAgICAgICAgaWYgKHBhcmFtID09PSAndG9rZW5faGFzaCcpIHJldHVybiAndmFsaWQtdG9rZW4nO1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3R5cGUnKSByZXR1cm4gJ2VtYWlsJztcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBtb2NrVmVyaWZ5T3RwLm1vY2tSZXNvbHZlZFZhbHVlKHtcclxuICAgICAgICBkYXRhOiB7IHVzZXI6IG1vY2tVc2VyIH0sXHJcbiAgICAgICAgZXJyb3I6IG51bGwsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmVuZGVyV2l0aFJvdXRlcig8QXV0aENhbGxiYWNrUGFnZSAvPik7XHJcblxyXG4gICAgICAvLyBBZ3VhcmRhIHByb2Nlc3NhbWVudG9cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnY2hlY2staWNvbicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICB9LCB7IHRpbWVvdXQ6IDMwMDAgfSk7XHJcblxyXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnRW1haWwgQ29uZmlybWFkbyEnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoL2NvbmZpcm1hZG8gY29tIHN1Y2Vzc28vaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcblxyXG4gICAgICAvLyBWZXJpZmljYSBzZSB2ZXJpZnlPdHAgZm9pIGNoYW1hZG9cclxuICAgICAgZXhwZWN0KG1vY2tWZXJpZnlPdHApLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcclxuICAgICAgICB0b2tlbl9oYXNoOiAndmFsaWQtdG9rZW4nLFxyXG4gICAgICAgIHR5cGU6ICdlbWFpbCcsXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gQXZhbsOnYSBvIHRpbWVyXHJcbiAgICAgIGplc3QuYWR2YW5jZVRpbWVyc0J5VGltZSgyMDAwKTtcclxuXHJcbiAgICAgIC8vIFZlcmlmaWNhIHJlZGlyZWNpb25hbWVudG9cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KG1vY2tOYXZpZ2F0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9sb2dpbicsIHtcclxuICAgICAgICAgIHN0YXRlOiB7XHJcbiAgICAgICAgICAgIGVtYWlsQ29uZmlybWVkOiB0cnVlLFxyXG4gICAgICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnZGV2ZSBmdW5jaW9uYXIgbWVzbW8gc2VtIGVtYWlsIGRvIHVzdcOhcmlvJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2V0Lm1vY2tJbXBsZW1lbnRhdGlvbigocGFyYW0pID0+IHtcclxuICAgICAgICBpZiAocGFyYW0gPT09ICd0b2tlbl9oYXNoJykgcmV0dXJuICd2YWxpZC10b2tlbic7XHJcbiAgICAgICAgaWYgKHBhcmFtID09PSAndHlwZScpIHJldHVybiAnZW1haWwnO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIG1vY2tWZXJpZnlPdHAubW9ja1Jlc29sdmVkVmFsdWUoe1xyXG4gICAgICAgIGRhdGE6IHsgdXNlcjogbnVsbCB9LFxyXG4gICAgICAgIGVycm9yOiBudWxsLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJlbmRlcldpdGhSb3V0ZXIoPEF1dGhDYWxsYmFja1BhZ2UgLz4pO1xyXG5cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnY2hlY2staWNvbicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICB9LCB7IHRpbWVvdXQ6IDMwMDAgfSk7XHJcblxyXG4gICAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoMjAwMCk7XHJcblxyXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgICBleHBlY3QobW9ja05hdmlnYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2xvZ2luJywge1xyXG4gICAgICAgICAgc3RhdGU6IHtcclxuICAgICAgICAgICAgZW1haWxDb25maXJtZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGVtYWlsOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnRXJyb3MgZGUgdmFsaWRhw6fDo28nLCAoKSA9PiB7XHJcbiAgICBpdCgnZGV2ZSBtb3N0cmFyIGVycm8gcXVhbmRvIHRva2VuX2hhc2ggZXN0aXZlciBhdXNlbnRlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2V0Lm1vY2tJbXBsZW1lbnRhdGlvbigocGFyYW0pID0+IHtcclxuICAgICAgICBpZiAocGFyYW0gPT09ICd0eXBlJykgcmV0dXJuICdlbWFpbCc7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmVuZGVyV2l0aFJvdXRlcig8QXV0aENhbGxiYWNrUGFnZSAvPik7XHJcblxyXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCd4LWljb24nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnRXJybyBuYSBDb25maXJtYcOnw6NvJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9MaW5rIGRlIGNvbmZpcm1hw6fDo28gaW52w6FsaWRvL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICBleHBlY3QobW9ja1ZlcmlmeU90cCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkZXZlIG1vc3RyYXIgZXJybyBxdWFuZG8gdHlwZSBuw6NvIGZvciBcImVtYWlsXCInLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tHZXQubW9ja0ltcGxlbWVudGF0aW9uKChwYXJhbSkgPT4ge1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3Rva2VuX2hhc2gnKSByZXR1cm4gJ3Rlc3QtdG9rZW4nO1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3R5cGUnKSByZXR1cm4gJ3JlY292ZXJ5JztcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZW5kZXJXaXRoUm91dGVyKDxBdXRoQ2FsbGJhY2tQYWdlIC8+KTtcclxuXHJcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ3gtaWNvbicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9MaW5rIGRlIGNvbmZpcm1hw6fDo28gaW52w6FsaWRvL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICBleHBlY3QobW9ja1ZlcmlmeU90cCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkZXZlIG1vc3RyYXIgZXJybyBxdWFuZG8gdmVyaWZ5T3RwIGZhbGhhcicsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja0dldC5tb2NrSW1wbGVtZW50YXRpb24oKHBhcmFtKSA9PiB7XHJcbiAgICAgICAgaWYgKHBhcmFtID09PSAndG9rZW5faGFzaCcpIHJldHVybiAnaW52YWxpZC10b2tlbic7XHJcbiAgICAgICAgaWYgKHBhcmFtID09PSAndHlwZScpIHJldHVybiAnZW1haWwnO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIG1vY2tWZXJpZnlPdHAubW9ja1Jlc29sdmVkVmFsdWUoe1xyXG4gICAgICAgIGRhdGE6IG51bGwsXHJcbiAgICAgICAgZXJyb3I6IHsgbWVzc2FnZTogJ1Rva2VuIGludsOhbGlkbycgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZW5kZXJXaXRoUm91dGVyKDxBdXRoQ2FsbGJhY2tQYWdlIC8+KTtcclxuXHJcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ3gtaWNvbicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9Ub2tlbiBpbnbDoWxpZG8vaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2RldmUgbW9zdHJhciBtZW5zYWdlbSBlc3BlY8OtZmljYSBwYXJhIGVtYWlsIGrDoSBjb25maXJtYWRvJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrR2V0Lm1vY2tJbXBsZW1lbnRhdGlvbigocGFyYW0pID0+IHtcclxuICAgICAgICBpZiAocGFyYW0gPT09ICd0b2tlbl9oYXNoJykgcmV0dXJuICdhbHJlYWR5LXVzZWQtdG9rZW4nO1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3R5cGUnKSByZXR1cm4gJ2VtYWlsJztcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBtb2NrVmVyaWZ5T3RwLm1vY2tSZXNvbHZlZFZhbHVlKHtcclxuICAgICAgICBkYXRhOiBudWxsLFxyXG4gICAgICAgIGVycm9yOiB7IG1lc3NhZ2U6ICdFbWFpbCBhbHJlYWR5IGNvbmZpcm1lZCcgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZW5kZXJXaXRoUm91dGVyKDxBdXRoQ2FsbGJhY2tQYWdlIC8+KTtcclxuXHJcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9qw6EgZm9pIGNvbmZpcm1hZG8gYW50ZXJpb3JtZW50ZS9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnZGV2ZSBtb3N0cmFyIG1lbnNhZ2VtIGVzcGVjw61maWNhIHBhcmEgbGluayBleHBpcmFkbycsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja0dldC5tb2NrSW1wbGVtZW50YXRpb24oKHBhcmFtKSA9PiB7XHJcbiAgICAgICAgaWYgKHBhcmFtID09PSAndG9rZW5faGFzaCcpIHJldHVybiAnZXhwaXJlZC10b2tlbic7XHJcbiAgICAgICAgaWYgKHBhcmFtID09PSAndHlwZScpIHJldHVybiAnZW1haWwnO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIG1vY2tWZXJpZnlPdHAubW9ja1Jlc29sdmVkVmFsdWUoe1xyXG4gICAgICAgIGRhdGE6IG51bGwsXHJcbiAgICAgICAgZXJyb3I6IHsgbWVzc2FnZTogJ1Rva2VuIGV4cGlyZWQnIH0sXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmVuZGVyV2l0aFJvdXRlcig8QXV0aENhbGxiYWNrUGFnZSAvPik7XHJcblxyXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgvbGluayBkZSBjb25maXJtYcOnw6NvIGV4cGlyb3UvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdJbnRlcmHDp8O1ZXMgZG8gdXN1w6FyaW8gbm8gZXN0YWRvIGRlIGVycm8nLCAoKSA9PiB7XHJcbiAgICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja0dldC5tb2NrSW1wbGVtZW50YXRpb24oKHBhcmFtKSA9PiB7XHJcbiAgICAgICAgaWYgKHBhcmFtID09PSAndG9rZW5faGFzaCcpIHJldHVybiAnZXJyb3ItdG9rZW4nO1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3R5cGUnKSByZXR1cm4gJ2VtYWlsJztcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBtb2NrVmVyaWZ5T3RwLm1vY2tSZXNvbHZlZFZhbHVlKHtcclxuICAgICAgICBkYXRhOiBudWxsLFxyXG4gICAgICAgIGVycm9yOiB7IG1lc3NhZ2U6ICdFcnJvIGdlbsOpcmljbycgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZW5kZXJXaXRoUm91dGVyKDxBdXRoQ2FsbGJhY2tQYWdlIC8+KTtcclxuXHJcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ3gtaWNvbicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkZXZlIG5hdmVnYXIgcGFyYSBsb2dpbiBhbyBjbGljYXIgZW0gXCJJciBwYXJhIExvZ2luXCInLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHVzZXIgPSB1c2VyRXZlbnQuc2V0dXAoeyBkZWxheTogbnVsbCB9KTtcclxuICAgICAgY29uc3QgbG9naW5CdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXh0KCdJciBwYXJhIExvZ2luJyk7XHJcblxyXG4gICAgICBhd2FpdCB1c2VyLmNsaWNrKGxvZ2luQnV0dG9uKTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrTmF2aWdhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvbG9naW4nKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkZXZlIG5hdmVnYXIgcGFyYSByZWdpc3RybyBhbyBjbGljYXIgZW0gXCJUZW50YXIgTm92YW1lbnRlXCInLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHVzZXIgPSB1c2VyRXZlbnQuc2V0dXAoeyBkZWxheTogbnVsbCB9KTtcclxuICAgICAgY29uc3QgcmV0cnlCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXh0KCdUZW50YXIgTm92YW1lbnRlJyk7XHJcblxyXG4gICAgICBhd2FpdCB1c2VyLmNsaWNrKHJldHJ5QnV0dG9uKTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrTmF2aWdhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvcGFydG5lci9yZWdpc3RlcicpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdNZXRhZGFkb3MgZSBTRU8nLCAoKSA9PiB7XHJcbiAgICBpdCgnZGV2ZSByZW5kZXJpemFyIG8gSGVsbWV0IGNvbSB0w610dWxvIGNvcnJldG8nLCAoKSA9PiB7XHJcbiAgICAgIG1vY2tHZXQubW9ja0ltcGxlbWVudGF0aW9uKChwYXJhbSkgPT4ge1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3Rva2VuX2hhc2gnKSByZXR1cm4gJ3Rlc3QtdG9rZW4nO1xyXG4gICAgICAgIGlmIChwYXJhbSA9PT0gJ3R5cGUnKSByZXR1cm4gJ2VtYWlsJztcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBtb2NrVmVyaWZ5T3RwLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBuZXcgUHJvbWlzZSgoKSA9PiB7fSkpO1xyXG5cclxuICAgICAgcmVuZGVyV2l0aFJvdXRlcig8QXV0aENhbGxiYWNrUGFnZSAvPik7XHJcblxyXG4gICAgICBjb25zdCBoZWxtZXQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2hlbG1ldCcpO1xyXG4gICAgICBleHBlY3QoaGVsbWV0KS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQ29uZmlybWHDp8OjbyBkZSBFbWFpbCAtIE1lc2EgUHJhIDInKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnQ29uc29sZSBlcnJvcnMnLCAoKSA9PiB7XHJcbiAgICBpdCgnZGV2ZSBsb2dhciBlcnJvIG5vIGNvbnNvbGUgcXVhbmRvIHZlcmlmaWNhw6fDo28gZmFsaGFyJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBjb25zb2xlRXJyb3JTcHkgPSBqZXN0LnNweU9uKGNvbnNvbGUsICdlcnJvcicpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7fSk7XHJcbiAgICAgIFxyXG4gICAgICBtb2NrR2V0Lm1vY2tJbXBsZW1lbnRhdGlvbigocGFyYW0pID0+IHtcclxuICAgICAgICBpZiAocGFyYW0gPT09ICd0b2tlbl9oYXNoJykgcmV0dXJuICdlcnJvci10b2tlbic7XHJcbiAgICAgICAgaWYgKHBhcmFtID09PSAndHlwZScpIHJldHVybiAnZW1haWwnO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGNvbnN0IGVycm9yT2JqID0geyBtZXNzYWdlOiAnVGVzdCBlcnJvcicgfTtcclxuICAgICAgbW9ja1ZlcmlmeU90cC5tb2NrUmVzb2x2ZWRWYWx1ZSh7XHJcbiAgICAgICAgZGF0YTogbnVsbCxcclxuICAgICAgICBlcnJvcjogZXJyb3JPYmosXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmVuZGVyV2l0aFJvdXRlcig8QXV0aENhbGxiYWNrUGFnZSAvPik7XHJcblxyXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCd4LWljb24nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBleHBlY3QoY29uc29sZUVycm9yU3B5KS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgIGV4cGVjdChjb25zb2xlRXJyb3JTcHkubW9jay5jYWxsc1swXVswXSkudG9CZSgnRXJybyBuYSBjb25maXJtYcOnw6NvOicpO1xyXG5cclxuICAgICAgY29uc29sZUVycm9yU3B5Lm1vY2tSZXN0b3JlKCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7Il0sInZlcnNpb24iOjN9