e9a83b9ac392d1b657681f602c8dd68c
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const prop_types_1 = tslib_1.__importDefault(require("prop-types"));
const lucide_react_1 = require("lucide-react");
const AuthContext_1 = require("@/contexts/AuthContext");
const use_toast_1 = require("@/features/shared/components/ui/use-toast");
const supabaseClient_1 = require("@/lib/supabaseClient");
const RestaurantRating = ({ eventId, restaurantId, restaurantName, onRatingSubmit }) => {
    const { user } = (0, AuthContext_1.useAuth)();
    const { toast } = (0, use_toast_1.useToast)();
    const [isLoading, setIsLoading] = (0, react_1.useState)(true);
    const [error, setError] = (0, react_1.useState)(null);
    const [restaurantData, setRestaurantData] = (0, react_1.useState)(null);
    const [selectedScore, setSelectedScore] = (0, react_1.useState)(0);
    const [hoveredStar, setHoveredStar] = (0, react_1.useState)(0);
    const [isSubmitting, setIsSubmitting] = (0, react_1.useState)(false);
    const [hasRated, setHasRated] = (0, react_1.useState)(false);
    const checkIfRated = (0, react_1.useCallback)(async () => {
        try {
            const { data, error } = await supabaseClient_1.supabase
                .from('restaurant_ratings')
                .select('id, score')
                .eq('event_id', eventId)
                .eq('user_id', user.id)
                .eq('restaurant_id', restaurantId)
                .maybeSingle();
            if (error && error.code !== 'PGRST116')
                throw error;
            if (data) {
                setHasRated(true);
                setSelectedScore(data.score);
            }
        }
        catch (err) {
            console.error('Erro ao verificar avaliação:', err);
        }
    }, [eventId, restaurantId, user.id]);
    const loadRestaurantData = (0, react_1.useCallback)(async () => {
        try {
            setIsLoading(true);
            setError(null);
            if (restaurantId) {
                const { data: restaurant, error: restaurantError } = await supabaseClient_1.supabase
                    .from('partners')
                    .select('id, name, address, rating')
                    .eq('id', restaurantId)
                    .single();
                if (restaurantError)
                    throw restaurantError;
                setRestaurantData(restaurant);
            }
            await checkIfRated();
        }
        catch (err) {
            console.error('Erro ao carregar dados do restaurante:', err);
            setError('Erro ao carregar dados. Tente novamente.');
        }
        finally {
            setIsLoading(false);
        }
    }, [restaurantId, checkIfRated]);
    (0, react_1.useEffect)(() => {
        if (eventId && user && restaurantId) {
            loadRestaurantData();
        }
    }, [eventId, user, restaurantId, loadRestaurantData]);
    const handleSubmitRating = async () => {
        if (!selectedScore) {
            toast({
                variant: 'destructive',
                title: 'Selecione uma avaliação',
                description: 'Por favor, clique em uma estrela para avaliar o restaurante'
            });
            return;
        }
        try {
            setIsSubmitting(true);
            if (hasRated) {
                const { error } = await supabaseClient_1.supabase
                    .from('restaurant_ratings')
                    .update({ score: selectedScore, updated_at: new Date().toISOString() })
                    .eq('event_id', eventId)
                    .eq('user_id', user.id)
                    .eq('restaurant_id', restaurantId);
                if (error)
                    throw error;
            }
            else {
                const { error } = await supabaseClient_1.supabase
                    .from('restaurant_ratings')
                    .insert({
                    event_id: eventId,
                    user_id: user.id,
                    restaurant_id: restaurantId,
                    score: selectedScore
                });
                if (error)
                    throw error;
                setHasRated(true);
            }
            toast({
                title: '✅ Avaliação enviada!',
                description: `Você avaliou ${restaurantName} com ${selectedScore} ⭐`
            });
            if (onRatingSubmit) {
                onRatingSubmit();
            }
        }
        catch (error) {
            console.error('Erro ao salvar avaliação:', error);
            toast({
                variant: 'destructive',
                title: 'Erro',
                description: 'Ocorreu um erro ao enviar sua avaliação'
            });
        }
        finally {
            setIsSubmitting(false);
        }
    };
    if (isLoading) {
        return (0, jsx_runtime_1.jsx)("div", { className: "text-white/60 text-center py-8", children: "Carregando informa\u00E7\u00F5es do restaurante..." });
    }
    if (error) {
        return ((0, jsx_runtime_1.jsxs)("div", { className: "bg-red-500/10 border border-red-500/20 rounded-2xl p-6 text-center", children: [(0, jsx_runtime_1.jsx)("p", { className: "text-red-200", children: error }), (0, jsx_runtime_1.jsx)("button", { onClick: () => loadRestaurantData(), className: "mt-4 px-4 py-2 bg-red-600/50 hover:bg-red-600 text-white rounded-lg transition-colors", children: "Tentar Novamente" })] }));
    }
    return ((0, jsx_runtime_1.jsx)("div", { className: "space-y-4", children: (0, jsx_runtime_1.jsxs)("div", { className: "glass-effect rounded-2xl p-6 border border-white/10", children: [(0, jsx_runtime_1.jsx)("h2", { className: "text-xl font-bold text-white mb-4", children: "\uD83C\uDF7D\uFE0F Avaliar Restaurante" }), restaurantData && ((0, jsx_runtime_1.jsx)("div", { className: "flex items-center gap-4 mb-6", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex-1", children: [(0, jsx_runtime_1.jsx)("h3", { className: "text-lg font-bold text-white", children: restaurantData.name }), (0, jsx_runtime_1.jsx)("p", { className: "text-sm text-white/60", children: restaurantData.address }), restaurantData.rating && ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2 mt-2", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex gap-1", children: [...Array(5)].map((_, i) => ((0, jsx_runtime_1.jsx)(lucide_react_1.Star, { size: 14, className: i < Math.floor(restaurantData.rating || 0)
                                                ? 'fill-yellow-400 text-yellow-400'
                                                : 'text-white/20' }, i))) }), (0, jsx_runtime_1.jsxs)("span", { className: "text-xs text-white/60", children: [restaurantData.rating || '0', " m\u00E9dia"] })] }))] }) })), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-4", children: [(0, jsx_runtime_1.jsxs)("label", { className: "text-white/80 text-sm font-medium block", children: ["Sua Avalia\u00E7\u00E3o ", (0, jsx_runtime_1.jsx)("span", { className: "text-red-400", children: "*" })] }), (0, jsx_runtime_1.jsx)("div", { className: "flex justify-start gap-3", children: [1, 2, 3, 4, 5].map((score) => ((0, jsx_runtime_1.jsxs)("button", { onClick: () => setSelectedScore(score), onMouseEnter: () => setHoveredStar(score), onMouseLeave: () => setHoveredStar(0), disabled: isSubmitting, className: "group relative transition-transform hover:scale-125 disabled:opacity-50", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Star, { size: 40, className: `transition-all duration-200 ${score <= (hoveredStar || selectedScore)
                                            ? 'fill-yellow-400 text-yellow-400 drop-shadow-lg'
                                            : 'text-white/30 hover:text-yellow-300'}` }), (0, jsx_runtime_1.jsxs)("span", { className: "absolute -bottom-8 left-1/2 -translate-x-1/2 bg-black/80 text-white text-xs px-2 py-1 rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none", children: [score === 1 && 'Ruim', score === 2 && 'Regular', score === 3 && 'Bom', score === 4 && 'Muito Bom', score === 5 && 'Excelente'] })] }, score))) }), selectedScore > 0 && ((0, jsx_runtime_1.jsxs)("div", { className: "text-center bg-white/5 rounded-lg p-3 border border-white/10", children: [(0, jsx_runtime_1.jsx)("p", { className: "text-white/80 text-sm", children: "Sua avalia\u00E7\u00E3o:" }), (0, jsx_runtime_1.jsxs)("p", { className: "text-2xl font-bold text-yellow-400 mt-1", children: [selectedScore, " \u2B50"] })] })), hasRated && ((0, jsx_runtime_1.jsx)("div", { className: "bg-green-500/10 border border-green-500/20 rounded-lg p-3", children: (0, jsx_runtime_1.jsxs)("p", { className: "text-sm text-green-200 flex items-center gap-2", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Check, { size: 16, className: "text-green-400" }), "\u2705 Voc\u00EA j\u00E1 avaliou este restaurante. Clique em 'Enviar' para atualizar sua avalia\u00E7\u00E3o."] }) })), (0, jsx_runtime_1.jsx)("button", { onClick: handleSubmitRating, disabled: !selectedScore || isSubmitting, className: "w-full px-4 py-2 rounded-lg bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed", children: isSubmitting ? 'Enviando...' : 'Enviar Avaliação' })] })] }) }));
};
RestaurantRating.propTypes = {
    eventId: prop_types_1.default.number.isRequired,
    restaurantId: prop_types_1.default.string.isRequired,
    restaurantName: prop_types_1.default.string.isRequired,
    onRatingSubmit: prop_types_1.default.func
};
exports.default = RestaurantRating;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxmZWF0dXJlc1xcc2hhcmVkXFxjb21wb25lbnRzXFxldmVudHNcXFJlc3RhdXJhbnRSYXRpbmcuanN4IiwibWFwcGluZ3MiOiI7Ozs7QUFBQSxpQ0FBeUQ7QUFDekQsb0VBQW1DO0FBQ25DLCtDQUEyQztBQUMzQyx3REFBaUQ7QUFDakQseUVBQXFFO0FBQ3JFLHlEQUFnRDtBQUVoRCxNQUFNLGdCQUFnQixHQUFHLENBQUMsRUFBRSxPQUFPLEVBQUUsWUFBWSxFQUFFLGNBQWMsRUFBRSxjQUFjLEVBQUUsRUFBRSxFQUFFO0lBQ3JGLE1BQU0sRUFBRSxJQUFJLEVBQUUsR0FBRyxJQUFBLHFCQUFPLEdBQUUsQ0FBQztJQUMzQixNQUFNLEVBQUUsS0FBSyxFQUFFLEdBQUcsSUFBQSxvQkFBUSxHQUFFLENBQUM7SUFFN0IsTUFBTSxDQUFDLFNBQVMsRUFBRSxZQUFZLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsSUFBSSxDQUFDLENBQUM7SUFDakQsTUFBTSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsSUFBSSxDQUFDLENBQUM7SUFDekMsTUFBTSxDQUFDLGNBQWMsRUFBRSxpQkFBaUIsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxJQUFJLENBQUMsQ0FBQztJQUMzRCxNQUFNLENBQUMsYUFBYSxFQUFFLGdCQUFnQixDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3RELE1BQU0sQ0FBQyxXQUFXLEVBQUUsY0FBYyxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2xELE1BQU0sQ0FBQyxZQUFZLEVBQUUsZUFBZSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3hELE1BQU0sQ0FBQyxRQUFRLEVBQUUsV0FBVyxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLEtBQUssQ0FBQyxDQUFDO0lBRWhELE1BQU0sWUFBWSxHQUFHLElBQUEsbUJBQVcsRUFBQyxLQUFLLElBQUksRUFBRTtRQUMxQyxJQUFJLENBQUM7WUFDSCxNQUFNLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxHQUFHLE1BQU0seUJBQVE7aUJBQ25DLElBQUksQ0FBQyxvQkFBb0IsQ0FBQztpQkFDMUIsTUFBTSxDQUFDLFdBQVcsQ0FBQztpQkFDbkIsRUFBRSxDQUFDLFVBQVUsRUFBRSxPQUFPLENBQUM7aUJBQ3ZCLEVBQUUsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQztpQkFDdEIsRUFBRSxDQUFDLGVBQWUsRUFBRSxZQUFZLENBQUM7aUJBQ2pDLFdBQVcsRUFBRSxDQUFDO1lBRWpCLElBQUksS0FBSyxJQUFJLEtBQUssQ0FBQyxJQUFJLEtBQUssVUFBVTtnQkFBRSxNQUFNLEtBQUssQ0FBQztZQUVwRCxJQUFJLElBQUksRUFBRSxDQUFDO2dCQUNULFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDbEIsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9CLENBQUM7UUFDSCxDQUFDO1FBQUMsT0FBTyxHQUFHLEVBQUUsQ0FBQztZQUNiLE9BQU8sQ0FBQyxLQUFLLENBQUMsOEJBQThCLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDckQsQ0FBQztJQUNILENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxZQUFZLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFFckMsTUFBTSxrQkFBa0IsR0FBRyxJQUFBLG1CQUFXLEVBQUMsS0FBSyxJQUFJLEVBQUU7UUFDaEQsSUFBSSxDQUFDO1lBQ0gsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ25CLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUVmLElBQUksWUFBWSxFQUFFLENBQUM7Z0JBQ2pCLE1BQU0sRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxlQUFlLEVBQUUsR0FBRyxNQUFNLHlCQUFRO3FCQUNoRSxJQUFJLENBQUMsVUFBVSxDQUFDO3FCQUNoQixNQUFNLENBQUMsMkJBQTJCLENBQUM7cUJBQ25DLEVBQUUsQ0FBQyxJQUFJLEVBQUUsWUFBWSxDQUFDO3FCQUN0QixNQUFNLEVBQUUsQ0FBQztnQkFFWixJQUFJLGVBQWU7b0JBQUUsTUFBTSxlQUFlLENBQUM7Z0JBQzNDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQ2hDLENBQUM7WUFFRCxNQUFNLFlBQVksRUFBRSxDQUFDO1FBQ3ZCLENBQUM7UUFBQyxPQUFPLEdBQUcsRUFBRSxDQUFDO1lBQ2IsT0FBTyxDQUFDLEtBQUssQ0FBQyx3Q0FBd0MsRUFBRSxHQUFHLENBQUMsQ0FBQztZQUM3RCxRQUFRLENBQUMsMENBQTBDLENBQUMsQ0FBQztRQUN2RCxDQUFDO2dCQUFTLENBQUM7WUFDVCxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDdEIsQ0FBQztJQUNMLENBQUMsRUFBRSxDQUFDLFlBQVksRUFBRSxZQUFZLENBQUMsQ0FBQyxDQUFDO0lBQy9CLElBQUEsaUJBQVMsRUFBQyxHQUFHLEVBQUU7UUFDYixJQUFJLE9BQU8sSUFBSSxJQUFJLElBQUksWUFBWSxFQUFFLENBQUM7WUFDcEMsa0JBQWtCLEVBQUUsQ0FBQztRQUN2QixDQUFDO0lBQ0gsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxZQUFZLEVBQUUsa0JBQWtCLENBQUMsQ0FBQyxDQUFDO0lBRXRELE1BQU0sa0JBQWtCLEdBQUcsS0FBSyxJQUFJLEVBQUU7UUFDcEMsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1lBQ25CLEtBQUssQ0FBQztnQkFDSixPQUFPLEVBQUUsYUFBYTtnQkFDdEIsS0FBSyxFQUFFLHlCQUF5QjtnQkFDaEMsV0FBVyxFQUFFLDZEQUE2RDthQUMzRSxDQUFDLENBQUM7WUFDSCxPQUFPO1FBQ1QsQ0FBQztRQUVELElBQUksQ0FBQztZQUNILGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUV0QixJQUFJLFFBQVEsRUFBRSxDQUFDO2dCQUNiLE1BQU0sRUFBRSxLQUFLLEVBQUUsR0FBRyxNQUFNLHlCQUFRO3FCQUM3QixJQUFJLENBQUMsb0JBQW9CLENBQUM7cUJBQzFCLE1BQU0sQ0FBQyxFQUFFLEtBQUssRUFBRSxhQUFhLEVBQUUsVUFBVSxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFLEVBQUUsQ0FBQztxQkFDdEUsRUFBRSxDQUFDLFVBQVUsRUFBRSxPQUFPLENBQUM7cUJBQ3ZCLEVBQUUsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQztxQkFDdEIsRUFBRSxDQUFDLGVBQWUsRUFBRSxZQUFZLENBQUMsQ0FBQztnQkFFckMsSUFBSSxLQUFLO29CQUFFLE1BQU0sS0FBSyxDQUFDO1lBQ3pCLENBQUM7aUJBQU0sQ0FBQztnQkFDTixNQUFNLEVBQUUsS0FBSyxFQUFFLEdBQUcsTUFBTSx5QkFBUTtxQkFDN0IsSUFBSSxDQUFDLG9CQUFvQixDQUFDO3FCQUMxQixNQUFNLENBQUM7b0JBQ04sUUFBUSxFQUFFLE9BQU87b0JBQ2pCLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRTtvQkFDaEIsYUFBYSxFQUFFLFlBQVk7b0JBQzNCLEtBQUssRUFBRSxhQUFhO2lCQUNyQixDQUFDLENBQUM7Z0JBRUwsSUFBSSxLQUFLO29CQUFFLE1BQU0sS0FBSyxDQUFDO2dCQUN2QixXQUFXLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDcEIsQ0FBQztZQUVELEtBQUssQ0FBQztnQkFDSixLQUFLLEVBQUUsc0JBQXNCO2dCQUM3QixXQUFXLEVBQUUsZ0JBQWdCLGNBQWMsUUFBUSxhQUFhLElBQUk7YUFDckUsQ0FBQyxDQUFDO1lBRUgsSUFBSSxjQUFjLEVBQUUsQ0FBQztnQkFDbkIsY0FBYyxFQUFFLENBQUM7WUFDbkIsQ0FBQztRQUNILENBQUM7UUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1lBQ2YsT0FBTyxDQUFDLEtBQUssQ0FBQywyQkFBMkIsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUNsRCxLQUFLLENBQUM7Z0JBQ0osT0FBTyxFQUFFLGFBQWE7Z0JBQ3RCLEtBQUssRUFBRSxNQUFNO2dCQUNiLFdBQVcsRUFBRSx5Q0FBeUM7YUFDdkQsQ0FBQyxDQUFDO1FBQ0wsQ0FBQztnQkFBUyxDQUFDO1lBQ1QsZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3pCLENBQUM7SUFDSCxDQUFDLENBQUM7SUFFRixJQUFJLFNBQVMsRUFBRSxDQUFDO1FBQ2QsT0FBTyxnQ0FBSyxTQUFTLEVBQUMsZ0NBQWdDLG1FQUErQyxDQUFDO0lBQ3hHLENBQUM7SUFFRCxJQUFJLEtBQUssRUFBRSxDQUFDO1FBQ1YsT0FBTyxDQUNMLGlDQUFLLFNBQVMsRUFBQyxvRUFBb0UsYUFDakYsOEJBQUcsU0FBUyxFQUFDLGNBQWMsWUFBRSxLQUFLLEdBQUssRUFDdkMsbUNBQ0UsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLGtCQUFrQixFQUFFLEVBQ25DLFNBQVMsRUFBQyx1RkFBdUYsaUNBRzFGLElBQ0wsQ0FDUCxDQUFDO0lBQ0osQ0FBQztJQUVELE9BQU8sQ0FDTCxnQ0FBSyxTQUFTLEVBQUMsV0FBVyxZQUN4QixpQ0FBSyxTQUFTLEVBQUMscURBQXFELGFBQ2xFLCtCQUFJLFNBQVMsRUFBQyxtQ0FBbUMsdURBQTZCLEVBRTdFLGNBQWMsSUFBSSxDQUNqQixnQ0FBSyxTQUFTLEVBQUMsOEJBQThCLFlBQzNDLGlDQUFLLFNBQVMsRUFBQyxRQUFRLGFBQ3JCLCtCQUFJLFNBQVMsRUFBQyw4QkFBOEIsWUFBRSxjQUFjLENBQUMsSUFBSSxHQUFNLEVBQ3ZFLDhCQUFHLFNBQVMsRUFBQyx1QkFBdUIsWUFBRSxjQUFjLENBQUMsT0FBTyxHQUFLLEVBQ2hFLGNBQWMsQ0FBQyxNQUFNLElBQUksQ0FDeEIsaUNBQUssU0FBUyxFQUFDLDhCQUE4QixhQUMzQyxnQ0FBSyxTQUFTLEVBQUMsWUFBWSxZQUN4QixDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FDM0IsdUJBQUMsbUJBQUksSUFFSCxJQUFJLEVBQUUsRUFBRSxFQUNSLFNBQVMsRUFDUCxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUMsTUFBTSxJQUFJLENBQUMsQ0FBQztnREFDeEMsQ0FBQyxDQUFDLGlDQUFpQztnREFDbkMsQ0FBQyxDQUFDLGVBQWUsSUFMaEIsQ0FBQyxDQU9OLENBQ0gsQ0FBQyxHQUNFLEVBQ04sa0NBQU0sU0FBUyxFQUFDLHVCQUF1QixhQUFFLGNBQWMsQ0FBQyxNQUFNLElBQUksR0FBRyxtQkFBYyxJQUMvRSxDQUNQLElBQ0csR0FDRixDQUNQLEVBRUQsaUNBQUssU0FBUyxFQUFDLFdBQVcsYUFDeEIsbUNBQU8sU0FBUyxFQUFDLHlDQUF5Qyx5Q0FDMUMsaUNBQU0sU0FBUyxFQUFDLGNBQWMsa0JBQVMsSUFDL0MsRUFFUixnQ0FBSyxTQUFTLEVBQUMsMEJBQTBCLFlBQ3RDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FDOUIsb0NBRUUsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxFQUN0QyxZQUFZLEVBQUUsR0FBRyxFQUFFLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxFQUN6QyxZQUFZLEVBQUUsR0FBRyxFQUFFLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxFQUNyQyxRQUFRLEVBQUUsWUFBWSxFQUN0QixTQUFTLEVBQUMseUVBQXlFLGFBRW5GLHVCQUFDLG1CQUFJLElBQ0gsSUFBSSxFQUFFLEVBQUUsRUFDUixTQUFTLEVBQUUsK0JBQ1QsS0FBSyxJQUFJLENBQUMsV0FBVyxJQUFJLGFBQWEsQ0FBQzs0Q0FDckMsQ0FBQyxDQUFDLGdEQUFnRDs0Q0FDbEQsQ0FBQyxDQUFDLHFDQUNOLEVBQUUsR0FDRixFQUNGLGtDQUFNLFNBQVMsRUFBQywwTEFBMEwsYUFDdk0sS0FBSyxLQUFLLENBQUMsSUFBSSxNQUFNLEVBQ3JCLEtBQUssS0FBSyxDQUFDLElBQUksU0FBUyxFQUN4QixLQUFLLEtBQUssQ0FBQyxJQUFJLEtBQUssRUFDcEIsS0FBSyxLQUFLLENBQUMsSUFBSSxXQUFXLEVBQzFCLEtBQUssS0FBSyxDQUFDLElBQUksV0FBVyxJQUN0QixLQXJCRixLQUFLLENBc0JILENBQ1YsQ0FBQyxHQUNFLEVBRUwsYUFBYSxHQUFHLENBQUMsSUFBSSxDQUNwQixpQ0FBSyxTQUFTLEVBQUMsOERBQThELGFBQzNFLDhCQUFHLFNBQVMsRUFBQyx1QkFBdUIseUNBQW1CLEVBQ3ZELCtCQUFHLFNBQVMsRUFBQyx5Q0FBeUMsYUFBRSxhQUFhLGVBQU8sSUFDeEUsQ0FDUCxFQUVBLFFBQVEsSUFBSSxDQUNYLGdDQUFLLFNBQVMsRUFBQywyREFBMkQsWUFDeEUsK0JBQUcsU0FBUyxFQUFDLGdEQUFnRCxhQUMzRCx1QkFBQyxvQkFBSyxJQUFDLElBQUksRUFBRSxFQUFFLEVBQUUsU0FBUyxFQUFDLGdCQUFnQixHQUFHLHFIQUU1QyxHQUNBLENBQ1AsRUFFRCxtQ0FDRSxPQUFPLEVBQUUsa0JBQWtCLEVBQzNCLFFBQVEsRUFBRSxDQUFDLGFBQWEsSUFBSSxZQUFZLEVBQ3hDLFNBQVMsRUFBQyw4TUFBOE0sWUFFdk4sWUFBWSxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLGtCQUFrQixHQUMzQyxJQUNMLElBQ0YsR0FDRixDQUNQLENBQUM7QUFDSixDQUFDLENBQUM7QUFFRixnQkFBZ0IsQ0FBQyxTQUFTLEdBQUc7SUFDM0IsT0FBTyxFQUFFLG9CQUFTLENBQUMsTUFBTSxDQUFDLFVBQVU7SUFDcEMsWUFBWSxFQUFFLG9CQUFTLENBQUMsTUFBTSxDQUFDLFVBQVU7SUFDekMsY0FBYyxFQUFFLG9CQUFTLENBQUMsTUFBTSxDQUFDLFVBQVU7SUFDM0MsY0FBYyxFQUFFLG9CQUFTLENBQUMsSUFBSTtDQUMvQixDQUFDO0FBRUYsa0JBQWUsZ0JBQWdCLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxmZWF0dXJlc1xcc2hhcmVkXFxjb21wb25lbnRzXFxldmVudHNcXFJlc3RhdXJhbnRSYXRpbmcuanN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xyXG5pbXBvcnQgeyBTdGFyLCBDaGVjayB9IGZyb20gJ2x1Y2lkZS1yZWFjdCc7XHJcbmltcG9ydCB7IHVzZUF1dGggfSBmcm9tICdAL2NvbnRleHRzL0F1dGhDb250ZXh0JztcclxuaW1wb3J0IHsgdXNlVG9hc3QgfSBmcm9tICdAL2ZlYXR1cmVzL3NoYXJlZC9jb21wb25lbnRzL3VpL3VzZS10b2FzdCc7XHJcbmltcG9ydCB7IHN1cGFiYXNlIH0gZnJvbSAnQC9saWIvc3VwYWJhc2VDbGllbnQnO1xyXG5cclxuY29uc3QgUmVzdGF1cmFudFJhdGluZyA9ICh7IGV2ZW50SWQsIHJlc3RhdXJhbnRJZCwgcmVzdGF1cmFudE5hbWUsIG9uUmF0aW5nU3VibWl0IH0pID0+IHtcclxuICBjb25zdCB7IHVzZXIgfSA9IHVzZUF1dGgoKTtcclxuICBjb25zdCB7IHRvYXN0IH0gPSB1c2VUb2FzdCgpO1xyXG5cclxuICBjb25zdCBbaXNMb2FkaW5nLCBzZXRJc0xvYWRpbmddID0gdXNlU3RhdGUodHJ1ZSk7XHJcbiAgY29uc3QgW2Vycm9yLCBzZXRFcnJvcl0gPSB1c2VTdGF0ZShudWxsKTtcclxuICBjb25zdCBbcmVzdGF1cmFudERhdGEsIHNldFJlc3RhdXJhbnREYXRhXSA9IHVzZVN0YXRlKG51bGwpO1xyXG4gIGNvbnN0IFtzZWxlY3RlZFNjb3JlLCBzZXRTZWxlY3RlZFNjb3JlXSA9IHVzZVN0YXRlKDApO1xyXG4gIGNvbnN0IFtob3ZlcmVkU3Rhciwgc2V0SG92ZXJlZFN0YXJdID0gdXNlU3RhdGUoMCk7XHJcbiAgY29uc3QgW2lzU3VibWl0dGluZywgc2V0SXNTdWJtaXR0aW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICBjb25zdCBbaGFzUmF0ZWQsIHNldEhhc1JhdGVkXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuXHJcbiAgY29uc3QgY2hlY2tJZlJhdGVkID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgncmVzdGF1cmFudF9yYXRpbmdzJylcclxuICAgICAgICAuc2VsZWN0KCdpZCwgc2NvcmUnKVxyXG4gICAgICAgIC5lcSgnZXZlbnRfaWQnLCBldmVudElkKVxyXG4gICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXIuaWQpXHJcbiAgICAgICAgLmVxKCdyZXN0YXVyYW50X2lkJywgcmVzdGF1cmFudElkKVxyXG4gICAgICAgIC5tYXliZVNpbmdsZSgpO1xyXG5cclxuICAgICAgaWYgKGVycm9yICYmIGVycm9yLmNvZGUgIT09ICdQR1JTVDExNicpIHRocm93IGVycm9yO1xyXG5cclxuICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICBzZXRIYXNSYXRlZCh0cnVlKTtcclxuICAgICAgICBzZXRTZWxlY3RlZFNjb3JlKGRhdGEuc2NvcmUpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJybyBhbyB2ZXJpZmljYXIgYXZhbGlhw6fDo286JywgZXJyKTtcclxuICAgIH1cclxuICB9LCBbZXZlbnRJZCwgcmVzdGF1cmFudElkLCB1c2VyLmlkXSk7XHJcblxyXG4gIGNvbnN0IGxvYWRSZXN0YXVyYW50RGF0YSA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIHNldElzTG9hZGluZyh0cnVlKTtcclxuICAgICAgc2V0RXJyb3IobnVsbCk7XHJcblxyXG4gICAgICBpZiAocmVzdGF1cmFudElkKSB7XHJcbiAgICAgICAgY29uc3QgeyBkYXRhOiByZXN0YXVyYW50LCBlcnJvcjogcmVzdGF1cmFudEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAgICAgLmZyb20oJ3BhcnRuZXJzJylcclxuICAgICAgICAgIC5zZWxlY3QoJ2lkLCBuYW1lLCBhZGRyZXNzLCByYXRpbmcnKVxyXG4gICAgICAgICAgLmVxKCdpZCcsIHJlc3RhdXJhbnRJZClcclxuICAgICAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICAgICAgaWYgKHJlc3RhdXJhbnRFcnJvcikgdGhyb3cgcmVzdGF1cmFudEVycm9yO1xyXG4gICAgICAgIHNldFJlc3RhdXJhbnREYXRhKHJlc3RhdXJhbnQpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBhd2FpdCBjaGVja0lmUmF0ZWQoKTtcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvIGFvIGNhcnJlZ2FyIGRhZG9zIGRvIHJlc3RhdXJhbnRlOicsIGVycik7XHJcbiAgICAgIHNldEVycm9yKCdFcnJvIGFvIGNhcnJlZ2FyIGRhZG9zLiBUZW50ZSBub3ZhbWVudGUuJyk7XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xyXG4gICAgfVxyXG59LCBbcmVzdGF1cmFudElkLCBjaGVja0lmUmF0ZWRdKTtcclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgaWYgKGV2ZW50SWQgJiYgdXNlciAmJiByZXN0YXVyYW50SWQpIHtcclxuICAgICAgbG9hZFJlc3RhdXJhbnREYXRhKCk7XHJcbiAgICB9XHJcbiAgfSwgW2V2ZW50SWQsIHVzZXIsIHJlc3RhdXJhbnRJZCwgbG9hZFJlc3RhdXJhbnREYXRhXSk7XHJcblxyXG4gIGNvbnN0IGhhbmRsZVN1Ym1pdFJhdGluZyA9IGFzeW5jICgpID0+IHtcclxuICAgIGlmICghc2VsZWN0ZWRTY29yZSkge1xyXG4gICAgICB0b2FzdCh7XHJcbiAgICAgICAgdmFyaWFudDogJ2Rlc3RydWN0aXZlJyxcclxuICAgICAgICB0aXRsZTogJ1NlbGVjaW9uZSB1bWEgYXZhbGlhw6fDo28nLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnUG9yIGZhdm9yLCBjbGlxdWUgZW0gdW1hIGVzdHJlbGEgcGFyYSBhdmFsaWFyIG8gcmVzdGF1cmFudGUnXHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgc2V0SXNTdWJtaXR0aW5nKHRydWUpO1xyXG5cclxuICAgICAgaWYgKGhhc1JhdGVkKSB7XHJcbiAgICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAgIC5mcm9tKCdyZXN0YXVyYW50X3JhdGluZ3MnKVxyXG4gICAgICAgICAgLnVwZGF0ZSh7IHNjb3JlOiBzZWxlY3RlZFNjb3JlLCB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgfSlcclxuICAgICAgICAgIC5lcSgnZXZlbnRfaWQnLCBldmVudElkKVxyXG4gICAgICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZClcclxuICAgICAgICAgIC5lcSgncmVzdGF1cmFudF9pZCcsIHJlc3RhdXJhbnRJZCk7XHJcblxyXG4gICAgICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAgIC5mcm9tKCdyZXN0YXVyYW50X3JhdGluZ3MnKVxyXG4gICAgICAgICAgLmluc2VydCh7XHJcbiAgICAgICAgICAgIGV2ZW50X2lkOiBldmVudElkLFxyXG4gICAgICAgICAgICB1c2VyX2lkOiB1c2VyLmlkLFxyXG4gICAgICAgICAgICByZXN0YXVyYW50X2lkOiByZXN0YXVyYW50SWQsXHJcbiAgICAgICAgICAgIHNjb3JlOiBzZWxlY3RlZFNjb3JlXHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcclxuICAgICAgICBzZXRIYXNSYXRlZCh0cnVlKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdG9hc3Qoe1xyXG4gICAgICAgIHRpdGxlOiAn4pyFIEF2YWxpYcOnw6NvIGVudmlhZGEhJyxcclxuICAgICAgICBkZXNjcmlwdGlvbjogYFZvY8OqIGF2YWxpb3UgJHtyZXN0YXVyYW50TmFtZX0gY29tICR7c2VsZWN0ZWRTY29yZX0g4q2QYFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGlmIChvblJhdGluZ1N1Ym1pdCkge1xyXG4gICAgICAgIG9uUmF0aW5nU3VibWl0KCk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gYW8gc2FsdmFyIGF2YWxpYcOnw6NvOicsIGVycm9yKTtcclxuICAgICAgdG9hc3Qoe1xyXG4gICAgICAgIHZhcmlhbnQ6ICdkZXN0cnVjdGl2ZScsXHJcbiAgICAgICAgdGl0bGU6ICdFcnJvJyxcclxuICAgICAgICBkZXNjcmlwdGlvbjogJ09jb3JyZXUgdW0gZXJybyBhbyBlbnZpYXIgc3VhIGF2YWxpYcOnw6NvJ1xyXG4gICAgICB9KTtcclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgIHNldElzU3VibWl0dGluZyhmYWxzZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwidGV4dC13aGl0ZS82MCB0ZXh0LWNlbnRlciBweS04XCI+Q2FycmVnYW5kbyBpbmZvcm1hw6fDtWVzIGRvIHJlc3RhdXJhbnRlLi4uPC9kaXY+O1xyXG4gIH1cclxuXHJcbiAgaWYgKGVycm9yKSB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImJnLXJlZC01MDAvMTAgYm9yZGVyIGJvcmRlci1yZWQtNTAwLzIwIHJvdW5kZWQtMnhsIHAtNiB0ZXh0LWNlbnRlclwiPlxyXG4gICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtcmVkLTIwMFwiPntlcnJvcn08L3A+XHJcbiAgICAgICAgPGJ1dHRvblxyXG4gICAgICAgICAgb25DbGljaz17KCkgPT4gbG9hZFJlc3RhdXJhbnREYXRhKCl9XHJcbiAgICAgICAgICBjbGFzc05hbWU9XCJtdC00IHB4LTQgcHktMiBiZy1yZWQtNjAwLzUwIGhvdmVyOmJnLXJlZC02MDAgdGV4dC13aGl0ZSByb3VuZGVkLWxnIHRyYW5zaXRpb24tY29sb3JzXCJcclxuICAgICAgICA+XHJcbiAgICAgICAgICBUZW50YXIgTm92YW1lbnRlXHJcbiAgICAgICAgPC9idXR0b24+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHJldHVybiAoXHJcbiAgICA8ZGl2IGNsYXNzTmFtZT1cInNwYWNlLXktNFwiPlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImdsYXNzLWVmZmVjdCByb3VuZGVkLTJ4bCBwLTYgYm9yZGVyIGJvcmRlci13aGl0ZS8xMFwiPlxyXG4gICAgICAgIDxoMiBjbGFzc05hbWU9XCJ0ZXh0LXhsIGZvbnQtYm9sZCB0ZXh0LXdoaXRlIG1iLTRcIj7wn42977iPIEF2YWxpYXIgUmVzdGF1cmFudGU8L2gyPlxyXG5cclxuICAgICAgICB7cmVzdGF1cmFudERhdGEgJiYgKFxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtNCBtYi02XCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xXCI+XHJcbiAgICAgICAgICAgICAgPGgzIGNsYXNzTmFtZT1cInRleHQtbGcgZm9udC1ib2xkIHRleHQtd2hpdGVcIj57cmVzdGF1cmFudERhdGEubmFtZX08L2gzPlxyXG4gICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC13aGl0ZS82MFwiPntyZXN0YXVyYW50RGF0YS5hZGRyZXNzfTwvcD5cclxuICAgICAgICAgICAgICB7cmVzdGF1cmFudERhdGEucmF0aW5nICYmIChcclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgbXQtMlwiPlxyXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZ2FwLTFcIj5cclxuICAgICAgICAgICAgICAgICAgICB7Wy4uLkFycmF5KDUpXS5tYXAoKF8sIGkpID0+IChcclxuICAgICAgICAgICAgICAgICAgICAgIDxTdGFyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleT17aX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT17MTR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaSA8IE1hdGguZmxvb3IocmVzdGF1cmFudERhdGEucmF0aW5nIHx8IDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/ICdmaWxsLXllbGxvdy00MDAgdGV4dC15ZWxsb3ctNDAwJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAndGV4dC13aGl0ZS8yMCdcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICApKX1cclxuICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC13aGl0ZS82MFwiPntyZXN0YXVyYW50RGF0YS5yYXRpbmcgfHwgJzAnfSBtw6lkaWE8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICl9XHJcblxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS00XCI+XHJcbiAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwidGV4dC13aGl0ZS84MCB0ZXh0LXNtIGZvbnQtbWVkaXVtIGJsb2NrXCI+XHJcbiAgICAgICAgICAgIFN1YSBBdmFsaWHDp8OjbyA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LXJlZC00MDBcIj4qPC9zcGFuPlxyXG4gICAgICAgICAgPC9sYWJlbD5cclxuXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgganVzdGlmeS1zdGFydCBnYXAtM1wiPlxyXG4gICAgICAgICAgICB7WzEsIDIsIDMsIDQsIDVdLm1hcCgoc2NvcmUpID0+IChcclxuICAgICAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgICAgICBrZXk9e3Njb3JlfVxyXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0U2VsZWN0ZWRTY29yZShzY29yZSl9XHJcbiAgICAgICAgICAgICAgICBvbk1vdXNlRW50ZXI9eygpID0+IHNldEhvdmVyZWRTdGFyKHNjb3JlKX1cclxuICAgICAgICAgICAgICAgIG9uTW91c2VMZWF2ZT17KCkgPT4gc2V0SG92ZXJlZFN0YXIoMCl9XHJcbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17aXNTdWJtaXR0aW5nfVxyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZ3JvdXAgcmVsYXRpdmUgdHJhbnNpdGlvbi10cmFuc2Zvcm0gaG92ZXI6c2NhbGUtMTI1IGRpc2FibGVkOm9wYWNpdHktNTBcIlxyXG4gICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDxTdGFyXHJcbiAgICAgICAgICAgICAgICAgIHNpemU9ezQwfVxyXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2B0cmFuc2l0aW9uLWFsbCBkdXJhdGlvbi0yMDAgJHtcclxuICAgICAgICAgICAgICAgICAgICBzY29yZSA8PSAoaG92ZXJlZFN0YXIgfHwgc2VsZWN0ZWRTY29yZSlcclxuICAgICAgICAgICAgICAgICAgICAgID8gJ2ZpbGwteWVsbG93LTQwMCB0ZXh0LXllbGxvdy00MDAgZHJvcC1zaGFkb3ctbGcnXHJcbiAgICAgICAgICAgICAgICAgICAgICA6ICd0ZXh0LXdoaXRlLzMwIGhvdmVyOnRleHQteWVsbG93LTMwMCdcclxuICAgICAgICAgICAgICAgICAgfWB9XHJcbiAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiYWJzb2x1dGUgLWJvdHRvbS04IGxlZnQtMS8yIC10cmFuc2xhdGUteC0xLzIgYmctYmxhY2svODAgdGV4dC13aGl0ZSB0ZXh0LXhzIHB4LTIgcHktMSByb3VuZGVkIHdoaXRlc3BhY2Utbm93cmFwIG9wYWNpdHktMCBncm91cC1ob3ZlcjpvcGFjaXR5LTEwMCB0cmFuc2l0aW9uLW9wYWNpdHkgcG9pbnRlci1ldmVudHMtbm9uZVwiPlxyXG4gICAgICAgICAgICAgICAgICB7c2NvcmUgPT09IDEgJiYgJ1J1aW0nfVxyXG4gICAgICAgICAgICAgICAgICB7c2NvcmUgPT09IDIgJiYgJ1JlZ3VsYXInfVxyXG4gICAgICAgICAgICAgICAgICB7c2NvcmUgPT09IDMgJiYgJ0JvbSd9XHJcbiAgICAgICAgICAgICAgICAgIHtzY29yZSA9PT0gNCAmJiAnTXVpdG8gQm9tJ31cclxuICAgICAgICAgICAgICAgICAge3Njb3JlID09PSA1ICYmICdFeGNlbGVudGUnfVxyXG4gICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICApKX1cclxuICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgIHtzZWxlY3RlZFNjb3JlID4gMCAmJiAoXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXIgYmctd2hpdGUvNSByb3VuZGVkLWxnIHAtMyBib3JkZXIgYm9yZGVyLXdoaXRlLzEwXCI+XHJcbiAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC13aGl0ZS84MCB0ZXh0LXNtXCI+U3VhIGF2YWxpYcOnw6NvOjwvcD5cclxuICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LTJ4bCBmb250LWJvbGQgdGV4dC15ZWxsb3ctNDAwIG10LTFcIj57c2VsZWN0ZWRTY29yZX0g4q2QPC9wPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICl9XHJcblxyXG4gICAgICAgICAge2hhc1JhdGVkICYmIChcclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJiZy1ncmVlbi01MDAvMTAgYm9yZGVyIGJvcmRlci1ncmVlbi01MDAvMjAgcm91bmRlZC1sZyBwLTNcIj5cclxuICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtZ3JlZW4tMjAwIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XHJcbiAgICAgICAgICAgICAgICA8Q2hlY2sgc2l6ZT17MTZ9IGNsYXNzTmFtZT1cInRleHQtZ3JlZW4tNDAwXCIgLz5cclxuICAgICAgICAgICAgICAgIOKchSBWb2PDqiBqw6EgYXZhbGlvdSBlc3RlIHJlc3RhdXJhbnRlLiBDbGlxdWUgZW0gJmFwb3M7RW52aWFyJmFwb3M7IHBhcmEgYXR1YWxpemFyIHN1YSBhdmFsaWHDp8Ojby5cclxuICAgICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgKX1cclxuXHJcbiAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZVN1Ym1pdFJhdGluZ31cclxuICAgICAgICAgICAgZGlzYWJsZWQ9eyFzZWxlY3RlZFNjb3JlIHx8IGlzU3VibWl0dGluZ31cclxuICAgICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsIHB4LTQgcHktMiByb3VuZGVkLWxnIGJnLWdyYWRpZW50LXRvLXIgZnJvbS1vcmFuZ2UtNTAwIHRvLW9yYW5nZS02MDAgaG92ZXI6ZnJvbS1vcmFuZ2UtNjAwIGhvdmVyOnRvLW9yYW5nZS03MDAgdGV4dC13aGl0ZSBmb250LXNlbWlib2xkIHRyYW5zaXRpb24tYWxsIGRpc2FibGVkOm9wYWNpdHktNTAgZGlzYWJsZWQ6Y3Vyc29yLW5vdC1hbGxvd2VkXCJcclxuICAgICAgICAgID5cclxuICAgICAgICAgICAge2lzU3VibWl0dGluZyA/ICdFbnZpYW5kby4uLicgOiAnRW52aWFyIEF2YWxpYcOnw6NvJ31cclxuICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG4gICk7XHJcbn07XHJcblxyXG5SZXN0YXVyYW50UmF0aW5nLnByb3BUeXBlcyA9IHtcclxuICBldmVudElkOiBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXHJcbiAgcmVzdGF1cmFudElkOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXHJcbiAgcmVzdGF1cmFudE5hbWU6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcclxuICBvblJhdGluZ1N1Ym1pdDogUHJvcFR5cGVzLmZ1bmNcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IFJlc3RhdXJhbnRSYXRpbmc7Il0sInZlcnNpb24iOjN9