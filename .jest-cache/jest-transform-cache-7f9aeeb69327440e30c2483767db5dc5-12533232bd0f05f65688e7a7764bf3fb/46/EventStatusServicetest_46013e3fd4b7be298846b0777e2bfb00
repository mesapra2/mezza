ef1dc5acfacb3573509782b8ba4a4f89
"use strict";
// src/services/EventStatusService.test.ts
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const globals_1 = require("@jest/globals");
globals_1.jest.mock('../lib/supabaseClient', () => ({
    supabase: mockSupabaseInstance,
}));
// Mock dos outros serviços (todos são default exports)
globals_1.jest.mock('./EventSecurityService', () => ({
    default: {
        generateAndSavePassword: globals_1.jest.fn(() => Promise.resolve({ success: true, password: 'mock-123' })),
        lockEventEntry: globals_1.jest.fn(() => Promise.resolve({ success: true })),
    },
}));
globals_1.jest.mock('./PushNotificationService', () => ({
    default: {
        sendPasswordToHost: globals_1.jest.fn(() => Promise.resolve({ success: true })),
        sendEventStartNotificationToParticipants: globals_1.jest.fn(() => Promise.resolve({ success: true })),
    },
}));
globals_1.jest.mock('./TrustScoreService', () => ({
    default: {
        penalizeNoShowsForEvent: globals_1.jest.fn(() => Promise.resolve()),
    },
}));
// --- 1. MOCKING DEPENDÊNCIAS (ANTES DAS IMPORTAÇÕES) ---
// Mock do Supabase
// Definimos apenas o 'from' que será mockado em cada teste
const mockSupabaseInstance = {
    from: globals_1.jest.fn(),
};
// --- 2. IMPORTAÇÕES (DEPOIS DOS MOCKS) ---
// Importa o serviço que queremos testar
const EventStatusService_1 = tslib_1.__importDefault(require("./EventStatusService"));
// Importa os mocks para que possamos espioná-los
const supabaseClient_1 = require("../lib/supabaseClient");
const EventSecurityService_1 = tslib_1.__importDefault(require("./EventSecurityService"));
const PushNotificationService_1 = tslib_1.__importDefault(require("./PushNotificationService"));
const TrustScoreService_1 = tslib_1.__importDefault(require("./TrustScoreService"));
// Typecast dos mocks para termos intellisense e conformidade com TypeScript
const mockedSupabase = supabaseClient_1.supabase;
const mockedSecurityService = EventSecurityService_1.default;
const mockedPushService = PushNotificationService_1.default;
const mockedTrustService = TrustScoreService_1.default;
// --- 3. CONFIGURAÇÃO DOS TESTES ---
(0, globals_1.describe)('EventStatusService', () => {
    // Usamos timers falsos para controlar o new Date()
    (0, globals_1.beforeAll)(() => {
        globals_1.jest.useFakeTimers();
    });
    // Limpa todos os mocks antes de cada teste
    (0, globals_1.beforeEach)(() => {
        globals_1.jest.clearAllMocks();
        mockedSupabase.from.mockReset();
    });
    // Restaura os timers reais após todos os testes
    afterAll(() => {
        globals_1.jest.useRealTimers();
    });
    // --- 4. TESTES ---
    (0, globals_1.describe)('Gerenciamento de Auto-Update', () => {
        (0, globals_1.afterEach)(() => {
            // Garante que paramos qualquer timer iniciado nos testes
            EventStatusService_1.default.stopAutoUpdate();
        });
        (0, globals_1.it)('should start auto-update e ser "running"', () => {
            // Espiona o método principal para evitar que ele execute a lógica real
            const spy = globals_1.jest.spyOn(EventStatusService_1.default, 'updateAllEventStatuses').mockImplementation(() => Promise.resolve());
            const intervalId = EventStatusService_1.default.startAutoUpdate(30);
            (0, globals_1.expect)(intervalId).toBeDefined();
            (0, globals_1.expect)(EventStatusService_1.default.isAutoUpdateRunning()).toBe(true);
            (0, globals_1.expect)(spy).toHaveBeenCalledTimes(1); // Deve rodar imediatamente
            spy.mockRestore();
        });
        (0, globals_1.it)('should stop auto-update', () => {
            EventStatusService_1.default.startAutoUpdate(30);
            (0, globals_1.expect)(EventStatusService_1.default.isAutoUpdateRunning()).toBe(true);
            EventStatusService_1.default.stopAutoUpdate();
            (0, globals_1.expect)(EventStatusService_1.default.isAutoUpdateRunning()).toBe(false);
        });
    });
    (0, globals_1.describe)('updateEventStatus', () => {
        (0, globals_1.it)('deve chamar supabase.update com os parâmetros corretos', async () => {
            // ✅ CORREÇÃO: Usando mockImplementation
            const mockUpdateEq = globals_1.jest.fn().mockImplementation(() => Promise.resolve({ error: null }));
            mockedSupabase.from.mockReturnValue({
                update: globals_1.jest.fn(() => ({
                    eq: mockUpdateEq,
                })),
            });
            await EventStatusService_1.default.updateEventStatus(123, 'NovoStatus');
            (0, globals_1.expect)(mockedSupabase.from).toHaveBeenCalledWith('events');
            (0, globals_1.expect)(mockedSupabase.from('events').update).toHaveBeenCalledWith(globals_1.expect.objectContaining({
                status: 'NovoStatus',
            }));
            (0, globals_1.expect)(mockUpdateEq).toHaveBeenCalledWith('id', 123);
        });
    });
    (0, globals_1.describe)('Lógica de Status (updateAllEventStatuses)', () => {
        const now = new Date('2025-10-01T10:00:00Z');
        (0, globals_1.beforeEach)(() => {
            // Define a hora global para todos os testes de lógica
            globals_1.jest.setSystemTime(now);
        });
        (0, globals_1.it)('deve mudar status para "Em Andamento" quando a hora de início for atingida', async () => {
            const event = {
                id: 1,
                status: 'Aberto',
                start_time: '2025-10-01T09:59:59Z', // 1 segundo atrás
                end_time: '2025-10-01T12:00:00Z',
            };
            // ✅ CORREÇÃO: Usando mockImplementation
            const mockSelectNeq = globals_1.jest.fn().mockImplementation(() => Promise.resolve({ data: [event], error: null }));
            mockedSupabase.from.mockImplementationOnce(() => ({
                select: globals_1.jest.fn(() => ({
                    neq: globals_1.jest.fn(() => ({
                        neq: mockSelectNeq,
                    })),
                })),
            }));
            // ✅ CORREÇÃO: Usando mockImplementation
            const mockUpdateEq = globals_1.jest.fn().mockImplementation(() => Promise.resolve({ error: null }));
            mockedSupabase.from.mockImplementationOnce(() => ({
                update: globals_1.jest.fn(() => ({
                    eq: mockUpdateEq,
                })),
            }));
            await EventStatusService_1.default.updateAllEventStatuses();
            (0, globals_1.expect)(mockSelectNeq).toHaveBeenCalled();
            (0, globals_1.expect)(mockedSupabase.from).toHaveBeenCalledWith('events');
            (0, globals_1.expect)(mockUpdateEq).toHaveBeenCalledWith('id', 1);
            (0, globals_1.expect)(mockedSupabase.from('events').update).toHaveBeenCalledWith(globals_1.expect.objectContaining({ status: 'Em Andamento' }));
        });
        (0, globals_1.it)('deve gerar senha e enviar push 1 minuto antes do evento', async () => {
            const startTime = new Date('2025-10-01T10:01:00Z'); // Daqui a 1 min
            const event = {
                id: 2,
                status: 'Aberto',
                start_time: startTime.toISOString(),
                end_time: '2025-10-01T12:00:00Z',
                creator_id: 'host-id',
                title: 'Evento Teste',
                event_entry_password: null, // Sem senha
            };
            // ✅ CORREÇÃO (Linha 190)
            mockedSupabase.from.mockImplementationOnce(() => ({
                select: globals_1.jest.fn(() => ({
                    neq: globals_1.jest.fn(() => ({
                        neq: globals_1.jest.fn().mockImplementation(() => Promise.resolve({ data: [event], error: null })),
                    })),
                })),
            }));
            // ✅ CORREÇÃO (Linha 199)
            mockedSupabase.from.mockImplementationOnce(() => ({
                select: globals_1.jest.fn(() => ({
                    eq: globals_1.jest.fn(() => ({
                        single: globals_1.jest.fn().mockImplementation(() => Promise.resolve({ data: { username: 'Host' }, error: null })),
                    })),
                })),
            }));
            // ✅ CORREÇÃO (Linha 208)
            mockedSupabase.from.mockImplementationOnce(() => ({
                select: globals_1.jest.fn(() => ({
                    eq: globals_1.jest.fn(() => ({
                        eq: globals_1.jest.fn().mockImplementation(() => Promise.resolve({ data: [{ user_id: 'part-1' }], error: null })),
                    })),
                })),
            }));
            await EventStatusService_1.default.updateAllEventStatuses();
            // Verifica se a senha foi gerada
            (0, globals_1.expect)(mockedSecurityService.generateAndSavePassword).toHaveBeenCalledWith(2);
            // Verifica se o push foi enviado ao anfitrião
            (0, globals_1.expect)(mockedPushService.sendPasswordToHost).toHaveBeenCalledWith('host-id', 2, 'mock-123', // Senha mockada
            'Evento Teste');
            // Verifica se o push foi enviado aos participantes
            (0, globals_1.expect)(mockedPushService.sendEventStartNotificationToParticipants).toHaveBeenCalledWith(['part-1'], 2, 'Evento Teste');
        });
        (0, globals_1.it)('deve bloquear entrada 1 minuto antes do fim', async () => {
            const endTime = new Date('2025-10-01T10:01:00Z'); // Daqui a 1 min
            const event = {
                id: 3,
                status: 'Em Andamento',
                start_time: '2025-10-01T09:00:00Z',
                end_time: endTime.toISOString(),
                entry_locked: false, // Não bloqueado
            };
            // ✅ CORREÇÃO (Linha 248)
            mockedSupabase.from.mockImplementationOnce(() => ({
                select: globals_1.jest.fn(() => ({
                    neq: globals_1.jest.fn(() => ({
                        neq: globals_1.jest.fn().mockImplementation(() => Promise.resolve({ data: [event], error: null })),
                    })),
                })),
            }));
            await EventStatusService_1.default.updateAllEventStatuses();
            // Verifica se o bloqueio foi chamado
            (0, globals_1.expect)(mockedSecurityService.lockEventEntry).toHaveBeenCalledWith(3);
        });
        (0, globals_1.it)('deve mudar status para "Finalizado" e penalizar quem não foi', async () => {
            const endTime = new Date('2025-10-01T09:59:59Z'); // 1 segundo atrás
            const event = {
                id: 4,
                status: 'Em Andamento',
                start_time: '2025-10-01T08:00:00Z',
                end_time: endTime.toISOString(),
            };
            // ✅ CORREÇÃO (Linha 272)
            mockedSupabase.from.mockImplementationOnce(() => ({
                select: globals_1.jest.fn(() => ({
                    neq: globals_1.jest.fn(() => ({
                        neq: globals_1.jest.fn().mockImplementation(() => Promise.resolve({ data: [event], error: null })),
                    })),
                })),
            }));
            // ✅ CORREÇÃO (Linha 280)
            mockedSupabase.from.mockImplementationOnce(() => ({
                update: globals_1.jest.fn(() => ({
                    eq: globals_1.jest.fn().mockImplementation(() => Promise.resolve({ error: null })),
                })),
            }));
            // ✅ CORREÇÃO (Linha 288)
            mockedSupabase.from.mockImplementationOnce(() => ({
                select: globals_1.jest.fn(() => ({
                    eq: globals_1.jest.fn(() => ({
                        eq: globals_1.jest.fn().mockImplementation(() => Promise.resolve({ data: [], error: null })),
                    })),
                })),
            }));
            await EventStatusService_1.default.updateAllEventStatuses();
            // Verifica se o status mudou para Finalizado
            (0, globals_1.expect)(mockedSupabase.from('events').update).toHaveBeenCalledWith(globals_1.expect.objectContaining({ status: 'Finalizado' }));
            // Verifica se a penalização foi chamada
            (0, globals_1.expect)(mockedTrustService.penalizeNoShowsForEvent).toHaveBeenCalledWith(4);
        });
        (0, globals_1.it)('deve mudar status para "Concluído" se todos avaliaram', async () => {
            const endTime = new Date('2025-10-01T09:00:00Z'); // Já terminou
            const event = {
                id: 5,
                status: 'Finalizado',
                start_time: '2025-10-01T08:00:00Z',
                end_time: endTime.toISOString(),
            };
            const participants = [
                { id: 'p1', presenca_confirmada: true, avaliacao_feita: true },
                { id: 'p2', presenca_confirmada: false, avaliacao_feita: false }, // não foi
                { id: 'p3', presenca_confirmada: true, avaliacao_feita: true },
            ];
            // ✅ CORREÇÃO (Linha 323)
            mockedSupabase.from.mockImplementationOnce(() => ({
                select: globals_1.jest.fn(() => ({
                    neq: globals_1.jest.fn(() => ({
                        neq: globals_1.jest.fn().mockImplementation(() => Promise.resolve({ data: [event], error: null })),
                    })),
                })),
            }));
            // ✅ CORREÇÃO (Linha 332)
            mockedSupabase.from.mockImplementationOnce(() => ({
                select: globals_1.jest.fn(() => ({
                    eq: globals_1.jest.fn(() => ({
                        eq: globals_1.jest.fn().mockImplementation(() => Promise.resolve({ data: participants, error: null })),
                    })),
                })),
            }));
            // ✅ CORREÇÃO (Linha 340)
            mockedSupabase.from.mockImplementationOnce(() => ({
                update: globals_1.jest.fn(() => ({
                    eq: globals_1.jest.fn().mockImplementation(() => Promise.resolve({ error: null })),
                })),
            }));
            await EventStatusService_1.default.updateAllEventStatuses();
            // Verifica se o status mudou para Concluído
            (0, globals_1.expect)(mockedSupabase.from('events').update).toHaveBeenCalledWith(globals_1.expect.objectContaining({ status: 'Concluído' }));
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxzZXJ2aWNlc1xcRXZlbnRTdGF0dXNTZXJ2aWNlLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBLDBDQUEwQzs7O0FBRTFDLDJDQUE2RjtBQVU3RixjQUFJLENBQUMsSUFBSSxDQUFDLHVCQUF1QixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDeEMsUUFBUSxFQUFFLG9CQUFvQjtDQUMvQixDQUFDLENBQUMsQ0FBQztBQUVKLHVEQUF1RDtBQUN2RCxjQUFJLENBQUMsSUFBSSxDQUFDLHdCQUF3QixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDekMsT0FBTyxFQUFFO1FBQ1AsdUJBQXVCLEVBQUUsY0FBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsVUFBVSxFQUFFLENBQUMsQ0FBQztRQUNoRyxjQUFjLEVBQUUsY0FBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7S0FDbEU7Q0FDRixDQUFDLENBQUMsQ0FBQztBQUVKLGNBQUksQ0FBQyxJQUFJLENBQUMsMkJBQTJCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUM1QyxPQUFPLEVBQUU7UUFDUCxrQkFBa0IsRUFBRSxjQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztRQUNyRSx3Q0FBd0MsRUFBRSxjQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztLQUM1RjtDQUNGLENBQUMsQ0FBQyxDQUFDO0FBRUosY0FBSSxDQUFDLElB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QkFBc0IsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO2dCQUMvRCxNQUFNLEVBQUUsY0FBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO29CQUNyQixFQUFFLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztpQkFDekUsQ0FBQyxDQUFDO2FBQ0osQ0FBQyxDQUFDLENBQUM7WUFFSixNQUFNLDRCQUFrQixDQUFDLHNCQUFzQixFQUFFLENBQUM7WUFFbEQsNENBQTRDO1lBQzVDLElBQUEsZ0JBQU0sRUFBQyxjQUFjLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLG9CQUFvQixDQUMvRCxnQkFBTSxDQUFDLGdCQUFnQixDQUFDLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRSxDQUFDLENBQ2pELENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztJQUVMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxzZXJ2aWNlc1xcRXZlbnRTdGF0dXNTZXJ2aWNlLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3NlcnZpY2VzL0V2ZW50U3RhdHVzU2VydmljZS50ZXN0LnRzXHJcblxyXG5pbXBvcnQgeyBkZXNjcmliZSwgaXQsIGV4cGVjdCwgamVzdCwgYmVmb3JlRWFjaCwgYWZ0ZXJFYWNoLCBiZWZvcmVBbGwgfSBmcm9tICdAamVzdC9nbG9iYWxzJztcclxuXHJcbi8vIC0tLSAxLiBNT0NLSU5HIERFUEVORMOKTkNJQVMgKEFOVEVTIERBUyBJTVBPUlRBw4fDlUVTKSAtLS1cclxuXHJcbi8vIE1vY2sgZG8gU3VwYWJhc2VcclxuLy8gRGVmaW5pbW9zIGFwZW5hcyBvICdmcm9tJyBxdWUgc2Vyw6EgbW9ja2FkbyBlbSBjYWRhIHRlc3RlXHJcbmNvbnN0IG1vY2tTdXBhYmFzZUluc3RhbmNlID0ge1xyXG4gIGZyb206IGplc3QuZm4oKSxcclxufTtcclxuXHJcbmplc3QubW9jaygnLi4vbGliL3N1cGFiYXNlQ2xpZW50JywgKCkgPT4gKHtcclxuICBzdXBhYmFzZTogbW9ja1N1cGFiYXNlSW5zdGFuY2UsXHJcbn0pKTtcclxuXHJcbi8vIE1vY2sgZG9zIG91dHJvcyBzZXJ2acOnb3MgKHRvZG9zIHPDo28gZGVmYXVsdCBleHBvcnRzKVxyXG5qZXN0Lm1vY2soJy4vRXZlbnRTZWN1cml0eVNlcnZpY2UnLCAoKSA9PiAoe1xyXG4gIGRlZmF1bHQ6IHtcclxuICAgIGdlbmVyYXRlQW5kU2F2ZVBhc3N3b3JkOiBqZXN0LmZuKCgpID0+IFByb21pc2UucmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUsIHBhc3N3b3JkOiAnbW9jay0xMjMnIH0pKSxcclxuICAgIGxvY2tFdmVudEVudHJ5OiBqZXN0LmZuKCgpID0+IFByb21pc2UucmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUgfSkpLFxyXG4gIH0sXHJcbn0pKTtcclxuXHJcbmplc3QubW9jaygnLi9QdXNoTm90aWZpY2F0aW9uU2VydmljZScsICgpID0+ICh7XHJcbiAgZGVmYXVsdDoge1xyXG4gICAgc2VuZFBhc3N3b3JkVG9Ib3N0OiBqZXN0LmZuKCgpID0+IFByb21pc2UucmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUgfSkpLFxyXG4gICAgc2VuZEV2ZW50U3RhcnROb3RpZmljYXRpb25Ub1BhcnRpY2lwYW50czogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlIH0pKSxcclxuICB9LFxyXG59KSk7XHJcblxyXG5qZXN0Lm1vY2soJy4vVHJ1c3RTY29yZVNlcnZpY2UnLCAoKSA9PiAoe1xyXG4gIGRlZmF1bHQ6IHtcclxuICAgIHBlbmFsaXplTm9TaG93c0ZvckV2ZW50OiBqZXN0LmZuKCgpID0+IFByb21pc2UucmVzb2x2ZSgpKSxcclxuICB9LFxyXG59KSk7XHJcblxyXG5cclxuLy8gLS0tIDIuIElNUE9SVEHDh8OVRVMgKERFUE9JUyBET1MgTU9DS1MpIC0tLVxyXG5cclxuLy8gSW1wb3J0YSBvIHNlcnZpw6dvIHF1ZSBxdWVyZW1vcyB0ZXN0YXJcclxuaW1wb3J0IEV2ZW50U3RhdHVzU2VydmljZSBmcm9tICcuL0V2ZW50U3RhdHVzU2VydmljZSc7XHJcblxyXG4vLyBJbXBvcnRhIG9zIG1vY2tzIHBhcmEgcXVlIHBvc3NhbW9zIGVzcGlvbsOhLWxvc1xyXG5pbXBvcnQgeyBzdXBhYmFzZSB9IGZyb20gJy4uL2xpYi9zdXBhYmFzZUNsaWVudCc7XHJcbmltcG9ydCBFdmVudFNlY3VyaXR5U2VydmljZSBmcm9tICcuL0V2ZW50U2VjdXJpdHlTZXJ2aWNlJztcclxuaW1wb3J0IFB1c2hOb3RpZmljYXRpb25TZXJ2aWNlIGZyb20gJy4vUHVzaE5vdGlmaWNhdGlvblNlcnZpY2UnO1xyXG5pbXBvcnQgVHJ1c3RTY29yZVNlcnZpY2UgZnJvbSAnLi9UcnVzdFNjb3JlU2VydmljZSc7XHJcblxyXG4vLyBUeXBlY2FzdCBkb3MgbW9ja3MgcGFyYSB0ZXJtb3MgaW50ZWxsaXNlbnNlIGUgY29uZm9ybWlkYWRlIGNvbSBUeXBlU2NyaXB0XHJcbmNvbnN0IG1vY2tlZFN1cGFiYXNlID0gc3VwYWJhc2UgYXMgamVzdC5Nb2NrZWQ8dHlwZW9mIHN1cGFiYXNlPjtcclxuY29uc3QgbW9ja2VkU2VjdXJpdHlTZXJ2aWNlID0gRXZlbnRTZWN1cml0eVNlcnZpY2UgYXMgamVzdC5Nb2NrZWQ8dHlwZW9mIEV2ZW50U2VjdXJpdHlTZXJ2aWNlPjtcclxuY29uc3QgbW9ja2VkUHVzaFNlcnZpY2UgPSBQdXNoTm90aWZpY2F0aW9uU2VydmljZSBhcyBqZXN0Lk1vY2tlZDx0eXBlb2YgUHVzaE5vdGlmaWNhdGlvblNlcnZpY2U+O1xyXG5jb25zdCBtb2NrZWRUcnVzdFNlcnZpY2UgPSBUcnVzdFNjb3JlU2VydmljZSBhcyBqZXN0Lk1vY2tlZDx0eXBlb2YgVHJ1c3RTY29yZVNlcnZpY2U+O1xyXG5cclxuXHJcbi8vIC0tLSAzLiBDT05GSUdVUkHDh8ODTyBET1MgVEVTVEVTIC0tLVxyXG5cclxuZGVzY3JpYmUoJ0V2ZW50U3RhdHVzU2VydmljZScsICgpID0+IHtcclxuXHJcbiAgLy8gVXNhbW9zIHRpbWVycyBmYWxzb3MgcGFyYSBjb250cm9sYXIgbyBuZXcgRGF0ZSgpXHJcbiAgYmVmb3JlQWxsKCgpID0+IHtcclxuICAgIGplc3QudXNlRmFrZVRpbWVycygpO1xyXG4gIH0pO1xyXG5cclxuICAvLyBMaW1wYSB0b2RvcyBvcyBtb2NrcyBhbnRlcyBkZSBjYWRhIHRlc3RlXHJcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICAgIChtb2NrZWRTdXBhYmFzZS5mcm9tIGFzIGplc3QuTW9jaykubW9ja1Jlc2V0KCk7XHJcbiAgfSk7XHJcblxyXG4gIC8vIFJlc3RhdXJhIG9zIHRpbWVycyByZWFpcyBhcMOzcyB0b2RvcyBvcyB0ZXN0ZXNcclxuICBhZnRlckFsbCgoKSA9PiB7XHJcbiAgICBqZXN0LnVzZVJlYWxUaW1lcnMoKTtcclxuICB9KTtcclxuXHJcbiAgLy8gLS0tIDQuIFRFU1RFUyAtLS1cclxuXHJcbiAgZGVzY3JpYmUoJ0dlcmVuY2lhbWVudG8gZGUgQXV0by1VcGRhdGUnLCAoKSA9PiB7XHJcbiAgICBhZnRlckVhY2goKCkgPT4ge1xyXG4gICAgICAvLyBHYXJhbnRlIHF1ZSBwYXJhbW9zIHF1YWxxdWVyIHRpbWVyIGluaWNpYWRvIG5vcyB0ZXN0ZXNcclxuICAgICAgRXZlbnRTdGF0dXNTZXJ2aWNlLnN0b3BBdXRvVXBkYXRlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHN0YXJ0IGF1dG8tdXBkYXRlIGUgc2VyIFwicnVubmluZ1wiJywgKCkgPT4ge1xyXG4gICAgICAvLyBFc3Bpb25hIG8gbcOpdG9kbyBwcmluY2lwYWwgcGFyYSBldml0YXIgcXVlIGVsZSBleGVjdXRlIGEgbMOzZ2ljYSByZWFsXHJcbiAgICAgIGNvbnN0IHNweSA9IGplc3Quc3B5T24oRXZlbnRTdGF0dXNTZXJ2aWNlLCAndXBkYXRlQWxsRXZlbnRTdGF0dXNlcycpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBQcm9taXNlLnJlc29sdmUoKSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBpbnRlcnZhbElkID0gRXZlbnRTdGF0dXNTZXJ2aWNlLnN0YXJ0QXV0b1VwZGF0ZSgzMCk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QoaW50ZXJ2YWxJZCkudG9CZURlZmluZWQoKTtcclxuICAgICAgZXhwZWN0KEV2ZW50U3RhdHVzU2VydmljZS5pc0F1dG9VcGRhdGVSdW5uaW5nKCkpLnRvQmUodHJ1ZSk7XHJcbiAgICAgIGV4cGVjdChzcHkpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTsgLy8gRGV2ZSByb2RhciBpbWVkaWF0YW1lbnRlXHJcbiAgICAgIFxyXG4gICAgICBzcHkubW9ja1Jlc3RvcmUoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgc3RvcCBhdXRvLXVwZGF0ZScsICgpID0+IHtcclxuICAgICAgRXZlbnRTdGF0dXNTZXJ2aWNlLnN0YXJ0QXV0b1VwZGF0ZSgzMCk7XHJcbiAgICAgIGV4cGVjdChFdmVudFN0YXR1c1NlcnZpY2UuaXNBdXRvVXBkYXRlUnVubmluZygpKS50b0JlKHRydWUpO1xyXG5cclxuICAgICAgRXZlbnRTdGF0dXNTZXJ2aWNlLnN0b3BBdXRvVXBkYXRlKCk7XHJcbiAgICAgIGV4cGVjdChFdmVudFN0YXR1c1NlcnZpY2UuaXNBdXRvVXBkYXRlUnVubmluZygpKS50b0JlKGZhbHNlKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgndXBkYXRlRXZlbnRTdGF0dXMnLCAoKSA9PiB7XHJcbiAgICBpdCgnZGV2ZSBjaGFtYXIgc3VwYWJhc2UudXBkYXRlIGNvbSBvcyBwYXLDom1ldHJvcyBjb3JyZXRvcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgLy8g4pyFIENPUlJFw4fDg086IFVzYW5kbyBtb2NrSW1wbGVtZW50YXRpb25cclxuICAgICAgY29uc3QgbW9ja1VwZGF0ZUVxID0gamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBlcnJvcjogbnVsbCB9KSk7XHJcbiAgICAgIChtb2NrZWRTdXBhYmFzZS5mcm9tIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKHtcclxuICAgICAgICB1cGRhdGU6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgICAgICAgIGVxOiBtb2NrVXBkYXRlRXEsXHJcbiAgICAgICAgfSkpLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGF3YWl0IEV2ZW50U3RhdHVzU2VydmljZS51cGRhdGVFdmVudFN0YXR1cygxMjMsICdOb3ZvU3RhdHVzJyk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja2VkU3VwYWJhc2UuZnJvbSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ2V2ZW50cycpO1xyXG4gICAgICBleHBlY3QobW9ja2VkU3VwYWJhc2UuZnJvbSgnZXZlbnRzJykudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcclxuICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XHJcbiAgICAgICAgICBzdGF0dXM6ICdOb3ZvU3RhdHVzJyxcclxuICAgICAgICB9KVxyXG4gICAgICApO1xyXG4gICAgICBleHBlY3QobW9ja1VwZGF0ZUVxKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnaWQnLCAxMjMpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdMw7NnaWNhIGRlIFN0YXR1cyAodXBkYXRlQWxsRXZlbnRTdGF0dXNlcyknLCAoKSA9PiB7XHJcblxyXG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoJzIwMjUtMTAtMDFUMTA6MDA6MDBaJyk7XHJcbiAgICBcclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICAvLyBEZWZpbmUgYSBob3JhIGdsb2JhbCBwYXJhIHRvZG9zIG9zIHRlc3RlcyBkZSBsw7NnaWNhXHJcbiAgICAgIGplc3Quc2V0U3lzdGVtVGltZShub3cpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2RldmUgbXVkYXIgc3RhdHVzIHBhcmEgXCJFbSBBbmRhbWVudG9cIiBxdWFuZG8gYSBob3JhIGRlIGluw61jaW8gZm9yIGF0aW5naWRhJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBldmVudCA9IHtcclxuICAgICAgICBpZDogMSxcclxuICAgICAgICBzdGF0dXM6ICdBYmVydG8nLFxyXG4gICAgICAgIHN0YXJ0X3RpbWU6ICcyMDI1LTEwLTAxVDA5OjU5OjU5WicsIC8vIDEgc2VndW5kbyBhdHLDoXNcclxuICAgICAgICBlbmRfdGltZTogJzIwMjUtMTAtMDFUMTI6MDA6MDBaJyxcclxuICAgICAgfTtcclxuICAgICAgXHJcbiAgICAgIC8vIOKchSBDT1JSRcOHw4NPOiBVc2FuZG8gbW9ja0ltcGxlbWVudGF0aW9uXHJcbiAgICAgIGNvbnN0IG1vY2tTZWxlY3ROZXEgPSBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IFtldmVudF0sIGVycm9yOiBudWxsIH0pKTtcclxuICAgICAgKG1vY2tlZFN1cGFiYXNlLmZyb20gYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb25PbmNlKCgpID0+ICh7XHJcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICAgICAgICBuZXE6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgICAgICAgICAgbmVxOiBtb2NrU2VsZWN0TmVxLFxyXG4gICAgICAgICAgfSkpLFxyXG4gICAgICAgIH0pKSxcclxuICAgICAgfSkpO1xyXG4gICAgICBcclxuICAgICAgLy8g4pyFIENPUlJFw4fDg086IFVzYW5kbyBtb2NrSW1wbGVtZW50YXRpb25cclxuICAgICAgY29uc3QgbW9ja1VwZGF0ZUVxID0gamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBlcnJvcjogbnVsbCB9KSk7XHJcbiAgICAgIChtb2NrZWRTdXBhYmFzZS5mcm9tIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uT25jZSgoKSA9PiAoe1xyXG4gICAgICAgIHVwZGF0ZTogamVzdC5mbigoKSA9PiAoe1xyXG4gICAgICAgICAgZXE6IG1vY2tVcGRhdGVFcSxcclxuICAgICAgICB9KSksXHJcbiAgICAgIH0pKTtcclxuXHJcbiAgICAgIGF3YWl0IEV2ZW50U3RhdHVzU2VydmljZS51cGRhdGVBbGxFdmVudFN0YXR1c2VzKCk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja1NlbGVjdE5lcSkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICBleHBlY3QobW9ja2VkU3VwYWJhc2UuZnJvbSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ2V2ZW50cycpO1xyXG4gICAgICBleHBlY3QobW9ja1VwZGF0ZUVxKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnaWQnLCAxKTtcclxuICAgICAgZXhwZWN0KG1vY2tlZFN1cGFiYXNlLmZyb20oJ2V2ZW50cycpLnVwZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXHJcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyBzdGF0dXM6ICdFbSBBbmRhbWVudG8nIH0pXHJcbiAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnZGV2ZSBnZXJhciBzZW5oYSBlIGVudmlhciBwdXNoIDEgbWludXRvIGFudGVzIGRvIGV2ZW50bycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gbmV3IERhdGUoJzIwMjUtMTAtMDFUMTA6MDE6MDBaJyk7IC8vIERhcXVpIGEgMSBtaW5cclxuICAgICAgY29uc3QgZXZlbnQgPSB7XHJcbiAgICAgICAgaWQ6IDIsXHJcbiAgICAgICAgc3RhdHVzOiAnQWJlcnRvJyxcclxuICAgICAgICBzdGFydF90aW1lOiBzdGFydFRpbWUudG9JU09TdHJpbmcoKSxcclxuICAgICAgICBlbmRfdGltZTogJzIwMjUtMTAtMDFUMTI6MDA6MDBaJyxcclxuICAgICAgICBjcmVhdG9yX2lkOiAnaG9zdC1pZCcsXHJcbiAgICAgICAgdGl0bGU6ICdFdmVudG8gVGVzdGUnLFxyXG4gICAgICAgIGV2ZW50X2VudHJ5X3Bhc3N3b3JkOiBudWxsLCAvLyBTZW0gc2VuaGFcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIOKchSBDT1JSRcOHw4NPIChMaW5oYSAxOTApXHJcbiAgICAgIChtb2NrZWRTdXBhYmFzZS5mcm9tIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uT25jZSgoKSA9PiAoe1xyXG4gICAgICAgIHNlbGVjdDogamVzdC5mbigoKSA9PiAoe1xyXG4gICAgICAgICAgbmVxOiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICAgICAgICAgIG5lcTogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiBbZXZlbnRdLCBlcnJvcjogbnVsbCB9KSksXHJcbiAgICAgICAgICB9KSksXHJcbiAgICAgICAgfSkpLFxyXG4gICAgICB9KSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyDinIUgQ09SUkXDh8ODTyAoTGluaGEgMTk5KVxyXG4gICAgICAobW9ja2VkU3VwYWJhc2UuZnJvbSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbk9uY2UoKCkgPT4gKHtcclxuICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgICAgICAgIGVxOiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICAgICAgICAgIHNpbmdsZTogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiB7IHVzZXJuYW1lOiAnSG9zdCcgfSwgZXJyb3I6IG51bGwgfSkpLFxyXG4gICAgICAgICAgfSkpLFxyXG4gICAgICAgIH0pKSxcclxuICAgICAgfSkpO1xyXG4gICAgICBcclxuICAgICAgLy8g4pyFIENPUlJFw4fDg08gKExpbmhhIDIwOClcclxuICAgICAgKG1vY2tlZFN1cGFiYXNlLmZyb20gYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb25PbmNlKCgpID0+ICh7XHJcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICAgICAgICBlcTogamVzdC5mbigoKSA9PiAoe1xyXG4gICAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiBbeyB1c2VyX2lkOiAncGFydC0xJyB9XSwgZXJyb3I6IG51bGwgfSkpLFxyXG4gICAgICAgICAgfSkpLFxyXG4gICAgICAgIH0pKSxcclxuICAgICAgfSkpO1xyXG5cclxuICAgICAgYXdhaXQgRXZlbnRTdGF0dXNTZXJ2aWNlLnVwZGF0ZUFsbEV2ZW50U3RhdHVzZXMoKTtcclxuXHJcbiAgICAgIC8vIFZlcmlmaWNhIHNlIGEgc2VuaGEgZm9pIGdlcmFkYVxyXG4gICAgICBleHBlY3QobW9ja2VkU2VjdXJpdHlTZXJ2aWNlLmdlbmVyYXRlQW5kU2F2ZVBhc3N3b3JkKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgyKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFZlcmlmaWNhIHNlIG8gcHVzaCBmb2kgZW52aWFkbyBhbyBhbmZpdHJpw6NvXHJcbiAgICAgIGV4cGVjdChtb2NrZWRQdXNoU2VydmljZS5zZW5kUGFzc3dvcmRUb0hvc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxyXG4gICAgICAgICdob3N0LWlkJyxcclxuICAgICAgICAyLFxyXG4gICAgICAgICdtb2NrLTEyMycsIC8vIFNlbmhhIG1vY2thZGFcclxuICAgICAgICAnRXZlbnRvIFRlc3RlJ1xyXG4gICAgICApO1xyXG4gICAgICBcclxuICAgICAgLy8gVmVyaWZpY2Egc2UgbyBwdXNoIGZvaSBlbnZpYWRvIGFvcyBwYXJ0aWNpcGFudGVzXHJcbiAgICAgIGV4cGVjdChtb2NrZWRQdXNoU2VydmljZS5zZW5kRXZlbnRTdGFydE5vdGlmaWNhdGlvblRvUGFydGljaXBhbnRzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcclxuICAgICAgICBbJ3BhcnQtMSddLFxyXG4gICAgICAgIDIsXHJcbiAgICAgICAgJ0V2ZW50byBUZXN0ZSdcclxuICAgICAgKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBpdCgnZGV2ZSBibG9xdWVhciBlbnRyYWRhIDEgbWludXRvIGFudGVzIGRvIGZpbScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgZW5kVGltZSA9IG5ldyBEYXRlKCcyMDI1LTEwLTAxVDEwOjAxOjAwWicpOyAvLyBEYXF1aSBhIDEgbWluXHJcbiAgICAgIGNvbnN0IGV2ZW50ID0ge1xyXG4gICAgICAgIGlkOiAzLFxyXG4gICAgICAgIHN0YXR1czogJ0VtIEFuZGFtZW50bycsXHJcbiAgICAgICAgc3RhcnRfdGltZTogJzIwMjUtMTAtMDFUMDk6MDA6MDBaJyxcclxuICAgICAgICBlbmRfdGltZTogZW5kVGltZS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgIGVudHJ5X2xvY2tlZDogZmFsc2UsIC8vIE7Do28gYmxvcXVlYWRvXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyDinIUgQ09SUkXDh8ODTyAoTGluaGEgMjQ4KVxyXG4gICAgICAobW9ja2VkU3VwYWJhc2UuZnJvbSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbk9uY2UoKCkgPT4gKHtcclxuICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgICAgICAgIG5lcTogamVzdC5mbigoKSA9PiAoe1xyXG4gICAgICAgICAgICBuZXE6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgZGF0YTogW2V2ZW50XSwgZXJyb3I6IG51bGwgfSkpLFxyXG4gICAgICAgICAgfSkpLFxyXG4gICAgICAgIH0pKSxcclxuICAgICAgfSkpO1xyXG5cclxuICAgICAgYXdhaXQgRXZlbnRTdGF0dXNTZXJ2aWNlLnVwZGF0ZUFsbEV2ZW50U3RhdHVzZXMoKTtcclxuXHJcbiAgICAgIC8vIFZlcmlmaWNhIHNlIG8gYmxvcXVlaW8gZm9pIGNoYW1hZG9cclxuICAgICAgZXhwZWN0KG1vY2tlZFNlY3VyaXR5U2VydmljZS5sb2NrRXZlbnRFbnRyeSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoMyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnZGV2ZSBtdWRhciBzdGF0dXMgcGFyYSBcIkZpbmFsaXphZG9cIiBlIHBlbmFsaXphciBxdWVtIG7Do28gZm9pJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBlbmRUaW1lID0gbmV3IERhdGUoJzIwMjUtMTAtMDFUMDk6NTk6NTlaJyk7IC8vIDEgc2VndW5kbyBhdHLDoXNcclxuICAgICAgY29uc3QgZXZlbnQgPSB7XHJcbiAgICAgICAgaWQ6IDQsXHJcbiAgICAgICAgc3RhdHVzOiAnRW0gQW5kYW1lbnRvJyxcclxuICAgICAgICBzdGFydF90aW1lOiAnMjAyNS0xMC0wMVQwODowMDowMFonLFxyXG4gICAgICAgIGVuZF90aW1lOiBlbmRUaW1lLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyDinIUgQ09SUkXDh8ODTyAoTGluaGEgMjcyKVxyXG4gICAgICAobW9ja2VkU3VwYWJhc2UuZnJvbSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbk9uY2UoKCkgPT4gKHtcclxuICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgICAgICAgIG5lcTogamVzdC5mbigoKSA9PiAoe1xyXG4gICAgICAgICAgICBuZXE6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgZGF0YTogW2V2ZW50XSwgZXJyb3I6IG51bGwgfSkpLFxyXG4gICAgICAgICAgfSkpLFxyXG4gICAgICAgIH0pKSxcclxuICAgICAgfSkpO1xyXG4gICAgICBcclxuICAgICAgLy8g4pyFIENPUlJFw4fDg08gKExpbmhhIDI4MClcclxuICAgICAgKG1vY2tlZFN1cGFiYXNlLmZyb20gYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb25PbmNlKCgpID0+ICh7XHJcbiAgICAgICAgdXBkYXRlOiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBlcnJvcjogbnVsbCB9KSksXHJcbiAgICAgICAgfSkpLFxyXG4gICAgICB9KSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyDinIUgQ09SUkXDh8ODTyAoTGluaGEgMjg4KVxyXG4gICAgICAobW9ja2VkU3VwYWJhc2UuZnJvbSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbk9uY2UoKCkgPT4gKHtcclxuICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgICAgICAgIGVxOiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICAgICAgICAgIGVxOiBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IFtdLCBlcnJvcjogbnVsbCB9KSksXHJcbiAgICAgICAgICB9KSksXHJcbiAgICAgICAgfSkpLFxyXG4gICAgICB9KSk7XHJcbiAgICAgIFxyXG4gICAgICBhd2FpdCBFdmVudFN0YXR1c1NlcnZpY2UudXBkYXRlQWxsRXZlbnRTdGF0dXNlcygpO1xyXG4gICAgICBcclxuICAgICAgLy8gVmVyaWZpY2Egc2UgbyBzdGF0dXMgbXVkb3UgcGFyYSBGaW5hbGl6YWRvXHJcbiAgICAgIGV4cGVjdChtb2NrZWRTdXBhYmFzZS5mcm9tKCdldmVudHMnKS51cGRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxyXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsgc3RhdHVzOiAnRmluYWxpemFkbycgfSlcclxuICAgICAgKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFZlcmlmaWNhIHNlIGEgcGVuYWxpemHDp8OjbyBmb2kgY2hhbWFkYVxyXG4gICAgICBleHBlY3QobW9ja2VkVHJ1c3RTZXJ2aWNlLnBlbmFsaXplTm9TaG93c0ZvckV2ZW50KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg0KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkZXZlIG11ZGFyIHN0YXR1cyBwYXJhIFwiQ29uY2x1w61kb1wiIHNlIHRvZG9zIGF2YWxpYXJhbScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgZW5kVGltZSA9IG5ldyBEYXRlKCcyMDI1LTEwLTAxVDA5OjAwOjAwWicpOyAvLyBKw6EgdGVybWlub3VcclxuICAgICAgY29uc3QgZXZlbnQgPSB7XHJcbiAgICAgICAgaWQ6IDUsXHJcbiAgICAgICAgc3RhdHVzOiAnRmluYWxpemFkbycsXHJcbiAgICAgICAgc3RhcnRfdGltZTogJzIwMjUtMTAtMDFUMDg6MDA6MDBaJyxcclxuICAgICAgICBlbmRfdGltZTogZW5kVGltZS50b0lTT1N0cmluZygpLFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgcGFydGljaXBhbnRzID0gW1xyXG4gICAgICAgIHsgaWQ6ICdwMScsIHByZXNlbmNhX2NvbmZpcm1hZGE6IHRydWUsIGF2YWxpYWNhb19mZWl0YTogdHJ1ZSB9LFxyXG4gICAgICAgIHsgaWQ6ICdwMicsIHByZXNlbmNhX2NvbmZpcm1hZGE6IGZhbHNlLCBhdmFsaWFjYW9fZmVpdGE6IGZhbHNlIH0sIC8vIG7Do28gZm9pXHJcbiAgICAgICAgeyBpZDogJ3AzJywgcHJlc2VuY2FfY29uZmlybWFkYTogdHJ1ZSwgYXZhbGlhY2FvX2ZlaXRhOiB0cnVlIH0sXHJcbiAgICAgIF07XHJcblxyXG4gICAgICAvLyDinIUgQ09SUkXDh8ODTyAoTGluaGEgMzIzKVxyXG4gICAgICAobW9ja2VkU3VwYWJhc2UuZnJvbSBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbk9uY2UoKCkgPT4gKHtcclxuICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgICAgICAgIG5lcTogamVzdC5mbigoKSA9PiAoe1xyXG4gICAgICAgICAgICBuZXE6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgZGF0YTogW2V2ZW50XSwgZXJyb3I6IG51bGwgfSkpLFxyXG4gICAgICAgICAgfSkpLFxyXG4gICAgICAgIH0pKSxcclxuICAgICAgfSkpO1xyXG4gICAgICBcclxuICAgICAgLy8g4pyFIENPUlJFw4fDg08gKExpbmhhIDMzMilcclxuICAgICAgKG1vY2tlZFN1cGFiYXNlLmZyb20gYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb25PbmNlKCgpID0+ICh7XHJcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICAgICAgICBlcTogamVzdC5mbigoKSA9PiAoe1xyXG4gICAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiBwYXJ0aWNpcGFudHMsIGVycm9yOiBudWxsIH0pKSxcclxuICAgICAgICAgIH0pKSxcclxuICAgICAgICB9KSksXHJcbiAgICAgIH0pKTtcclxuICAgICAgXHJcbiAgICAgIC8vIOKchSBDT1JSRcOHw4NPIChMaW5oYSAzNDApXHJcbiAgICAgIChtb2NrZWRTdXBhYmFzZS5mcm9tIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uT25jZSgoKSA9PiAoe1xyXG4gICAgICAgIHVwZGF0ZTogamVzdC5mbigoKSA9PiAoe1xyXG4gICAgICAgICAgZXE6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgZXJyb3I6IG51bGwgfSkpLFxyXG4gICAgICAgIH0pKSxcclxuICAgICAgfSkpO1xyXG4gICAgICBcclxuICAgICAgYXdhaXQgRXZlbnRTdGF0dXNTZXJ2aWNlLnVwZGF0ZUFsbEV2ZW50U3RhdHVzZXMoKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFZlcmlmaWNhIHNlIG8gc3RhdHVzIG11ZG91IHBhcmEgQ29uY2x1w61kb1xyXG4gICAgICBleHBlY3QobW9ja2VkU3VwYWJhc2UuZnJvbSgnZXZlbnRzJykudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcclxuICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7IHN0YXR1czogJ0NvbmNsdcOtZG8nIH0pXHJcbiAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuIl0sInZlcnNpb24iOjN9