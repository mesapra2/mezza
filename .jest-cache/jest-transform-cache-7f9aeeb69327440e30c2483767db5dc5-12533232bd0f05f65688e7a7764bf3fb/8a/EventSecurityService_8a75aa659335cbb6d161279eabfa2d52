e77bc298e25135aa260152b4c3790e84
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// src/services/EventSecurityService.ts
const supabaseClient_1 = require("../lib/supabaseClient");
class EventSecurityService {
    /**
     * Gera uma senha numérica de 4 dígitos
     */
    static generatePassword() {
        return Math.floor(1000 + Math.random() * 9000).toString();
    }
    /**
     * Salva uma senha no evento
     */
    static async savePasswordToEvent(eventId, password) {
        // Valida formato da senha
        if (!/^\d{4}$/.test(password)) {
            return {
                success: false,
                error: 'Senha deve ser exatamente 4 dígitos'
            };
        }
        try {
            const { error } = await supabaseClient_1.supabase
                .from('events')
                .update({
                event_entry_password: password,
                entry_opened_at: new Date().toISOString()
            })
                .eq('id', eventId);
            if (error) {
                return {
                    success: false,
                    error
                };
            }
            return {
                success: true,
                password
            };
        }
        catch (error) {
            return {
                success: false,
                error: error
            };
        }
    }
    /**
     * Gera e salva uma senha automaticamente
     */
    static async generateAndSavePassword(eventId) {
        const password = this.generatePassword();
        return this.savePasswordToEvent(eventId, password);
    }
    /**
     * Verifica se o horário de entrada é válido
     */
    static async isEntryTimeValid(eventId) {
        try {
            const { data: event, error } = await supabaseClient_1.supabase
                .from('events')
                .select('start_time, end_time, status')
                .eq('id', eventId)
                .single();
            if (error || !event) {
                return {
                    allowed: false,
                    reason: 'Evento não encontrado'
                };
            }
            // Verifica status do evento
            const validStatuses = ['Confirmado', 'Em Andamento'];
            if (!validStatuses.includes(event.status)) {
                return {
                    allowed: false,
                    reason: 'Evento não está disponível para entrada'
                };
            }
            const now = new Date();
            const startTime = new Date(event.start_time);
            const endTime = new Date(event.end_time);
            // Permite entrada 1 minuto antes do início
            const entryStartTime = new Date(startTime.getTime() - 60000);
            // Verifica se está dentro da janela de entrada
            if (now < entryStartTime) {
                return {
                    allowed: false,
                    reason: 'Entrada ainda não liberada'
                };
            }
            if (now > endTime) {
                return {
                    allowed: false,
                    reason: 'Entrada encerrada'
                };
            }
            return { allowed: true };
        }
        catch (error) {
            return {
                allowed: false,
                reason: 'Erro ao validar horário'
            };
        }
    }
    /**
     * Valida a senha de entrada do participante
     */
    static async validateEntryPassword(params) {
        const { eventId, participantId, password } = params;
        // Verifica timing
        const timingCheck = await this.isEntryTimeValid(eventId);
        if (!timingCheck.allowed) {
            return {
                success: false,
                message: timingCheck.reason || 'Entrada não permitida'
            };
        }
        // Busca evento e senha
        const { data: event, error: eventError } = await supabaseClient_1.supabase
            .from('events')
            .select('event_entry_password, status')
            .eq('id', eventId)
            .single();
        if (eventError || !event) {
            return {
                success: false,
                message: 'Evento não encontrado'
            };
        }
        // Verifica senha
        if (event.event_entry_password !== password) {
            return {
                success: false,
                message: 'Senha incorreta. Tente novamente.'
            };
        }
        // Registra acesso do participante
        const { error: updateError } = await supabaseClient_1.supabase
            .from('event_participants')
            .update({
            com_acesso: true,
            entry_time: new Date().toISOString()
        })
            .eq('event_id', eventId)
            .eq('user_id', participantId);
        if (updateError) {
            return {
                success: false,
                message: 'Erro ao registrar acesso'
            };
        }
        return {
            success: true,
            message: '✅ Acesso liberado! Bem-vindo ao evento.'
        };
    }
    /**
     * Verifica se o usuário já tem acesso
     */
    static async hasUserAccess(eventId, userId) {
        try {
            const { data, error } = await supabaseClient_1.supabase
                .from('event_participants')
                .select('com_acesso')
                .eq('event_id', eventId)
                .eq('user_id', userId)
                .single();
            if (error || !data) {
                return false;
            }
            return data.com_acesso === true;
        }
        catch (error) {
            return false;
        }
    }
    /**
     * Bloqueia a entrada no evento
     */
    static async lockEventEntry(eventId) {
        try {
            const { error } = await supabaseClient_1.supabase
                .from('events')
                .update({
                entry_locked: true,
                entry_locked_at: new Date().toISOString()
            })
                .eq('id', eventId);
            if (error) {
                return {
                    success: false,
                    error
                };
            }
            return {
                success: true
            };
        }
        catch (error) {
            return {
                success: false,
                error: error
            };
        }
    }
    /**
     * Obtém o status de entrada do evento
     */
    static async getEntryStatus(eventId) {
        try {
            // Busca dados do evento
            const { data: event, error: eventError } = await supabaseClient_1.supabase
                .from('events')
                .select('event_entry_password, entry_locked, entry_locked_at, entry_opened_at')
                .eq('id', eventId)
                .single();
            if (eventError || !event) {
                return {
                    success: false,
                    error: 'Evento não encontrado'
                };
            }
            // Busca participantes
            const { data: participants, error: participantsError } = await supabaseClient_1.supabase
                .from('event_participants')
                .select('com_acesso')
                .eq('event_id', eventId);
            if (participantsError) {
                return {
                    success: false,
                    error: 'Erro ao buscar participantes'
                };
            }
            const totalWithAccess = participants?.filter(p => p.com_acesso).length || 0;
            const totalParticipants = participants?.length || 0;
            return {
                success: true,
                data: {
                    password: event.event_entry_password,
                    isLocked: event.entry_locked,
                    lockedAt: event.entry_locked_at,
                    openedAt: event.entry_opened_at,
                    totalWithAccess,
                    totalParticipants
                }
            };
        }
        catch (error) {
            return {
                success: false,
                error: 'Erro ao buscar status'
            };
        }
    }
}
exports.default = EventSecurityService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxzZXJ2aWNlc1xcRXZlbnRTZWN1cml0eVNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSx1Q0FBdUM7QUFDdkMsMERBQWlEO0FBcUNqRCxNQUFNLG9CQUFvQjtJQUN4Qjs7T0FFRztJQUNILE1BQU0sQ0FBQyxnQkFBZ0I7UUFDckIsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsSUFBSSxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDNUQsQ0FBQztJQUVEOztPQUVHO0lBQ0gsTUFBTSxDQUFDLEtBQUssQ0FBQyxtQkFBbUIsQ0FDOUIsT0FBZSxFQUNmLFFBQWdCO1FBRWhCLDBCQUEwQjtRQUMxQixJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDO1lBQzlCLE9BQU87Z0JBQ0wsT0FBTyxFQUFFLEtBQUs7Z0JBQ2QsS0FBSyxFQUFFLHFDQUFxQzthQUM3QyxDQUFDO1FBQ0osQ0FBQztRQUVELElBQUksQ0FBQztZQUNILE1BQU0sRUFBRSxLQUFLLEVBQUUsR0FBRyxNQUFNLHlCQUFRO2lCQUM3QixJQUFJLENBQUMsUUFBUSxDQUFDO2lCQUNkLE1BQU0sQ0FBQztnQkFDTixvQkFBb0IsRUFBRSxRQUFRO2dCQUM5QixlQUFlLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7YUFDMUMsQ0FBQztpQkFDRCxFQUFFLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1lBRXJCLElBQUksS0FBSyxFQUFFLENBQUM7Z0JBQ1YsT0FBTztvQkFDTCxPQUFPLEVBQUUsS0FBSztvQkFDZCxLQUFLO2lCQUNOLENBQUM7WUFDSixDQUFDO1lBRUQsT0FBTztnQkFDTCxPQUFPLEVBQUUsSUFBSTtnQkFDYixRQUFRO2FBQ1QsQ0FBQztRQUNKLENBQUM7UUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1lBQ2YsT0FBTztnQkFD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O2dCQUNMLE9BQU8sRUFBRSxJQUFJO2dCQUNiLElBQUksRUFBRTtvQkFDSixRQUFRLEVBQUUsS0FBSyxDQUFDLG9CQUFvQjtvQkFDcEMsUUFBUSxFQUFFLEtBQUssQ0FBQyxZQUFZO29CQUM1QixRQUFRLEVBQUUsS0FBSyxDQUFDLGVBQWU7b0JBQy9CLFFBQVEsRUFBRSxLQUFLLENBQUMsZUFBZTtvQkFDL0IsZUFBZTtvQkFDZixpQkFBaUI7aUJBQ2xCO2FBQ0YsQ0FBQztRQUNKLENBQUM7UUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1lBQ2YsT0FBTztnQkFDTCxPQUFPLEVBQUUsS0FBSztnQkFDZCxLQUFLLEVBQUUsdUJBQXVCO2FBQy9CLENBQUM7UUFDSixDQUFDO0lBQ0gsQ0FBQztDQUNGO0FBRUQsa0JBQWUsb0JBQW9CLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxzZXJ2aWNlc1xcRXZlbnRTZWN1cml0eVNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3NlcnZpY2VzL0V2ZW50U2VjdXJpdHlTZXJ2aWNlLnRzXHJcbmltcG9ydCB7IHN1cGFiYXNlIH0gZnJvbSAnLi4vbGliL3N1cGFiYXNlQ2xpZW50JztcclxuXHJcbmludGVyZmFjZSBTYXZlUGFzc3dvcmRSZXN1bHQge1xyXG4gIHN1Y2Nlc3M6IGJvb2xlYW47XHJcbiAgcGFzc3dvcmQ/OiBzdHJpbmc7XHJcbiAgZXJyb3I/OiBzdHJpbmcgfCBFcnJvcjtcclxufVxyXG5cclxuaW50ZXJmYWNlIEVudHJ5VGltZVZhbGlkYXRpb24ge1xyXG4gIGFsbG93ZWQ6IGJvb2xlYW47XHJcbiAgcmVhc29uPzogc3RyaW5nO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgVmFsaWRhdGVQYXNzd29yZFBhcmFtcyB7XHJcbiAgZXZlbnRJZDogbnVtYmVyO1xyXG4gIHBhcnRpY2lwYW50SWQ6IHN0cmluZztcclxuICBwYXNzd29yZDogc3RyaW5nO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgVmFsaWRhdGVQYXNzd29yZFJlc3VsdCB7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBtZXNzYWdlOiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBFbnRyeVN0YXR1c1Jlc3VsdCB7XHJcbiAgc3VjY2VzczogYm9vbGVhbjtcclxuICBkYXRhPzoge1xyXG4gICAgcGFzc3dvcmQ6IHN0cmluZztcclxuICAgIGlzTG9ja2VkOiBib29sZWFuO1xyXG4gICAgbG9ja2VkQXQ6IHN0cmluZyB8IG51bGw7XHJcbiAgICBvcGVuZWRBdDogc3RyaW5nIHwgbnVsbDtcclxuICAgIHRvdGFsV2l0aEFjY2VzczogbnVtYmVyO1xyXG4gICAgdG90YWxQYXJ0aWNpcGFudHM6IG51bWJlcjtcclxuICB9O1xyXG4gIGVycm9yPzogc3RyaW5nO1xyXG59XHJcblxyXG5jbGFzcyBFdmVudFNlY3VyaXR5U2VydmljZSB7XHJcbiAgLyoqXHJcbiAgICogR2VyYSB1bWEgc2VuaGEgbnVtw6lyaWNhIGRlIDQgZMOtZ2l0b3NcclxuICAgKi9cclxuICBzdGF0aWMgZ2VuZXJhdGVQYXNzd29yZCgpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIE1hdGguZmxvb3IoMTAwMCArIE1hdGgucmFuZG9tKCkgKiA5MDAwKS50b1N0cmluZygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2FsdmEgdW1hIHNlbmhhIG5vIGV2ZW50b1xyXG4gICAqL1xyXG4gIHN0YXRpYyBhc3luYyBzYXZlUGFzc3dvcmRUb0V2ZW50KFxyXG4gICAgZXZlbnRJZDogbnVtYmVyLFxyXG4gICAgcGFzc3dvcmQ6IHN0cmluZ1xyXG4gICk6IFByb21pc2U8U2F2ZVBhc3N3b3JkUmVzdWx0PiB7XHJcbiAgICAvLyBWYWxpZGEgZm9ybWF0byBkYSBzZW5oYVxyXG4gICAgaWYgKCEvXlxcZHs0fSQvLnRlc3QocGFzc3dvcmQpKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdTZW5oYSBkZXZlIHNlciBleGF0YW1lbnRlIDQgZMOtZ2l0b3MnXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgnZXZlbnRzJylcclxuICAgICAgICAudXBkYXRlKHtcclxuICAgICAgICAgIGV2ZW50X2VudHJ5X3Bhc3N3b3JkOiBwYXNzd29yZCxcclxuICAgICAgICAgIGVudHJ5X29wZW5lZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZXEoJ2lkJywgZXZlbnRJZCk7XHJcblxyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICBlcnJvclxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICBwYXNzd29yZFxyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogZXJyb3IgYXMgRXJyb3JcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdlcmEgZSBzYWx2YSB1bWEgc2VuaGEgYXV0b21hdGljYW1lbnRlXHJcbiAgICovXHJcbiAgc3RhdGljIGFzeW5jIGdlbmVyYXRlQW5kU2F2ZVBhc3N3b3JkKFxyXG4gICAgZXZlbnRJZDogbnVtYmVyXHJcbiAgKTogUHJvbWlzZTxTYXZlUGFzc3dvcmRSZXN1bHQ+IHtcclxuICAgIGNvbnN0IHBhc3N3b3JkID0gdGhpcy5nZW5lcmF0ZVBhc3N3b3JkKCk7XHJcbiAgICByZXR1cm4gdGhpcy5zYXZlUGFzc3dvcmRUb0V2ZW50KGV2ZW50SWQsIHBhc3N3b3JkKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFZlcmlmaWNhIHNlIG8gaG9yw6FyaW8gZGUgZW50cmFkYSDDqSB2w6FsaWRvXHJcbiAgICovXHJcbiAgc3RhdGljIGFzeW5jIGlzRW50cnlUaW1lVmFsaWQoXHJcbiAgICBldmVudElkOiBudW1iZXJcclxuICApOiBQcm9taXNlPEVudHJ5VGltZVZhbGlkYXRpb24+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHsgZGF0YTogZXZlbnQsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAgIC5mcm9tKCdldmVudHMnKVxyXG4gICAgICAgIC5zZWxlY3QoJ3N0YXJ0X3RpbWUsIGVuZF90aW1lLCBzdGF0dXMnKVxyXG4gICAgICAgIC5lcSgnaWQnLCBldmVudElkKVxyXG4gICAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICAgIGlmIChlcnJvciB8fCAhZXZlbnQpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgYWxsb3dlZDogZmFsc2UsXHJcbiAgICAgICAgICByZWFzb246ICdFdmVudG8gbsOjbyBlbmNvbnRyYWRvJ1xyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFZlcmlmaWNhIHN0YXR1cyBkbyBldmVudG9cclxuICAgICAgY29uc3QgdmFsaWRTdGF0dXNlcyA9IFsnQ29uZmlybWFkbycsICdFbSBBbmRhbWVudG8nXTtcclxuICAgICAgaWYgKCF2YWxpZFN0YXR1c2VzLmluY2x1ZGVzKGV2ZW50LnN0YXR1cykpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgYWxsb3dlZDogZmFsc2UsXHJcbiAgICAgICAgICByZWFzb246ICdFdmVudG8gbsOjbyBlc3TDoSBkaXNwb27DrXZlbCBwYXJhIGVudHJhZGEnXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcclxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gbmV3IERhdGUoZXZlbnQuc3RhcnRfdGltZSk7XHJcbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBuZXcgRGF0ZShldmVudC5lbmRfdGltZSk7XHJcblxyXG4gICAgICAvLyBQZXJtaXRlIGVudHJhZGEgMSBtaW51dG8gYW50ZXMgZG8gaW7DrWNpb1xyXG4gICAgICBjb25zdCBlbnRyeVN0YXJ0VGltZSA9IG5ldyBEYXRlKHN0YXJ0VGltZS5nZXRUaW1lKCkgLSA2MDAwMCk7XHJcblxyXG4gICAgICAvLyBWZXJpZmljYSBzZSBlc3TDoSBkZW50cm8gZGEgamFuZWxhIGRlIGVudHJhZGFcclxuICAgICAgaWYgKG5vdyA8IGVudHJ5U3RhcnRUaW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgcmVhc29uOiAnRW50cmFkYSBhaW5kYSBuw6NvIGxpYmVyYWRhJ1xyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChub3cgPiBlbmRUaW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgcmVhc29uOiAnRW50cmFkYSBlbmNlcnJhZGEnXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHsgYWxsb3dlZDogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBhbGxvd2VkOiBmYWxzZSxcclxuICAgICAgICByZWFzb246ICdFcnJvIGFvIHZhbGlkYXIgaG9yw6FyaW8nXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBWYWxpZGEgYSBzZW5oYSBkZSBlbnRyYWRhIGRvIHBhcnRpY2lwYW50ZVxyXG4gICAqL1xyXG4gIHN0YXRpYyBhc3luYyB2YWxpZGF0ZUVudHJ5UGFzc3dvcmQoXHJcbiAgICBwYXJhbXM6IFZhbGlkYXRlUGFzc3dvcmRQYXJhbXNcclxuICApOiBQcm9taXNlPFZhbGlkYXRlUGFzc3dvcmRSZXN1bHQ+IHtcclxuICAgIGNvbnN0IHsgZXZlbnRJZCwgcGFydGljaXBhbnRJZCwgcGFzc3dvcmQgfSA9IHBhcmFtcztcclxuXHJcbiAgICAvLyBWZXJpZmljYSB0aW1pbmdcclxuICAgIGNvbnN0IHRpbWluZ0NoZWNrID0gYXdhaXQgdGhpcy5pc0VudHJ5VGltZVZhbGlkKGV2ZW50SWQpO1xyXG4gICAgaWYgKCF0aW1pbmdDaGVjay5hbGxvd2VkKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgbWVzc2FnZTogdGltaW5nQ2hlY2sucmVhc29uIHx8ICdFbnRyYWRhIG7Do28gcGVybWl0aWRhJ1xyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEJ1c2NhIGV2ZW50byBlIHNlbmhhXHJcbiAgICBjb25zdCB7IGRhdGE6IGV2ZW50LCBlcnJvcjogZXZlbnRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2V2ZW50cycpXHJcbiAgICAgIC5zZWxlY3QoJ2V2ZW50X2VudHJ5X3Bhc3N3b3JkLCBzdGF0dXMnKVxyXG4gICAgICAuZXEoJ2lkJywgZXZlbnRJZClcclxuICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgIGlmIChldmVudEVycm9yIHx8ICFldmVudCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdFdmVudG8gbsOjbyBlbmNvbnRyYWRvJ1xyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFZlcmlmaWNhIHNlbmhhXHJcbiAgICBpZiAoZXZlbnQuZXZlbnRfZW50cnlfcGFzc3dvcmQgIT09IHBhc3N3b3JkKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgbWVzc2FnZTogJ1NlbmhhIGluY29ycmV0YS4gVGVudGUgbm92YW1lbnRlLidcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZWdpc3RyYSBhY2Vzc28gZG8gcGFydGljaXBhbnRlXHJcbiAgICBjb25zdCB7IGVycm9yOiB1cGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgLmZyb20oJ2V2ZW50X3BhcnRpY2lwYW50cycpXHJcbiAgICAgIC51cGRhdGUoe1xyXG4gICAgICAgIGNvbV9hY2Vzc286IHRydWUsXHJcbiAgICAgICAgZW50cnlfdGltZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgIH0pXHJcbiAgICAgIC5lcSgnZXZlbnRfaWQnLCBldmVudElkKVxyXG4gICAgICAuZXEoJ3VzZXJfaWQnLCBwYXJ0aWNpcGFudElkKTtcclxuXHJcbiAgICBpZiAodXBkYXRlRXJyb3IpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBtZXNzYWdlOiAnRXJybyBhbyByZWdpc3RyYXIgYWNlc3NvJ1xyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIG1lc3NhZ2U6ICfinIUgQWNlc3NvIGxpYmVyYWRvISBCZW0tdmluZG8gYW8gZXZlbnRvLidcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBWZXJpZmljYSBzZSBvIHVzdcOhcmlvIGrDoSB0ZW0gYWNlc3NvXHJcbiAgICovXHJcbiAgc3RhdGljIGFzeW5jIGhhc1VzZXJBY2Nlc3MoXHJcbiAgICBldmVudElkOiBudW1iZXIsXHJcbiAgICB1c2VySWQ6IHN0cmluZ1xyXG4gICk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgnZXZlbnRfcGFydGljaXBhbnRzJylcclxuICAgICAgICAuc2VsZWN0KCdjb21fYWNlc3NvJylcclxuICAgICAgICAuZXEoJ2V2ZW50X2lkJywgZXZlbnRJZClcclxuICAgICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXHJcbiAgICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgICAgaWYgKGVycm9yIHx8ICFkYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gZGF0YS5jb21fYWNlc3NvID09PSB0cnVlO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQmxvcXVlaWEgYSBlbnRyYWRhIG5vIGV2ZW50b1xyXG4gICAqL1xyXG4gIHN0YXRpYyBhc3luYyBsb2NrRXZlbnRFbnRyeShldmVudElkOiBudW1iZXIpOiBQcm9taXNlPFNhdmVQYXNzd29yZFJlc3VsdD4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgnZXZlbnRzJylcclxuICAgICAgICAudXBkYXRlKHtcclxuICAgICAgICAgIGVudHJ5X2xvY2tlZDogdHJ1ZSxcclxuICAgICAgICAgIGVudHJ5X2xvY2tlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZXEoJ2lkJywgZXZlbnRJZCk7XHJcblxyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICBlcnJvclxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VjY2VzczogdHJ1ZVxyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogZXJyb3IgYXMgRXJyb3JcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE9idMOpbSBvIHN0YXR1cyBkZSBlbnRyYWRhIGRvIGV2ZW50b1xyXG4gICAqL1xyXG4gIHN0YXRpYyBhc3luYyBnZXRFbnRyeVN0YXR1cyhldmVudElkOiBudW1iZXIpOiBQcm9taXNlPEVudHJ5U3RhdHVzUmVzdWx0PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBCdXNjYSBkYWRvcyBkbyBldmVudG9cclxuICAgICAgY29uc3QgeyBkYXRhOiBldmVudCwgZXJyb3I6IGV2ZW50RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oJ2V2ZW50cycpXHJcbiAgICAgICAgLnNlbGVjdCgnZXZlbnRfZW50cnlfcGFzc3dvcmQsIGVudHJ5X2xvY2tlZCwgZW50cnlfbG9ja2VkX2F0LCBlbnRyeV9vcGVuZWRfYXQnKVxyXG4gICAgICAgIC5lcSgnaWQnLCBldmVudElkKVxyXG4gICAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICAgIGlmIChldmVudEVycm9yIHx8ICFldmVudCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgIGVycm9yOiAnRXZlbnRvIG7Do28gZW5jb250cmFkbydcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBCdXNjYSBwYXJ0aWNpcGFudGVzXHJcbiAgICAgIGNvbnN0IHsgZGF0YTogcGFydGljaXBhbnRzLCBlcnJvcjogcGFydGljaXBhbnRzRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oJ2V2ZW50X3BhcnRpY2lwYW50cycpXHJcbiAgICAgICAgLnNlbGVjdCgnY29tX2FjZXNzbycpXHJcbiAgICAgICAgLmVxKCdldmVudF9pZCcsIGV2ZW50SWQpO1xyXG5cclxuICAgICAgaWYgKHBhcnRpY2lwYW50c0Vycm9yKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6ICdFcnJvIGFvIGJ1c2NhciBwYXJ0aWNpcGFudGVzJ1xyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHRvdGFsV2l0aEFjY2VzcyA9IHBhcnRpY2lwYW50cz8uZmlsdGVyKHAgPT4gcC5jb21fYWNlc3NvKS5sZW5ndGggfHwgMDtcclxuICAgICAgY29uc3QgdG90YWxQYXJ0aWNpcGFudHMgPSBwYXJ0aWNpcGFudHM/Lmxlbmd0aCB8fCAwO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIHBhc3N3b3JkOiBldmVudC5ldmVudF9lbnRyeV9wYXNzd29yZCxcclxuICAgICAgICAgIGlzTG9ja2VkOiBldmVudC5lbnRyeV9sb2NrZWQsXHJcbiAgICAgICAgICBsb2NrZWRBdDogZXZlbnQuZW50cnlfbG9ja2VkX2F0LFxyXG4gICAgICAgICAgb3BlbmVkQXQ6IGV2ZW50LmVudHJ5X29wZW5lZF9hdCxcclxuICAgICAgICAgIHRvdGFsV2l0aEFjY2VzcyxcclxuICAgICAgICAgIHRvdGFsUGFydGljaXBhbnRzXHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0Vycm8gYW8gYnVzY2FyIHN0YXR1cydcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEV2ZW50U2VjdXJpdHlTZXJ2aWNlOyJdLCJ2ZXJzaW9uIjozfQ==