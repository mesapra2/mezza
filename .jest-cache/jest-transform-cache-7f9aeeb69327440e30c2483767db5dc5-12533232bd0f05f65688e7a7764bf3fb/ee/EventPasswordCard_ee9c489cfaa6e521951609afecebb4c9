f584ced1d6f26f82a9c89cf50af9dff4
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const jsx_runtime_1 = require("react/jsx-runtime");
// src/features/partner/components/EventPasswordCard.jsx
const react_1 = require("react");
const prop_types_1 = tslib_1.__importDefault(require("prop-types"));
const framer_motion_1 = require("framer-motion");
const lucide_react_1 = require("lucide-react");
const supabaseClient_1 = require("@/lib/supabaseClient");
const use_toast_1 = require("@/features/shared/components/ui/use-toast");
const EventPasswordCard = ({ eventId }) => {
    const [password, setPassword] = (0, react_1.useState)(null);
    const [loading, setLoading] = (0, react_1.useState)(true);
    const [copied, setCopied] = (0, react_1.useState)(false);
    const [showPassword, setShowPassword] = (0, react_1.useState)(false);
    const [timeUntilStart, setTimeUntilStart] = (0, react_1.useState)(null);
    const [participantsWithAccess, setParticipantsWithAccess] = (0, react_1.useState)([]);
    const { toast } = (0, use_toast_1.useToast)();
    (0, react_1.useEffect)(() => {
        const loadEventData = async () => {
            try {
                const { data: event, error } = await supabaseClient_1.supabase
                    .from('events')
                    .select('event_entry_password, start_time, end_time')
                    .eq('id', eventId)
                    .single();
                if (error)
                    throw error;
                setPassword(event.event_entry_password);
                // Calcular tempo atÃ© o evento comeÃ§ar
                const startTime = new Date(event.start_time);
                const now = new Date();
                const diff = startTime - now;
                if (diff > 0) {
                    setTimeUntilStart(Math.ceil(diff / 1000 / 60)); // minutos
                }
                else {
                    setTimeUntilStart(0);
                }
                // Buscar participantes que jÃ¡ entraram
                if (event.event_entry_password) {
                    const { data: participants, error: partError } = await supabaseClient_1.supabase
                        .from('event_participants')
                        .select(`
              id,
              presenca_confirmada,
              entry_time,
              user:profiles!event_participants_user_id_fkey(
                id,
                username,
                avatar_url
              )
            `)
                        .eq('event_id', eventId)
                        .eq('status', 'aprovado')
                        .eq('presenca_confirmada', true)
                        .order('entry_time', { ascending: true });
                    if (!partError && participants) {
                        setParticipantsWithAccess(participants);
                    }
                }
            }
            catch (error) {
                console.error('âŒ Erro ao carregar senha:', error);
            }
            finally {
                setLoading(false);
            }
        };
        loadEventData();
        // Atualizar a cada 10 segundos
        const interval = setInterval(loadEventData, 10000);
        return () => clearInterval(interval);
    }, [eventId]);
    const handleCopyPassword = () => {
        if (!password)
            return;
        navigator.clipboard.writeText(password);
        setCopied(true);
        toast({
            title: 'ðŸ“‹ Senha copiada!',
            description: 'A senha foi copiada para a Ã¡rea de transferÃªncia',
        });
        setTimeout(() => setCopied(false), 2000);
    };
    if (loading) {
        return ((0, jsx_runtime_1.jsxs)("div", { className: "glass-effect rounded-lg p-4 border border-white/10 animate-pulse", children: [(0, jsx_runtime_1.jsx)("div", { className: "h-6 bg-white/10 rounded w-1/2 mb-2" }), (0, jsx_runtime_1.jsx)("div", { className: "h-4 bg-white/10 rounded w-3/4" })] }));
    }
    // Se ainda nÃ£o tem senha (falta mais de 2 minutos)
    if (!password) {
        return ((0, jsx_runtime_1.jsx)(framer_motion_1.motion.div, { initial: { opacity: 0, y: 10 }, animate: { opacity: 1, y: 0 }, className: "glass-effect rounded-lg p-4 border border-blue-500/30 bg-blue-500/5", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-start gap-3", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Clock, { className: "w-5 h-5 text-blue-400 mt-0.5" }), (0, jsx_runtime_1.jsxs)("div", { className: "flex-1", children: [(0, jsx_runtime_1.jsx)("h4", { className: "text-blue-300 font-semibold text-sm mb-1", children: "Senha ser\u00E1 gerada em breve" }), (0, jsx_runtime_1.jsx)("p", { className: "text-blue-200/80 text-xs", children: timeUntilStart !== null && timeUntilStart > 2
                                    ? `A senha serÃ¡ gerada faltando 1 minuto para o evento (em ~${timeUntilStart} min)`
                                    : 'A senha estÃ¡ sendo gerada...' })] })] }) }));
    }
    // Tem senha gerada
    return ((0, jsx_runtime_1.jsxs)(framer_motion_1.motion.div, { initial: { scale: 0.95, opacity: 0 }, animate: { scale: 1, opacity: 1 }, className: "glass-effect rounded-lg p-4 border border-green-500/30 bg-gradient-to-br from-green-500/10 to-emerald-500/10 space-y-3", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-start gap-3", children: [(0, jsx_runtime_1.jsx)("div", { className: "w-10 h-10 rounded-full bg-green-500/20 flex items-center justify-center", children: (0, jsx_runtime_1.jsx)(lucide_react_1.Key, { className: "w-5 h-5 text-green-400" }) }), (0, jsx_runtime_1.jsxs)("div", { className: "flex-1", children: [(0, jsx_runtime_1.jsx)("h4", { className: "text-green-300 font-semibold text-sm mb-1", children: "\uD83D\uDD10 Senha de Entrada Gerada!" }), (0, jsx_runtime_1.jsx)("p", { className: "text-green-200/80 text-xs", children: "Compartilhe esta senha com os participantes para entrarem no evento" })] })] }), (0, jsx_runtime_1.jsxs)("div", { className: "space-y-3", children: [(0, jsx_runtime_1.jsx)("div", { className: "relative", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between p-3 rounded-lg bg-black/30 border border-green-500/30", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-3", children: [(0, jsx_runtime_1.jsx)("span", { className: "text-xs text-white/60 font-medium", children: "SENHA:" }), (0, jsx_runtime_1.jsx)("span", { className: `text-2xl font-bold tracking-wider text-green-400 font-mono ${showPassword ? '' : 'filter blur-sm select-none'}`, children: password })] }), (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2", children: [(0, jsx_runtime_1.jsx)("button", { onClick: () => setShowPassword(!showPassword), className: "p-2 rounded-lg hover:bg-white/10 text-white/60 hover:text-white transition-colors", title: showPassword ? 'Ocultar senha' : 'Mostrar senha', children: showPassword ? ((0, jsx_runtime_1.jsx)(lucide_react_1.EyeOff, { className: "w-4 h-4" })) : ((0, jsx_runtime_1.jsx)(lucide_react_1.Eye, { className: "w-4 h-4" })) }), (0, jsx_runtime_1.jsx)("button", { onClick: handleCopyPassword, className: "p-2 rounded-lg hover:bg-white/10 text-white/60 hover:text-white transition-colors", title: "Copiar senha", children: copied ? ((0, jsx_runtime_1.jsx)(lucide_react_1.CheckCircle, { className: "w-4 h-4 text-green-400" })) : ((0, jsx_runtime_1.jsx)(lucide_react_1.Copy, { className: "w-4 h-4" })) })] })] }) }), (0, jsx_runtime_1.jsx)("div", { className: "p-3 rounded-lg bg-blue-500/10 border border-blue-500/20", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-start gap-2", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.AlertCircle, { className: "w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0" }), (0, jsx_runtime_1.jsxs)("div", { className: "text-xs text-blue-200/80", children: [(0, jsx_runtime_1.jsx)("p", { className: "font-semibold mb-1", children: "Como usar:" }), (0, jsx_runtime_1.jsxs)("ol", { className: "list-decimal list-inside space-y-1 text-blue-200/70", children: [(0, jsx_runtime_1.jsx)("li", { children: "Compartilhe esta senha com os participantes" }), (0, jsx_runtime_1.jsx)("li", { children: "Eles devem digitar na p\u00E1gina do evento" }), (0, jsx_runtime_1.jsx)("li", { children: "A entrada ser\u00E1 liberada automaticamente" })] })] })] }) }), timeUntilStart !== null && timeUntilStart === 0 && ((0, jsx_runtime_1.jsx)("div", { className: "p-2 rounded-lg bg-green-500/20 border border-green-500/30 text-center", children: (0, jsx_runtime_1.jsx)("p", { className: "text-xs text-green-300 font-semibold", children: "\uD83C\uDF89 Evento em andamento!" }) })), participantsWithAccess.length > 0 && ((0, jsx_runtime_1.jsxs)("div", { className: "p-3 rounded-lg bg-green-500/10 border border-green-500/20", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2 mb-2", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Users, { className: "w-4 h-4 text-green-400" }), (0, jsx_runtime_1.jsxs)("h5", { className: "text-green-300 font-semibold text-xs", children: ["Participantes que j\u00E1 entraram (", participantsWithAccess.length, ")"] })] }), (0, jsx_runtime_1.jsx)("div", { className: "flex flex-wrap gap-2", children: participantsWithAccess.map((participant) => ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center gap-2 px-2 py-1 rounded-lg bg-green-500/20 border border-green-500/30", title: `Entrou: ${participant.entry_time ? new Date(participant.entry_time).toLocaleTimeString() : 'Agora'}`, children: [(0, jsx_runtime_1.jsx)("img", { src: participant.user?.avatar_url ||
                                                `https://ui-avatars.com/api/?name=${encodeURIComponent(participant.user?.username || 'User')}&background=10b981&color=fff&size=32`, alt: participant.user?.username, className: "w-5 h-5 rounded-full border border-green-400/50" }), (0, jsx_runtime_1.jsx)("span", { className: "text-xs text-green-200 font-medium", children: participant.user?.username })] }, participant.id))) })] }))] })] }));
};
EventPasswordCard.propTypes = {
    eventId: prop_types_1.default.number.isRequired,
};
exports.default = EventPasswordCard;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXERFVk1peFxcQXBwLk1lc2FwcmEyLmNvbVxcc3JjXFxmZWF0dXJlc1xccGFydG5lclxcY29tcG9uZW50c1xcRXZlbnRQYXNzd29yZENhcmQuanN4IiwibWFwcGluZ3MiOiI7Ozs7QUFBQSx3REFBd0Q7QUFDeEQsaUNBQTRDO0FBQzVDLG9FQUFtQztBQUNuQyxpREFBdUM7QUFDdkMsK0NBQThGO0FBQzlGLHlEQUFnRDtBQUNoRCx5RUFBcUU7QUFFckUsTUFBTSxpQkFBaUIsR0FBRyxDQUFDLEVBQUUsT0FBTyxFQUFFLEVBQUUsRUFBRTtJQUN4QyxNQUFNLENBQUMsUUFBUSxFQUFFLFdBQVcsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxJQUFJLENBQUMsQ0FBQztJQUMvQyxNQUFNLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxJQUFJLENBQUMsQ0FBQztJQUM3QyxNQUFNLENBQUMsTUFBTSxFQUFFLFNBQVMsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxLQUFLLENBQUMsQ0FBQztJQUM1QyxNQUFNLENBQUMsWUFBWSxFQUFFLGVBQWUsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxLQUFLLENBQUMsQ0FBQztJQUN4RCxNQUFNLENBQUMsY0FBYyxFQUFFLGlCQUFpQixDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLElBQUksQ0FBQyxDQUFDO0lBQzNELE1BQU0sQ0FBQyxzQkFBc0IsRUFBRSx5QkFBeUIsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxFQUFFLENBQUMsQ0FBQztJQUN6RSxNQUFNLEVBQUUsS0FBSyxFQUFFLEdBQUcsSUFBQSxvQkFBUSxHQUFFLENBQUM7SUFFN0IsSUFBQSxpQkFBUyxFQUFDLEdBQUcsRUFBRTtRQUNiLE1BQU0sYUFBYSxHQUFHLEtBQUssSUFBSSxFQUFFO1lBQy9CLElBQUksQ0FBQztnQkFDSCxNQUFNLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsR0FBRyxNQUFNLHlCQUFRO3FCQUMxQyxJ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RSxXQUFXLENBQUMsSUFBSSxFQUFFLFFBQVEsRUFDL0IsU0FBUyxFQUFDLGlEQUFpRCxHQUMzRCxFQUNGLGlDQUFNLFNBQVMsRUFBQyxvQ0FBb0MsWUFDakQsV0FBVyxDQUFDLElBQUksRUFBRSxRQUFRLEdBQ3RCLEtBaEJGLFdBQVcsQ0FBQyxFQUFFLENBaUJmLENBQ1AsQ0FBQyxHQUNFLElBQ0YsQ0FDUCxJQUNHLElBQ0ssQ0FDZCxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBRUYsaUJBQWlCLENBQUMsU0FBUyxHQUFHO0lBQzVCLE9BQU8sRUFBRSxvQkFBUyxDQUFDLE1BQU0sQ0FBQyxVQUFVO0NBQ3JDLENBQUM7QUFFRixrQkFBZSxpQkFBaUIsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcREVWTWl4XFxBcHAuTWVzYXByYTIuY29tXFxzcmNcXGZlYXR1cmVzXFxwYXJ0bmVyXFxjb21wb25lbnRzXFxFdmVudFBhc3N3b3JkQ2FyZC5qc3giXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL2ZlYXR1cmVzL3BhcnRuZXIvY29tcG9uZW50cy9FdmVudFBhc3N3b3JkQ2FyZC5qc3hcclxuaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcclxuaW1wb3J0IHsgbW90aW9uIH0gZnJvbSAnZnJhbWVyLW1vdGlvbic7XHJcbmltcG9ydCB7IEtleSwgQ2xvY2ssIENvcHksIENoZWNrQ2lyY2xlLCBFeWUsIEV5ZU9mZiwgQWxlcnRDaXJjbGUsIFVzZXJzIH0gZnJvbSAnbHVjaWRlLXJlYWN0JztcclxuaW1wb3J0IHsgc3VwYWJhc2UgfSBmcm9tICdAL2xpYi9zdXBhYmFzZUNsaWVudCc7XHJcbmltcG9ydCB7IHVzZVRvYXN0IH0gZnJvbSAnQC9mZWF0dXJlcy9zaGFyZWQvY29tcG9uZW50cy91aS91c2UtdG9hc3QnO1xyXG5cclxuY29uc3QgRXZlbnRQYXNzd29yZENhcmQgPSAoeyBldmVudElkIH0pID0+IHtcclxuICBjb25zdCBbcGFzc3dvcmQsIHNldFBhc3N3b3JkXSA9IHVzZVN0YXRlKG51bGwpO1xyXG4gIGNvbnN0IFtsb2FkaW5nLCBzZXRMb2FkaW5nXSA9IHVzZVN0YXRlKHRydWUpO1xyXG4gIGNvbnN0IFtjb3BpZWQsIHNldENvcGllZF0gPSB1c2VTdGF0ZShmYWxzZSk7XHJcbiAgY29uc3QgW3Nob3dQYXNzd29yZCwgc2V0U2hvd1Bhc3N3b3JkXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICBjb25zdCBbdGltZVVudGlsU3RhcnQsIHNldFRpbWVVbnRpbFN0YXJ0XSA9IHVzZVN0YXRlKG51bGwpO1xyXG4gIGNvbnN0IFtwYXJ0aWNpcGFudHNXaXRoQWNjZXNzLCBzZXRQYXJ0aWNpcGFudHNXaXRoQWNjZXNzXSA9IHVzZVN0YXRlKFtdKTtcclxuICBjb25zdCB7IHRvYXN0IH0gPSB1c2VUb2FzdCgpO1xyXG5cclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgY29uc3QgbG9hZEV2ZW50RGF0YSA9IGFzeW5jICgpID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB7IGRhdGE6IGV2ZW50LCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAgIC5mcm9tKCdldmVudHMnKVxyXG4gICAgICAgICAgLnNlbGVjdCgnZXZlbnRfZW50cnlfcGFzc3dvcmQsIHN0YXJ0X3RpbWUsIGVuZF90aW1lJylcclxuICAgICAgICAgIC5lcSgnaWQnLCBldmVudElkKVxyXG4gICAgICAgICAgLnNpbmdsZSgpO1xyXG5cclxuICAgICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xyXG5cclxuICAgICAgICBzZXRQYXNzd29yZChldmVudC5ldmVudF9lbnRyeV9wYXNzd29yZCk7XHJcblxyXG4gICAgICAgIC8vIENhbGN1bGFyIHRlbXBvIGF0w6kgbyBldmVudG8gY29tZcOnYXJcclxuICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBuZXcgRGF0ZShldmVudC5zdGFydF90aW1lKTtcclxuICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgIGNvbnN0IGRpZmYgPSBzdGFydFRpbWUgLSBub3c7XHJcblxyXG4gICAgICAgIGlmIChkaWZmID4gMCkge1xyXG4gICAgICAgICAgc2V0VGltZVVudGlsU3RhcnQoTWF0aC5jZWlsKGRpZmYgLyAxMDAwIC8gNjApKTsgLy8gbWludXRvc1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBzZXRUaW1lVW50aWxTdGFydCgwKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEJ1c2NhciBwYXJ0aWNpcGFudGVzIHF1ZSBqw6EgZW50cmFyYW1cclxuICAgICAgICBpZiAoZXZlbnQuZXZlbnRfZW50cnlfcGFzc3dvcmQpIHtcclxuICAgICAgICAgIGNvbnN0IHsgZGF0YTogcGFydGljaXBhbnRzLCBlcnJvcjogcGFydEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxyXG4gICAgICAgICAgICAuZnJvbSgnZXZlbnRfcGFydGljaXBhbnRzJylcclxuICAgICAgICAgICAgLnNlbGVjdChgXHJcbiAgICAgICAgICAgICAgaWQsXHJcbiAgICAgICAgICAgICAgcHJlc2VuY2FfY29uZmlybWFkYSxcclxuICAgICAgICAgICAgICBlbnRyeV90aW1lLFxyXG4gICAgICAgICAgICAgIHVzZXI6cHJvZmlsZXMhZXZlbnRfcGFydGljaXBhbnRzX3VzZXJfaWRfZmtleShcclxuICAgICAgICAgICAgICAgIGlkLFxyXG4gICAgICAgICAgICAgICAgdXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICBhdmF0YXJfdXJsXHJcbiAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICBgKVxyXG4gICAgICAgICAgICAuZXEoJ2V2ZW50X2lkJywgZXZlbnRJZClcclxuICAgICAgICAgICAgLmVxKCdzdGF0dXMnLCAnYXByb3ZhZG8nKVxyXG4gICAgICAgICAgICAuZXEoJ3ByZXNlbmNhX2NvbmZpcm1hZGEnLCB0cnVlKVxyXG4gICAgICAgICAgICAub3JkZXIoJ2VudHJ5X3RpbWUnLCB7IGFzY2VuZGluZzogdHJ1ZSB9KTtcclxuXHJcbiAgICAgICAgICBpZiAoIXBhcnRFcnJvciAmJiBwYXJ0aWNpcGFudHMpIHtcclxuICAgICAgICAgICAgc2V0UGFydGljaXBhbnRzV2l0aEFjY2VzcyhwYXJ0aWNpcGFudHMpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJybyBhbyBjYXJyZWdhciBzZW5oYTonLCBlcnJvcik7XHJcbiAgICAgIH0gZmluYWxseSB7XHJcbiAgICAgICAgc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgbG9hZEV2ZW50RGF0YSgpO1xyXG5cclxuICAgIC8vIEF0dWFsaXphciBhIGNhZGEgMTAgc2VndW5kb3NcclxuICAgIGNvbnN0IGludGVydmFsID0gc2V0SW50ZXJ2YWwobG9hZEV2ZW50RGF0YSwgMTAwMDApO1xyXG5cclxuICAgIHJldHVybiAoKSA9PiBjbGVhckludGVydmFsKGludGVydmFsKTtcclxuICB9LCBbZXZlbnRJZF0pO1xyXG5cclxuICBjb25zdCBoYW5kbGVDb3B5UGFzc3dvcmQgPSAoKSA9PiB7XHJcbiAgICBpZiAoIXBhc3N3b3JkKSByZXR1cm47XHJcblxyXG4gICAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQocGFzc3dvcmQpO1xyXG4gICAgc2V0Q29waWVkKHRydWUpO1xyXG4gICAgdG9hc3Qoe1xyXG4gICAgICB0aXRsZTogJ/Cfk4sgU2VuaGEgY29waWFkYSEnLFxyXG4gICAgICBkZXNjcmlwdGlvbjogJ0Egc2VuaGEgZm9pIGNvcGlhZGEgcGFyYSBhIMOhcmVhIGRlIHRyYW5zZmVyw6puY2lhJyxcclxuICAgIH0pO1xyXG5cclxuICAgIHNldFRpbWVvdXQoKCkgPT4gc2V0Q29waWVkKGZhbHNlKSwgMjAwMCk7XHJcbiAgfTtcclxuXHJcbiAgaWYgKGxvYWRpbmcpIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ2xhc3MtZWZmZWN0IHJvdW5kZWQtbGcgcC00IGJvcmRlciBib3JkZXItd2hpdGUvMTAgYW5pbWF0ZS1wdWxzZVwiPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaC02IGJnLXdoaXRlLzEwIHJvdW5kZWQgdy0xLzIgbWItMlwiIC8+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJoLTQgYmctd2hpdGUvMTAgcm91bmRlZCB3LTMvNFwiIC8+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIC8vIFNlIGFpbmRhIG7Do28gdGVtIHNlbmhhIChmYWx0YSBtYWlzIGRlIDIgbWludXRvcylcclxuICBpZiAoIXBhc3N3b3JkKSB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8bW90aW9uLmRpdlxyXG4gICAgICAgIGluaXRpYWw9e3sgb3BhY2l0eTogMCwgeTogMTAgfX1cclxuICAgICAgICBhbmltYXRlPXt7IG9wYWNpdHk6IDEsIHk6IDAgfX1cclxuICAgICAgICBjbGFzc05hbWU9XCJnbGFzcy1lZmZlY3Qgcm91bmRlZC1sZyBwLTQgYm9yZGVyIGJvcmRlci1ibHVlLTUwMC8zMCBiZy1ibHVlLTUwMC81XCJcclxuICAgICAgPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1zdGFydCBnYXAtM1wiPlxyXG4gICAgICAgICAgPENsb2NrIGNsYXNzTmFtZT1cInctNSBoLTUgdGV4dC1ibHVlLTQwMCBtdC0wLjVcIiAvPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTFcIj5cclxuICAgICAgICAgICAgPGg0IGNsYXNzTmFtZT1cInRleHQtYmx1ZS0zMDAgZm9udC1zZW1pYm9sZCB0ZXh0LXNtIG1iLTFcIj5cclxuICAgICAgICAgICAgICBTZW5oYSBzZXLDoSBnZXJhZGEgZW0gYnJldmVcclxuICAgICAgICAgICAgPC9oND5cclxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1ibHVlLTIwMC84MCB0ZXh0LXhzXCI+XHJcbiAgICAgICAgICAgICAge3RpbWVVbnRpbFN0YXJ0ICE9PSBudWxsICYmIHRpbWVVbnRpbFN0YXJ0ID4gMlxyXG4gICAgICAgICAgICAgICAgPyBgQSBzZW5oYSBzZXLDoSBnZXJhZGEgZmFsdGFuZG8gMSBtaW51dG8gcGFyYSBvIGV2ZW50byAoZW0gfiR7dGltZVVudGlsU3RhcnR9IG1pbilgXHJcbiAgICAgICAgICAgICAgICA6ICdBIHNlbmhhIGVzdMOhIHNlbmRvIGdlcmFkYS4uLid9XHJcbiAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L21vdGlvbi5kaXY+XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLy8gVGVtIHNlbmhhIGdlcmFkYVxyXG4gIHJldHVybiAoXHJcbiAgICA8bW90aW9uLmRpdlxyXG4gICAgICBpbml0aWFsPXt7IHNjYWxlOiAwLjk1LCBvcGFjaXR5OiAwIH19XHJcbiAgICAgIGFuaW1hdGU9e3sgc2NhbGU6IDEsIG9wYWNpdHk6IDEgfX1cclxuICAgICAgY2xhc3NOYW1lPVwiZ2xhc3MtZWZmZWN0IHJvdW5kZWQtbGcgcC00IGJvcmRlciBib3JkZXItZ3JlZW4tNTAwLzMwIGJnLWdyYWRpZW50LXRvLWJyIGZyb20tZ3JlZW4tNTAwLzEwIHRvLWVtZXJhbGQtNTAwLzEwIHNwYWNlLXktM1wiXHJcbiAgICA+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1zdGFydCBnYXAtM1wiPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy0xMCBoLTEwIHJvdW5kZWQtZnVsbCBiZy1ncmVlbi01MDAvMjAgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXJcIj5cclxuICAgICAgICAgIDxLZXkgY2xhc3NOYW1lPVwidy01IGgtNSB0ZXh0LWdyZWVuLTQwMFwiIC8+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4LTFcIj5cclxuICAgICAgICAgIDxoNCBjbGFzc05hbWU9XCJ0ZXh0LWdyZWVuLTMwMCBmb250LXNlbWlib2xkIHRleHQtc20gbWItMVwiPlxyXG4gICAgICAgICAgICDwn5SQIFNlbmhhIGRlIEVudHJhZGEgR2VyYWRhIVxyXG4gICAgICAgICAgPC9oND5cclxuICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtZ3JlZW4tMjAwLzgwIHRleHQteHNcIj5cclxuICAgICAgICAgICAgQ29tcGFydGlsaGUgZXN0YSBzZW5oYSBjb20gb3MgcGFydGljaXBhbnRlcyBwYXJhIGVudHJhcmVtIG5vIGV2ZW50b1xyXG4gICAgICAgICAgPC9wPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuXHJcbiAgICAgIHsvKiBTZW5oYSAqL31cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LTNcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJlbGF0aXZlXCI+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiBwLTMgcm91bmRlZC1sZyBiZy1ibGFjay8zMCBib3JkZXIgYm9yZGVyLWdyZWVuLTUwMC8zMFwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0zXCI+XHJcbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC14cyB0ZXh0LXdoaXRlLzYwIGZvbnQtbWVkaXVtXCI+U0VOSEE6PC9zcGFuPlxyXG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT17YHRleHQtMnhsIGZvbnQtYm9sZCB0cmFja2luZy13aWRlciB0ZXh0LWdyZWVuLTQwMCBmb250LW1vbm8gJHtcclxuICAgICAgICAgICAgICAgIHNob3dQYXNzd29yZCA/ICcnIDogJ2ZpbHRlciBibHVyLXNtIHNlbGVjdC1ub25lJ1xyXG4gICAgICAgICAgICAgIH1gfT5cclxuICAgICAgICAgICAgICAgIHtwYXNzd29yZH1cclxuICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XHJcbiAgICAgICAgICAgICAgPGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0U2hvd1Bhc3N3b3JkKCFzaG93UGFzc3dvcmQpfVxyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwicC0yIHJvdW5kZWQtbGcgaG92ZXI6Ymctd2hpdGUvMTAgdGV4dC13aGl0ZS82MCBob3Zlcjp0ZXh0LXdoaXRlIHRyYW5zaXRpb24tY29sb3JzXCJcclxuICAgICAgICAgICAgICAgIHRpdGxlPXtzaG93UGFzc3dvcmQgPyAnT2N1bHRhciBzZW5oYScgOiAnTW9zdHJhciBzZW5oYSd9XHJcbiAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAge3Nob3dQYXNzd29yZCA/IChcclxuICAgICAgICAgICAgICAgICAgPEV5ZU9mZiBjbGFzc05hbWU9XCJ3LTQgaC00XCIgLz5cclxuICAgICAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICAgIDxFeWUgY2xhc3NOYW1lPVwidy00IGgtNFwiIC8+XHJcbiAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgIDxidXR0b25cclxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZUNvcHlQYXNzd29yZH1cclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInAtMiByb3VuZGVkLWxnIGhvdmVyOmJnLXdoaXRlLzEwIHRleHQtd2hpdGUvNjAgaG92ZXI6dGV4dC13aGl0ZSB0cmFuc2l0aW9uLWNvbG9yc1wiXHJcbiAgICAgICAgICAgICAgICB0aXRsZT1cIkNvcGlhciBzZW5oYVwiXHJcbiAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAge2NvcGllZCA/IChcclxuICAgICAgICAgICAgICAgICAgPENoZWNrQ2lyY2xlIGNsYXNzTmFtZT1cInctNCBoLTQgdGV4dC1ncmVlbi00MDBcIiAvPlxyXG4gICAgICAgICAgICAgICAgKSA6IChcclxuICAgICAgICAgICAgICAgICAgPENvcHkgY2xhc3NOYW1lPVwidy00IGgtNFwiIC8+XHJcbiAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICB7LyogSW5zdHJ1w6fDtWVzICovfVxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicC0zIHJvdW5kZWQtbGcgYmctYmx1ZS01MDAvMTAgYm9yZGVyIGJvcmRlci1ibHVlLTUwMC8yMFwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLXN0YXJ0IGdhcC0yXCI+XHJcbiAgICAgICAgICAgIDxBbGVydENpcmNsZSBjbGFzc05hbWU9XCJ3LTQgaC00IHRleHQtYmx1ZS00MDAgbXQtMC41IGZsZXgtc2hyaW5rLTBcIiAvPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC1ibHVlLTIwMC84MFwiPlxyXG4gICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImZvbnQtc2VtaWJvbGQgbWItMVwiPkNvbW8gdXNhcjo8L3A+XHJcbiAgICAgICAgICAgICAgPG9sIGNsYXNzTmFtZT1cImxpc3QtZGVjaW1hbCBsaXN0LWluc2lkZSBzcGFjZS15LTEgdGV4dC1ibHVlLTIwMC83MFwiPlxyXG4gICAgICAgICAgICAgICAgPGxpPkNvbXBhcnRpbGhlIGVzdGEgc2VuaGEgY29tIG9zIHBhcnRpY2lwYW50ZXM8L2xpPlxyXG4gICAgICAgICAgICAgICAgPGxpPkVsZXMgZGV2ZW0gZGlnaXRhciBuYSBww6FnaW5hIGRvIGV2ZW50bzwvbGk+XHJcbiAgICAgICAgICAgICAgICA8bGk+QSBlbnRyYWRhIHNlcsOhIGxpYmVyYWRhIGF1dG9tYXRpY2FtZW50ZTwvbGk+XHJcbiAgICAgICAgICAgICAgPC9vbD5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgey8qIFN0YXR1cyBkbyBFdmVudG8gKi99XHJcbiAgICAgICAge3RpbWVVbnRpbFN0YXJ0ICE9PSBudWxsICYmIHRpbWVVbnRpbFN0YXJ0ID09PSAwICYmIChcclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicC0yIHJvdW5kZWQtbGcgYmctZ3JlZW4tNTAwLzIwIGJvcmRlciBib3JkZXItZ3JlZW4tNTAwLzMwIHRleHQtY2VudGVyXCI+XHJcbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC1ncmVlbi0zMDAgZm9udC1zZW1pYm9sZFwiPlxyXG4gICAgICAgICAgICAgIPCfjokgRXZlbnRvIGVtIGFuZGFtZW50byFcclxuICAgICAgICAgICAgPC9wPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKX1cclxuXHJcbiAgICAgICAgey8qIFBhcnRpY2lwYW50ZXMgcXVlIGrDoSBlbnRyYXJhbSAqL31cclxuICAgICAgICB7cGFydGljaXBhbnRzV2l0aEFjY2Vzcy5sZW5ndGggPiAwICYmIChcclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicC0zIHJvdW5kZWQtbGcgYmctZ3JlZW4tNTAwLzEwIGJvcmRlciBib3JkZXItZ3JlZW4tNTAwLzIwXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgbWItMlwiPlxyXG4gICAgICAgICAgICAgIDxVc2VycyBjbGFzc05hbWU9XCJ3LTQgaC00IHRleHQtZ3JlZW4tNDAwXCIgLz5cclxuICAgICAgICAgICAgICA8aDUgY2xhc3NOYW1lPVwidGV4dC1ncmVlbi0zMDAgZm9udC1zZW1pYm9sZCB0ZXh0LXhzXCI+XHJcbiAgICAgICAgICAgICAgICBQYXJ0aWNpcGFudGVzIHF1ZSBqw6EgZW50cmFyYW0gKHtwYXJ0aWNpcGFudHNXaXRoQWNjZXNzLmxlbmd0aH0pXHJcbiAgICAgICAgICAgICAgPC9oNT5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBmbGV4LXdyYXAgZ2FwLTJcIj5cclxuICAgICAgICAgICAgICB7cGFydGljaXBhbnRzV2l0aEFjY2Vzcy5tYXAoKHBhcnRpY2lwYW50KSA9PiAoXHJcbiAgICAgICAgICAgICAgICA8ZGl2XHJcbiAgICAgICAgICAgICAgICAgIGtleT17cGFydGljaXBhbnQuaWR9XHJcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0yIHB4LTIgcHktMSByb3VuZGVkLWxnIGJnLWdyZWVuLTUwMC8yMCBib3JkZXIgYm9yZGVyLWdyZWVuLTUwMC8zMFwiXHJcbiAgICAgICAgICAgICAgICAgIHRpdGxlPXtgRW50cm91OiAke3BhcnRpY2lwYW50LmVudHJ5X3RpbWUgPyBuZXcgRGF0ZShwYXJ0aWNpcGFudC5lbnRyeV90aW1lKS50b0xvY2FsZVRpbWVTdHJpbmcoKSA6ICdBZ29yYSd9YH1cclxuICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgPGltZ1xyXG4gICAgICAgICAgICAgICAgICAgIHNyYz17XHJcbiAgICAgICAgICAgICAgICAgICAgICBwYXJ0aWNpcGFudC51c2VyPy5hdmF0YXJfdXJsIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICBgaHR0cHM6Ly91aS1hdmF0YXJzLmNvbS9hcGkvP25hbWU9JHtlbmNvZGVVUklDb21wb25lbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpY2lwYW50LnVzZXI/LnVzZXJuYW1lIHx8ICdVc2VyJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgKX0mYmFja2dyb3VuZD0xMGI5ODEmY29sb3I9ZmZmJnNpemU9MzJgXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGFsdD17cGFydGljaXBhbnQudXNlcj8udXNlcm5hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy01IGgtNSByb3VuZGVkLWZ1bGwgYm9yZGVyIGJvcmRlci1ncmVlbi00MDAvNTBcIlxyXG4gICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LXhzIHRleHQtZ3JlZW4tMjAwIGZvbnQtbWVkaXVtXCI+XHJcbiAgICAgICAgICAgICAgICAgICAge3BhcnRpY2lwYW50LnVzZXI/LnVzZXJuYW1lfVxyXG4gICAgICAgICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICApKX1cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICApfVxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvbW90aW9uLmRpdj5cclxuICApO1xyXG59O1xyXG5cclxuRXZlbnRQYXNzd29yZENhcmQucHJvcFR5cGVzID0ge1xyXG4gIGV2ZW50SWQ6IFByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZCxcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IEV2ZW50UGFzc3dvcmRDYXJkOyJdLCJ2ZXJzaW9uIjozfQ==