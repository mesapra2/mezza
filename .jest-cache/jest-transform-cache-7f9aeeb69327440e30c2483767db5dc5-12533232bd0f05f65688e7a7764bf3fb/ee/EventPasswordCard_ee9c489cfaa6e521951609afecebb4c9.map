{"file":"C:\\DEVMix\\App.Mesapra2.com\\src\\features\\partner\\components\\EventPasswordCard.jsx","mappings":"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","names":[],"sources":["C:\\DEVMix\\App.Mesapra2.com\\src\\features\\partner\\components\\EventPasswordCard.jsx"],"sourcesContent":["// src/features/partner/components/EventPasswordCard.jsx\r\nimport { useState, useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { motion } from 'framer-motion';\r\nimport { Key, Clock, Copy, CheckCircle, Eye, EyeOff, AlertCircle, Users } from 'lucide-react';\r\nimport { supabase } from '@/lib/supabaseClient';\r\nimport { useToast } from '@/features/shared/components/ui/use-toast';\r\n\r\nconst EventPasswordCard = ({ eventId }) => {\r\n  const [password, setPassword] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [copied, setCopied] = useState(false);\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [timeUntilStart, setTimeUntilStart] = useState(null);\r\n  const [participantsWithAccess, setParticipantsWithAccess] = useState([]);\r\n  const { toast } = useToast();\r\n\r\n  useEffect(() => {\r\n    const loadEventData = async () => {\r\n      try {\r\n        const { data: event, error } = await supabase\r\n          .from('events')\r\n          .select('event_entry_password, start_time, end_time')\r\n          .eq('id', eventId)\r\n          .single();\r\n\r\n        if (error) throw error;\r\n\r\n        setPassword(event.event_entry_password);\r\n\r\n        // Calcular tempo atÃ© o evento comeÃ§ar\r\n        const startTime = new Date(event.start_time);\r\n        const now = new Date();\r\n        const diff = startTime - now;\r\n\r\n        if (diff > 0) {\r\n          setTimeUntilStart(Math.ceil(diff / 1000 / 60)); // minutos\r\n        } else {\r\n          setTimeUntilStart(0);\r\n        }\r\n\r\n        // Buscar participantes que jÃ¡ entraram\r\n        if (event.event_entry_password) {\r\n          const { data: participants, error: partError } = await supabase\r\n            .from('event_participants')\r\n            .select(`\r\n              id,\r\n              presenca_confirmada,\r\n              entry_time,\r\n              user:profiles!event_participants_user_id_fkey(\r\n                id,\r\n                username,\r\n                avatar_url\r\n              )\r\n            `)\r\n            .eq('event_id', eventId)\r\n            .eq('status', 'aprovado')\r\n            .eq('presenca_confirmada', true)\r\n            .order('entry_time', { ascending: true });\r\n\r\n          if (!partError && participants) {\r\n            setParticipantsWithAccess(participants);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('âŒ Erro ao carregar senha:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadEventData();\r\n\r\n    // Atualizar a cada 10 segundos\r\n    const interval = setInterval(loadEventData, 10000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [eventId]);\r\n\r\n  const handleCopyPassword = () => {\r\n    if (!password) return;\r\n\r\n    navigator.clipboard.writeText(password);\r\n    setCopied(true);\r\n    toast({\r\n      title: 'ğŸ“‹ Senha copiada!',\r\n      description: 'A senha foi copiada para a Ã¡rea de transferÃªncia',\r\n    });\r\n\r\n    setTimeout(() => setCopied(false), 2000);\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"glass-effect rounded-lg p-4 border border-white/10 animate-pulse\">\r\n        <div className=\"h-6 bg-white/10 rounded w-1/2 mb-2\" />\r\n        <div className=\"h-4 bg-white/10 rounded w-3/4\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Se ainda nÃ£o tem senha (falta mais de 2 minutos)\r\n  if (!password) {\r\n    return (\r\n      <motion.div\r\n        initial={{ opacity: 0, y: 10 }}\r\n        animate={{ opacity: 1, y: 0 }}\r\n        className=\"glass-effect rounded-lg p-4 border border-blue-500/30 bg-blue-500/5\"\r\n      >\r\n        <div className=\"flex items-start gap-3\">\r\n          <Clock className=\"w-5 h-5 text-blue-400 mt-0.5\" />\r\n          <div className=\"flex-1\">\r\n            <h4 className=\"text-blue-300 font-semibold text-sm mb-1\">\r\n              Senha serÃ¡ gerada em breve\r\n            </h4>\r\n            <p className=\"text-blue-200/80 text-xs\">\r\n              {timeUntilStart !== null && timeUntilStart > 2\r\n                ? `A senha serÃ¡ gerada faltando 1 minuto para o evento (em ~${timeUntilStart} min)`\r\n                : 'A senha estÃ¡ sendo gerada...'}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </motion.div>\r\n    );\r\n  }\r\n\r\n  // Tem senha gerada\r\n  return (\r\n    <motion.div\r\n      initial={{ scale: 0.95, opacity: 0 }}\r\n      animate={{ scale: 1, opacity: 1 }}\r\n      className=\"glass-effect rounded-lg p-4 border border-green-500/30 bg-gradient-to-br from-green-500/10 to-emerald-500/10 space-y-3\"\r\n    >\r\n      <div className=\"flex items-start gap-3\">\r\n        <div className=\"w-10 h-10 rounded-full bg-green-500/20 flex items-center justify-center\">\r\n          <Key className=\"w-5 h-5 text-green-400\" />\r\n        </div>\r\n        <div className=\"flex-1\">\r\n          <h4 className=\"text-green-300 font-semibold text-sm mb-1\">\r\n            ğŸ” Senha de Entrada Gerada!\r\n          </h4>\r\n          <p className=\"text-green-200/80 text-xs\">\r\n            Compartilhe esta senha com os participantes para entrarem no evento\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Senha */}\r\n      <div className=\"space-y-3\">\r\n        <div className=\"relative\">\r\n          <div className=\"flex items-center justify-between p-3 rounded-lg bg-black/30 border border-green-500/30\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <span className=\"text-xs text-white/60 font-medium\">SENHA:</span>\r\n              <span className={`text-2xl font-bold tracking-wider text-green-400 font-mono ${\r\n                showPassword ? '' : 'filter blur-sm select-none'\r\n              }`}>\r\n                {password}\r\n              </span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <button\r\n                onClick={() => setShowPassword(!showPassword)}\r\n                className=\"p-2 rounded-lg hover:bg-white/10 text-white/60 hover:text-white transition-colors\"\r\n                title={showPassword ? 'Ocultar senha' : 'Mostrar senha'}\r\n              >\r\n                {showPassword ? (\r\n                  <EyeOff className=\"w-4 h-4\" />\r\n                ) : (\r\n                  <Eye className=\"w-4 h-4\" />\r\n                )}\r\n              </button>\r\n              <button\r\n                onClick={handleCopyPassword}\r\n                className=\"p-2 rounded-lg hover:bg-white/10 text-white/60 hover:text-white transition-colors\"\r\n                title=\"Copiar senha\"\r\n              >\r\n                {copied ? (\r\n                  <CheckCircle className=\"w-4 h-4 text-green-400\" />\r\n                ) : (\r\n                  <Copy className=\"w-4 h-4\" />\r\n                )}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* InstruÃ§Ãµes */}\r\n        <div className=\"p-3 rounded-lg bg-blue-500/10 border border-blue-500/20\">\r\n          <div className=\"flex items-start gap-2\">\r\n            <AlertCircle className=\"w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0\" />\r\n            <div className=\"text-xs text-blue-200/80\">\r\n              <p className=\"font-semibold mb-1\">Como usar:</p>\r\n              <ol className=\"list-decimal list-inside space-y-1 text-blue-200/70\">\r\n                <li>Compartilhe esta senha com os participantes</li>\r\n                <li>Eles devem digitar na pÃ¡gina do evento</li>\r\n                <li>A entrada serÃ¡ liberada automaticamente</li>\r\n              </ol>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Status do Evento */}\r\n        {timeUntilStart !== null && timeUntilStart === 0 && (\r\n          <div className=\"p-2 rounded-lg bg-green-500/20 border border-green-500/30 text-center\">\r\n            <p className=\"text-xs text-green-300 font-semibold\">\r\n              ğŸ‰ Evento em andamento!\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Participantes que jÃ¡ entraram */}\r\n        {participantsWithAccess.length > 0 && (\r\n          <div className=\"p-3 rounded-lg bg-green-500/10 border border-green-500/20\">\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <Users className=\"w-4 h-4 text-green-400\" />\r\n              <h5 className=\"text-green-300 font-semibold text-xs\">\r\n                Participantes que jÃ¡ entraram ({participantsWithAccess.length})\r\n              </h5>\r\n            </div>\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              {participantsWithAccess.map((participant) => (\r\n                <div\r\n                  key={participant.id}\r\n                  className=\"flex items-center gap-2 px-2 py-1 rounded-lg bg-green-500/20 border border-green-500/30\"\r\n                  title={`Entrou: ${participant.entry_time ? new Date(participant.entry_time).toLocaleTimeString() : 'Agora'}`}\r\n                >\r\n                  <img\r\n                    src={\r\n                      participant.user?.avatar_url ||\r\n                      `https://ui-avatars.com/api/?name=${encodeURIComponent(\r\n                        participant.user?.username || 'User'\r\n                      )}&background=10b981&color=fff&size=32`\r\n                    }\r\n                    alt={participant.user?.username}\r\n                    className=\"w-5 h-5 rounded-full border border-green-400/50\"\r\n                  />\r\n                  <span className=\"text-xs text-green-200 font-medium\">\r\n                    {participant.user?.username}\r\n                  </span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nEventPasswordCard.propTypes = {\r\n  eventId: PropTypes.number.isRequired,\r\n};\r\n\r\nexport default EventPasswordCard;"],"version":3}