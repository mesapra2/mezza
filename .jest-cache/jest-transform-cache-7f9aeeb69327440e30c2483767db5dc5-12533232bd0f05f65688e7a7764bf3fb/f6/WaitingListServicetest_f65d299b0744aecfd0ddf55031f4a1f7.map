{"file":"C:\\DEVMix\\App.Mesapra2.com\\src\\services\\WaitingListService.test.ts","mappings":"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","names":[],"sources":["C:\\DEVMix\\App.Mesapra2.com\\src\\services\\WaitingListService.test.ts"],"sourcesContent":["// src/services/WaitingListService.test.ts\r\n\r\nimport { describe, it, expect, jest, beforeEach, afterEach } from '@jest/globals';\r\nimport type { PostgrestError } from '@supabase/supabase-js';\r\n\r\n// --- 1. MOCKING DEPENDÊNCIAS ---\r\n\r\n// Tipos auxiliares para os mocks\r\ntype SupabaseResponse<T> = { data: T; error: null } | { data: null; error: PostgrestError };\r\n\r\n// Mock do Supabase\r\nconst mockFrom = jest.fn();\r\nconst mockSupabase = {\r\n  from: mockFrom,\r\n};\r\n\r\njest.mock('../lib/supabaseClient', () => ({\r\n  supabase: mockSupabase,\r\n}));\r\n\r\n// Mock do NotificationService\r\nconst mockCreateForUser = jest.fn().mockResolvedValue({ success: true });\r\njest.mock('../services/NotificationService', () => ({\r\n  default: {\r\n    createForUser: mockCreateForUser,\r\n  },\r\n}));\r\n\r\n// Mock do ParticipationService\r\nconst mockApplyToEvent = jest.fn().mockResolvedValue({ success: true, isAutoApproved: true });\r\njest.mock('../services/ParticipationService', () => ({\r\n  default: {\r\n    applyToEvent: mockApplyToEvent,\r\n  },\r\n}));\r\n\r\n// Importar após os mocks\r\nimport waitingListService from './WaitingListService';\r\n\r\n// --- 2. HELPERS PARA CRIAR MOCKS ---\r\n\r\nconst createSelectChain = (returnValue: any) => ({\r\n  select: jest.fn().mockReturnValue({\r\n    eq: jest.fn().mockReturnValue({\r\n      eq: jest.fn().mockReturnValue({\r\n        single: jest.fn().mockResolvedValue(returnValue),\r\n      }),\r\n    }),\r\n  }),\r\n});\r\n\r\nconst createSelectWithOrderChain = (returnValue: any) => ({\r\n  select: jest.fn().mockReturnValue({\r\n    eq: jest.fn().mockReturnValue({\r\n      order: jest.fn().mockReturnValue({\r\n        limit: jest.fn().mockReturnValue({\r\n          single: jest.fn().mockResolvedValue(returnValue),\r\n        }),\r\n      }),\r\n    }),\r\n  }),\r\n});\r\n\r\nconst createInsertChain = (returnValue: any) => ({\r\n  insert: jest.fn().mockReturnValue({\r\n    select: jest.fn().mockReturnValue({\r\n      single: jest.fn().mockResolvedValue(returnValue),\r\n    }),\r\n  }),\r\n});\r\n\r\nconst createDeleteChain = (returnValue: any) => ({\r\n  delete: jest.fn().mockReturnValue({\r\n    eq: jest.fn().mockReturnValue({\r\n      eq: jest.fn().mockResolvedValue(returnValue),\r\n    }),\r\n  }),\r\n});\r\n\r\nconst createUpdateChain = (returnValue: any) => ({\r\n  update: jest.fn().mockReturnValue({\r\n    eq: jest.fn().mockResolvedValue(returnValue),\r\n  }),\r\n});\r\n\r\nconst createListSelectChain = (returnValue: any) => ({\r\n  select: jest.fn().mockReturnValue({\r\n    eq: jest.fn().mockReturnValue({\r\n      order: jest.fn().mockResolvedValue(returnValue),\r\n    }),\r\n  }),\r\n});\r\n\r\n// --- 3. CONFIGURAÇÃO DOS TESTES ---\r\n\r\ndescribe('WaitingListService', () => {\r\n  let spyReorganize: jest.SpiedFunction<any>;\r\n  let spyRemoveFromList: jest.SpiedFunction<typeof waitingListService.removeFromWaitingList>;\r\n  let spyGetWaitingList: jest.SpiedFunction<typeof waitingListService.getWaitingList>;\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    mockFrom.mockReset();\r\n    mockCreateForUser.mockClear();\r\n    mockApplyToEvent.mockClear();\r\n    \r\n    // Reset para comportamento padrão\r\n    mockApplyToEvent.mockResolvedValue({ success: true, isAutoApproved: true });\r\n\r\n    // Espiões\r\n    spyReorganize = jest.spyOn(waitingListService as any, 'reorganizePositions')\r\n      .mockResolvedValue(undefined);\r\n      \r\n    spyRemoveFromList = jest.spyOn(waitingListService, 'removeFromWaitingList')\r\n      .mockResolvedValue(true);\r\n      \r\n    spyGetWaitingList = jest.spyOn(waitingListService, 'getWaitingList')\r\n      .mockResolvedValue([]);\r\n  });\r\n\r\n  afterEach(() => {\r\n    spyReorganize.mockRestore();\r\n    spyRemoveFromList.mockRestore();\r\n    spyGetWaitingList.mockRestore();\r\n  });\r\n\r\n  // --- 4. TESTES DOS MÉTODOS ---\r\n\r\n  describe('addToWaitingList', () => {\r\n    const userId = 'user-1';\r\n    const eventId = 'evt-1';\r\n\r\n    it('deve adicionar um novo usuário e notificar', async () => {\r\n      const mockLastEntry = { position: 2 };\r\n      const mockNewEntry = { user_id: userId, event_id: eventId, position: 3 };\r\n\r\n      // Mock 1: SELECT verificar existente (não encontra)\r\n      mockFrom.mockReturnValueOnce(\r\n        createSelectChain({ data: null, error: { code: 'PGRST116' } as any })\r\n      );\r\n\r\n      // Mock 2: SELECT última posição (encontra posição 2)\r\n      mockFrom.mockReturnValueOnce(\r\n        createSelectWithOrderChain({ data: mockLastEntry, error: null })\r\n      );\r\n\r\n      // Mock 3: INSERT novo usuário\r\n      mockFrom.mockReturnValueOnce(\r\n        createInsertChain({ data: mockNewEntry, error: null })\r\n      );\r\n\r\n      const result = await waitingListService.addToWaitingList(userId, eventId);\r\n\r\n      expect(result).toEqual(mockNewEntry);\r\n      expect(mockCreateForUser).toHaveBeenCalledWith(\r\n        expect.objectContaining({\r\n          target_user_id: userId,\r\n          message: expect.stringContaining('posição 3'),\r\n        })\r\n      );\r\n    });\r\n\r\n    it('deve retornar o usuário existente se ele já estiver na lista', async () => {\r\n      const mockExistingEntry = { user_id: userId, event_id: eventId, position: 1 };\r\n\r\n      // Mock 1: SELECT verificar existente (encontra)\r\n      mockFrom.mockReturnValueOnce(\r\n        createSelectChain({ data: mockExistingEntry, error: null })\r\n      );\r\n\r\n      const result = await waitingListService.addToWaitingList(userId, eventId);\r\n\r\n      expect(result).toEqual(mockExistingEntry);\r\n      expect(mockCreateForUser).not.toHaveBeenCalled();\r\n    });\r\n\r\n    it('deve criar posição 1 quando não há entradas anteriores', async () => {\r\n      const mockNewEntry = { user_id: userId, event_id: eventId, position: 1 };\r\n\r\n      // Mock 1: SELECT verificar existente (não encontra)\r\n      mockFrom.mockReturnValueOnce(\r\n        createSelectChain({ data: null, error: { code: 'PGRST116' } as any })\r\n      );\r\n\r\n      // Mock 2: SELECT última posição (não encontra nenhuma)\r\n      mockFrom.mockReturnValueOnce(\r\n        createSelectWithOrderChain({ data: null, error: { code: 'PGRST116' } as any })\r\n      );\r\n\r\n      // Mock 3: INSERT novo usuário\r\n      mockFrom.mockReturnValueOnce(\r\n        createInsertChain({ data: mockNewEntry, error: null })\r\n      );\r\n\r\n      const result = await waitingListService.addToWaitingList(userId, eventId);\r\n\r\n      expect(result).toEqual(mockNewEntry);\r\n      expect(mockCreateForUser).toHaveBeenCalledWith(\r\n        expect.objectContaining({\r\n          message: expect.stringContaining('posição 1'),\r\n        })\r\n      );\r\n    });\r\n  });\r\n\r\n  describe('removeFromWaitingList', () => {\r\n    it('deve deletar o usuário e chamar reorganizePositions', async () => {\r\n      spyRemoveFromList.mockRestore();\r\n\r\n      // Mock DELETE\r\n      mockFrom.mockReturnValueOnce(\r\n        createDeleteChain({ error: null })\r\n      );\r\n\r\n      const result = await waitingListService.removeFromWaitingList('user-1', 'evt-1');\r\n\r\n      expect(result).toBe(true);\r\n      expect(spyReorganize).toHaveBeenCalledWith('evt-1');\r\n    });\r\n\r\n    it('deve retornar false em caso de erro', async () => {\r\n      spyRemoveFromList.mockRestore();\r\n\r\n      // Mock DELETE com erro\r\n      mockFrom.mockReturnValueOnce(\r\n        createDeleteChain({ error: { message: 'Database error' } as any })\r\n      );\r\n\r\n      const result = await waitingListService.removeFromWaitingList('user-1', 'evt-1');\r\n\r\n      expect(result).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('processWaitingList', () => {\r\n    it('deve notificar, aplicar e remover o próximo da fila', async () => {\r\n      const mockNextInLine = {\r\n        id: 'wl-1',\r\n        user_id: 'user-next',\r\n        event_id: 'evt-1',\r\n        position: 1,\r\n      };\r\n\r\n      // Mock 1: SELECT próximo da fila\r\n      mockFrom.mockReturnValueOnce({\r\n        select: jest.fn().mockReturnValue({\r\n          eq: jest.fn().mockReturnValue({\r\n            eq: jest.fn().mockReturnValue({\r\n              order: jest.fn().mockReturnValue({\r\n                limit: jest.fn().mockReturnValue({\r\n                  single: jest.fn().mockResolvedValue({ data: mockNextInLine, error: null }),\r\n                }),\r\n              }),\r\n            }),\r\n          }),\r\n        }),\r\n      });\r\n\r\n      // Mock 2: UPDATE marcar como notificado\r\n      mockFrom.mockReturnValueOnce(\r\n        createUpdateChain({ error: null })\r\n      );\r\n\r\n      await waitingListService.processWaitingList('evt-1');\r\n\r\n      expect(mockApplyToEvent).toHaveBeenCalledWith(\r\n        'evt-1',\r\n        'user-next',\r\n        expect.any(String)\r\n      );\r\n      expect(spyRemoveFromList).toHaveBeenCalledWith('user-next', 'evt-1');\r\n    });\r\n\r\n    it('NÃO deve remover da lista se a aprovação não for automática', async () => {\r\n      mockApplyToEvent.mockResolvedValueOnce({ success: true, isAutoApproved: false });\r\n\r\n      const mockNextInLine = {\r\n        id: 'wl-1',\r\n        user_id: 'user-next',\r\n        event_id: 'evt-1',\r\n        position: 1,\r\n      };\r\n\r\n      // Mock 1: SELECT próximo da fila\r\n      mockFrom.mockReturnValueOnce({\r\n        select: jest.fn().mockReturnValue({\r\n          eq: jest.fn().mockReturnValue({\r\n            eq: jest.fn().mockReturnValue({\r\n              order: jest.fn().mockReturnValue({\r\n                limit: jest.fn().mockReturnValue({\r\n                  single: jest.fn().mockResolvedValue({ data: mockNextInLine, error: null }),\r\n                }),\r\n              }),\r\n            }),\r\n          }),\r\n        }),\r\n      });\r\n\r\n      // Mock 2: UPDATE marcar como notificado\r\n      mockFrom.mockReturnValueOnce(\r\n        createUpdateChain({ error: null })\r\n      );\r\n\r\n      await waitingListService.processWaitingList('evt-1');\r\n\r\n      expect(mockApplyToEvent).toHaveBeenCalled();\r\n      expect(spyRemoveFromList).not.toHaveBeenCalled();\r\n    });\r\n\r\n    it('deve retornar sem fazer nada se não houver ninguém na fila', async () => {\r\n      // Mock 1: SELECT próximo da fila (não encontra)\r\n      mockFrom.mockReturnValueOnce({\r\n        select: jest.fn().mockReturnValue({\r\n          eq: jest.fn().mockReturnValue({\r\n            eq: jest.fn().mockReturnValue({\r\n              order: jest.fn().mockReturnValue({\r\n                limit: jest.fn().mockReturnValue({\r\n                  single: jest.fn().mockResolvedValue({ data: null, error: { code: 'PGRST116' } as any }),\r\n                }),\r\n              }),\r\n            }),\r\n          }),\r\n        }),\r\n      });\r\n\r\n      await waitingListService.processWaitingList('evt-1');\r\n\r\n      expect(mockApplyToEvent).not.toHaveBeenCalled();\r\n      expect(spyRemoveFromList).not.toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('reorganizePositions (private)', () => {\r\n    it('deve atualizar posições fora de ordem', async () => {\r\n      spyReorganize.mockRestore();\r\n      spyGetWaitingList.mockRestore();\r\n\r\n      const mockList = [\r\n        { id: 'entry-A', position: 1 },\r\n        { id: 'entry-B', position: 3 },\r\n        { id: 'entry-C', position: 4 },\r\n      ];\r\n\r\n      // Mock getWaitingList interno\r\n      mockFrom.mockReturnValueOnce(\r\n        createListSelectChain({ data: mockList, error: null })\r\n      );\r\n\r\n      // Mock UPDATE para entry-B\r\n      mockFrom.mockReturnValueOnce(\r\n        createUpdateChain({ error: null })\r\n      );\r\n\r\n      // Mock UPDATE para entry-C\r\n      mockFrom.mockReturnValueOnce(\r\n        createUpdateChain({ error: null })\r\n      );\r\n\r\n      await (waitingListService as any).reorganizePositions('evt-1');\r\n\r\n      // Verifica que foram feitas 2 atualizações (B e C precisam correção)\r\n      expect(mockFrom).toHaveBeenCalledWith('waiting_list');\r\n      // 3 chamadas: 1 select + 2 updates\r\n      expect(mockFrom).toHaveBeenCalledTimes(3);\r\n    });\r\n\r\n    it('não deve atualizar se as posições estiverem corretas', async () => {\r\n      spyReorganize.mockRestore();\r\n      spyGetWaitingList.mockRestore();\r\n\r\n      const mockList = [\r\n        { id: 'entry-A', position: 1 },\r\n        { id: 'entry-B', position: 2 },\r\n        { id: 'entry-C', position: 3 },\r\n      ];\r\n\r\n      // Mock getWaitingList interno\r\n      mockFrom.mockReturnValueOnce(\r\n        createListSelectChain({ data: mockList, error: null })\r\n      );\r\n\r\n      await (waitingListService as any).reorganizePositions('evt-1');\r\n\r\n      // Apenas 1 chamada (o select), sem updates\r\n      expect(mockFrom).toHaveBeenCalledTimes(1);\r\n    });\r\n  });\r\n\r\n  describe('getWaitingList', () => {\r\n    it('deve retornar a lista ordenada por posição', async () => {\r\n      spyGetWaitingList.mockRestore();\r\n\r\n      const mockList = [\r\n        { id: 'wl-1', user_id: 'user-1', event_id: 'evt-1', position: 1 },\r\n        { id: 'wl-2', user_id: 'user-2', event_id: 'evt-1', position: 2 },\r\n      ];\r\n\r\n      mockFrom.mockReturnValueOnce(\r\n        createListSelectChain({ data: mockList, error: null })\r\n      );\r\n\r\n      const result = await waitingListService.getWaitingList('evt-1');\r\n\r\n      expect(result).toEqual(mockList);\r\n    });\r\n  });\r\n\r\n  describe('isInWaitingList', () => {\r\n    it('deve retornar true se o usuário estiver na lista', async () => {\r\n      mockFrom.mockReturnValueOnce(\r\n        createSelectChain({ data: { id: 'wl-1' }, error: null })\r\n      );\r\n\r\n      const result = await waitingListService.isInWaitingList('user-1', 'evt-1');\r\n\r\n      expect(result).toBe(true);\r\n    });\r\n\r\n    it('deve retornar false se o usuário não estiver na lista', async () => {\r\n      mockFrom.mockReturnValueOnce(\r\n        createSelectChain({ data: null, error: { code: 'PGRST116' } as any })\r\n      );\r\n\r\n      const result = await waitingListService.isInWaitingList('user-1', 'evt-1');\r\n\r\n      expect(result).toBe(false);\r\n    });\r\n  });\r\n});"],"version":3}